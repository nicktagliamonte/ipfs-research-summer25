/*! For license information please see 793.9b9b25d5.chunk.js.LICENSE.txt */
(self.webpackChunkipfs_webui=self.webpackChunkipfs_webui||[]).push([[793],{4823:t=>{"use strict";function e(t,e){for(const n in e)Object.defineProperty(t,n,{value:e[n],enumerable:!0,configurable:!0});return t}t.exports=function(t,n,r){if(!t||"string"===typeof t)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"===typeof n&&(r=n,n=""),n&&(r.code=n);try{return e(t,r)}catch(o){r.message=t.message,r.stack=t.stack;const n=function(){};n.prototype=Object.create(Object.getPrototypeOf(t));return e(new n,r)}}},4053:(t,e,n)=>{var r=n(2285);t.exports=function(){return"undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type||(!("undefined"===typeof r||"object"!==typeof r.versions||!r.versions.electron)||"object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},9793:(t,e,n)=>{"use strict";n.d(e,{create:()=>Yp});var r={};n.r(r),n.d(r,{code:()=>Ht,decode:()=>Vt,decodeOptions:()=>jt,encode:()=>Ft,encodeOptions:()=>Pt,name:()=>_t,toByteView:()=>Lt});var o={};n.r(o),n.d(o,{code:()=>kn,decode:()=>xn,encode:()=>An,format:()=>Sn,name:()=>Bn,parse:()=>Nn,stringify:()=>Sn});var i={};n.r(i),n.d(i,{code:()=>er,createLink:()=>Xn,createNode:()=>Qn,decode:()=>rr,encode:()=>nr,name:()=>tr,prepare:()=>Kn,validate:()=>Yn});var s={};n.r(s),n.d(s,{code:()=>Ti,decode:()=>Pi,encode:()=>Ri,name:()=>Ui,toGeneral:()=>Li});var a={};n.r(a),n.d(a,{aK:()=>ka,e8:()=>aa,DO:()=>sa,dJ:()=>Aa,OG:()=>xa,My:()=>ca,Ph:()=>pa,lX:()=>ya,Id:()=>va,fg:()=>Na,qj:()=>ba,aT:()=>ga,r4:()=>Ba,aY:()=>ia,x:()=>Ta,lq:()=>wa,z:()=>ma,zW:()=>la,Q5:()=>Ua});var u=n(3932);const c=["string","number","bigint","symbol"],l=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function h(t){if(null===t)return"null";if(void 0===t)return"undefined";if(!0===t||!1===t)return"boolean";const e=typeof t;if(c.includes(e))return e;if("function"===e)return"Function";if(Array.isArray(t))return"Array";if(function(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}(t))return"Buffer";const n=function(t){const e=Object.prototype.toString.call(t).slice(8,-1);if(l.includes(e))return e;return}(t);return n||"Object"}class f{constructor(t,e,n){this.major=t,this.majorEncoded=t<<5,this.name=e,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}f.uint=new f(0,"uint",!0),f.negint=new f(1,"negint",!0),f.bytes=new f(2,"bytes",!0),f.string=new f(3,"string",!0),f.array=new f(4,"array",!1),f.map=new f(5,"map",!1),f.tag=new f(6,"tag",!1),f.float=new f(7,"float",!0),f.false=new f(7,"false",!0),f.true=new f(7,"true",!0),f.null=new f(7,"null",!0),f.undefined=new f(7,"undefined",!0),f.break=new f(7,"break",!0);class d{constructor(t,e,n){this.type=t,this.value=e,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const g=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,p=new TextDecoder,y=new TextEncoder;function w(t){return g&&globalThis.Buffer.isBuffer(t)}function m(t){return t instanceof Uint8Array?w(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}const b=g?(t,e,n)=>n-e>64?globalThis.Buffer.from(t.subarray(e,n)).toString("utf8"):S(t,e,n):(t,e,n)=>n-e>64?p.decode(t.subarray(e,n)):S(t,e,n),v=g?t=>t.length>64?globalThis.Buffer.from(t):x(t):t=>t.length>64?y.encode(t):x(t),E=t=>Uint8Array.from(t),B=g?(t,e,n)=>w(t)?new Uint8Array(t.subarray(e,n)):t.slice(e,n):(t,e,n)=>t.slice(e,n),k=g?(t,e)=>(t=t.map((t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t))),m(globalThis.Buffer.concat(t,e))):(t,e)=>{const n=new Uint8Array(e);let r=0;for(let o of t)r+o.length>n.length&&(o=o.subarray(0,n.length-r)),n.set(o,r),r+=o.length;return n},A=g?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function x(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):55296===(64512&o)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(o=65536+((1023&o)<<10)+(1023&t.charCodeAt(++r)),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e}function S(t,e,n){const r=[];for(;e<n;){const o=t[e];let i=null,s=o>239?4:o>223?3:o>191?2:1;if(e+s<=n){let n,r,a,u;switch(s){case 1:o<128&&(i=o);break;case 2:n=t[e+1],128===(192&n)&&(u=(31&o)<<6|63&n,u>127&&(i=u));break;case 3:n=t[e+1],r=t[e+2],128===(192&n)&&128===(192&r)&&(u=(15&o)<<12|(63&n)<<6|63&r,u>2047&&(u<55296||u>57343)&&(i=u));break;case 4:n=t[e+1],r=t[e+2],a=t[e+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(u=(15&o)<<18|(63&n)<<12|(63&r)<<6|63&a,u>65535&&u<1114112&&(i=u))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),e+=s}return function(t){const e=t.length;if(e<=I)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=I));return n}(r)}const I=4096;class N{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let e=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const n=e.length-(this.maxCursor-this.cursor)-1;e.set(t,n)}else{if(e){const t=e.length-(this.maxCursor-this.cursor)-1;t<e.length&&(this.chunks[this.chunks.length-1]=e.subarray(0,t),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(e=A(this.chunkSize),this.chunks.push(e),this.maxCursor+=e.length,null===this._initReuseChunk&&(this._initReuseChunk=e),e.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(){let t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(1===this.chunks.length){const n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=B(n,0,this.cursor)}else t=k(this.chunks,this.cursor);return e&&this.reset(),t}}const C="CBOR decode error:",U="CBOR encode error:",T=[];function $(t,e,n){if(t.length-e<n)throw new Error(`${C} not enough data for type`)}T[23]=1,T[24]=2,T[25]=3,T[26]=5,T[27]=9;const O=[24,256,65536,4294967296,BigInt("18446744073709551616")];function L(t,e,n){$(t,e,1);const r=t[e];if(!0===n.strict&&r<O[0])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return r}function R(t,e,n){$(t,e,2);const r=t[e]<<8|t[e+1];if(!0===n.strict&&r<O[1])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return r}function P(t,e,n){$(t,e,4);const r=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(!0===n.strict&&r<O[2])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);return r}function D(t,e,n){$(t,e,8);const r=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],o=16777216*t[e+4]+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],i=(BigInt(r)<<BigInt(32))+BigInt(o);if(!0===n.strict&&i<O[3])throw new Error(`${C} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===n.allowBigInt)return i;throw new Error(`${C} integers outside of the safe integer range are not supported`)}function j(t,e){return _(t,0,e.value)}function _(t,e,n){if(n<O[0]){const r=Number(n);t.push([e|r])}else if(n<O[1]){const r=Number(n);t.push([24|e,r])}else if(n<O[2]){const r=Number(n);t.push([25|e,r>>>8,255&r])}else if(n<O[3]){const r=Number(n);t.push([26|e,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<O[4]))throw new Error(`${C} encountered BigInt larger than allowable range`);{const n=[27|e,0,0,0,0,0,0,0];let o=Number(r&BigInt(4294967295)),i=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&o,o>>=8,n[7]=255&o,o>>=8,n[6]=255&o,o>>=8,n[5]=255&o,n[4]=255&i,i>>=8,n[3]=255&i,i>>=8,n[2]=255&i,i>>=8,n[1]=255&i,t.push(n)}}}j.encodedSize=function(t){return _.encodedSize(t.value)},_.encodedSize=function(t){return t<O[0]?1:t<O[1]?2:t<O[2]?3:t<O[3]?5:9},j.compareTokens=function(t,e){return t.value<e.value?-1:t.value>e.value?1:0};const H=BigInt(-1),F=BigInt(1);function V(t,e){const n=e.value,r="bigint"===typeof n?n*H-F:-1*n-1;_(t,e.type.majorEncoded,r)}function M(t,e,n,r){$(t,e,n+r);const o=B(t,e+n,e+n+r);return new d(f.bytes,o,n+r)}function z(t,e,n,r){return M(t,e,1,n)}function G(t){return void 0===t.encodedBytes&&(t.encodedBytes=t.type===f.string?v(t.value):t.value),t.encodedBytes}function q(t,e){const n=G(e);_(t,e.type.majorEncoded,n.length),t.push(n)}function W(t,e,n,r,o){const i=n+r;$(t,e,i);const s=new d(f.string,b(t,e+n,e+i),i);return!0===o.retainStringBytes&&(s.byteValue=B(t,e+n,e+i)),s}function J(t,e,n,r){return W(t,e,1,n,r)}V.encodedSize=function(t){const e=t.value,n="bigint"===typeof e?e*H-F:-1*e-1;return n<O[0]?1:n<O[1]?2:n<O[2]?3:n<O[3]?5:9},V.compareTokens=function(t,e){return t.value<e.value?1:t.value>e.value?-1:0},q.encodedSize=function(t){const e=G(t);return _.encodedSize(e.length)+e.length},q.compareTokens=function(t,e){return n=G(t),r=G(e),n.length<r.length?-1:n.length>r.length?1:function(t,e){if(w(t)&&w(e))return t.compare(e);for(let n=0;n<t.length;n++)if(t[n]!==e[n])return t[n]<e[n]?-1:1;return 0}(n,r);var n,r};const Z=q;function K(t,e,n,r){return new d(f.array,r,n)}function Y(t,e,n,r){return K(0,0,1,n)}function Q(t,e){_(t,f.array.majorEncoded,e.value)}function X(t,e,n,r){return new d(f.map,r,n)}function tt(t,e,n,r){return X(0,0,1,n)}function et(t,e){_(t,f.map.majorEncoded,e.value)}function nt(t,e,n,r){return new d(f.tag,n,1)}function rt(t,e){_(t,f.tag.majorEncoded,e.value)}Q.compareTokens=j.compareTokens,Q.encodedSize=function(t){return _.encodedSize(t.value)},et.compareTokens=j.compareTokens,et.encodedSize=function(t){return _.encodedSize(t.value)},rt.compareTokens=j.compareTokens,rt.encodedSize=function(t){return _.encodedSize(t.value)};function ot(t,e,n){if(n){if(!1===n.allowNaN&&Number.isNaN(t))throw new Error(`${C} NaN values are not supported`);if(!1===n.allowInfinity&&(t===1/0||t===-1/0))throw new Error(`${C} Infinity values are not supported`)}return new d(f.float,t,e)}function it(t,e,n){const r=e.value;if(!1===r)t.push([20|f.float.majorEncoded]);else if(!0===r)t.push([21|f.float.majorEncoded]);else if(null===r)t.push([22|f.float.majorEncoded]);else if(void 0===r)t.push([23|f.float.majorEncoded]);else{let e,i=!1;n&&!0===n.float64||(ct(r),e=lt(ut,1),r===e||Number.isNaN(r)?(ut[0]=249,t.push(ut.slice(0,3)),i=!0):(ht(r),e=ft(ut,1),r===e&&(ut[0]=250,t.push(ut.slice(0,5)),i=!0))),i||(o=r,at.setFloat64(0,o,!1),e=dt(ut,1),ut[0]=251,t.push(ut.slice(0,9)))}var o}it.encodedSize=function(t,e){const n=t.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!e||!0!==e.float64){ct(n);let t=lt(ut,1);if(n===t||Number.isNaN(n))return 3;if(ht(n),t=ft(ut,1),n===t)return 5}return 9};const st=new ArrayBuffer(9),at=new DataView(st,1),ut=new Uint8Array(st,0);function ct(t){if(t===1/0)at.setUint16(0,31744,!1);else if(t===-1/0)at.setUint16(0,64512,!1);else if(Number.isNaN(t))at.setUint16(0,32256,!1);else{at.setFloat32(0,t);const e=at.getUint32(0),n=(2139095040&e)>>23,r=8388607&e;if(255===n)at.setUint16(0,31744,!1);else if(0===n)at.setUint16(0,(2147483648&t)>>16|r>>13,!1);else{const t=n-127;t<-24?at.setUint16(0,0):t<-14?at.setUint16(0,(2147483648&e)>>16|1<<24+t,!1):at.setUint16(0,(2147483648&e)>>16|t+15<<10|r>>13,!1)}}}function lt(t,e){if(t.length-e<2)throw new Error(`${C} not enough data for float16`);const n=(t[e]<<8)+t[e+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,o=1023&n;let i;return i=0===r?o*2**-24:31!==r?(o+1024)*2**(r-25):0===o?1/0:NaN,32768&n?-i:i}function ht(t){at.setFloat32(0,t,!1)}function ft(t,e){if(t.length-e<4)throw new Error(`${C} not enough data for float32`);const n=(t.byteOffset||0)+e;return new DataView(t.buffer,n,4).getFloat32(0,!1)}function dt(t,e){if(t.length-e<8)throw new Error(`${C} not enough data for float64`);const n=(t.byteOffset||0)+e;return new DataView(t.buffer,n,8).getFloat64(0,!1)}function gt(t,e,n){throw new Error(`${C} encountered invalid minor (${n}) for major ${t[e]>>>5}`)}function pt(t){return()=>{throw new Error(`${C} ${t}`)}}it.compareTokens=j.compareTokens;const yt=[];for(let Qp=0;Qp<=23;Qp++)yt[Qp]=gt;yt[24]=function(t,e,n,r){return new d(f.uint,L(t,e+1,r),2)},yt[25]=function(t,e,n,r){return new d(f.uint,R(t,e+1,r),3)},yt[26]=function(t,e,n,r){return new d(f.uint,P(t,e+1,r),5)},yt[27]=function(t,e,n,r){return new d(f.uint,D(t,e+1,r),9)},yt[28]=gt,yt[29]=gt,yt[30]=gt,yt[31]=gt;for(let Qp=32;Qp<=55;Qp++)yt[Qp]=gt;yt[56]=function(t,e,n,r){return new d(f.negint,-1-L(t,e+1,r),2)},yt[57]=function(t,e,n,r){return new d(f.negint,-1-R(t,e+1,r),3)},yt[58]=function(t,e,n,r){return new d(f.negint,-1-P(t,e+1,r),5)},yt[59]=function(t,e,n,r){const o=D(t,e+1,r);if("bigint"!==typeof o){const t=-1-o;if(t>=Number.MIN_SAFE_INTEGER)return new d(f.negint,t,9)}if(!0!==r.allowBigInt)throw new Error(`${C} integers outside of the safe integer range are not supported`);return new d(f.negint,H-BigInt(o),9)},yt[60]=gt,yt[61]=gt,yt[62]=gt,yt[63]=gt;for(let Qp=64;Qp<=87;Qp++)yt[Qp]=z;yt[88]=function(t,e,n,r){return M(t,e,2,L(t,e+1,r))},yt[89]=function(t,e,n,r){return M(t,e,3,R(t,e+1,r))},yt[90]=function(t,e,n,r){return M(t,e,5,P(t,e+1,r))},yt[91]=function(t,e,n,r){const o=D(t,e+1,r);if("bigint"===typeof o)throw new Error(`${C} 64-bit integer bytes lengths not supported`);return M(t,e,9,o)},yt[92]=gt,yt[93]=gt,yt[94]=gt,yt[95]=pt("indefinite length bytes/strings are not supported");for(let Qp=96;Qp<=119;Qp++)yt[Qp]=J;yt[120]=function(t,e,n,r){return W(t,e,2,L(t,e+1,r),r)},yt[121]=function(t,e,n,r){return W(t,e,3,R(t,e+1,r),r)},yt[122]=function(t,e,n,r){return W(t,e,5,P(t,e+1,r),r)},yt[123]=function(t,e,n,r){const o=D(t,e+1,r);if("bigint"===typeof o)throw new Error(`${C} 64-bit integer string lengths not supported`);return W(t,e,9,o,r)},yt[124]=gt,yt[125]=gt,yt[126]=gt,yt[127]=pt("indefinite length bytes/strings are not supported");for(let Qp=128;Qp<=151;Qp++)yt[Qp]=Y;yt[152]=function(t,e,n,r){return K(0,0,2,L(t,e+1,r))},yt[153]=function(t,e,n,r){return K(0,0,3,R(t,e+1,r))},yt[154]=function(t,e,n,r){return K(0,0,5,P(t,e+1,r))},yt[155]=function(t,e,n,r){const o=D(t,e+1,r);if("bigint"===typeof o)throw new Error(`${C} 64-bit integer array lengths not supported`);return K(0,0,9,o)},yt[156]=gt,yt[157]=gt,yt[158]=gt,yt[159]=function(t,e,n,r){if(!1===r.allowIndefinite)throw new Error(`${C} indefinite length items not allowed`);return K(0,0,1,1/0)};for(let Qp=160;Qp<=183;Qp++)yt[Qp]=tt;yt[184]=function(t,e,n,r){return X(0,0,2,L(t,e+1,r))},yt[185]=function(t,e,n,r){return X(0,0,3,R(t,e+1,r))},yt[186]=function(t,e,n,r){return X(0,0,5,P(t,e+1,r))},yt[187]=function(t,e,n,r){const o=D(t,e+1,r);if("bigint"===typeof o)throw new Error(`${C} 64-bit integer map lengths not supported`);return X(0,0,9,o)},yt[188]=gt,yt[189]=gt,yt[190]=gt,yt[191]=function(t,e,n,r){if(!1===r.allowIndefinite)throw new Error(`${C} indefinite length items not allowed`);return X(0,0,1,1/0)};for(let Qp=192;Qp<=215;Qp++)yt[Qp]=nt;yt[216]=function(t,e,n,r){return new d(f.tag,L(t,e+1,r),2)},yt[217]=function(t,e,n,r){return new d(f.tag,R(t,e+1,r),3)},yt[218]=function(t,e,n,r){return new d(f.tag,P(t,e+1,r),5)},yt[219]=function(t,e,n,r){return new d(f.tag,D(t,e+1,r),9)},yt[220]=gt,yt[221]=gt,yt[222]=gt,yt[223]=gt;for(let Qp=224;Qp<=243;Qp++)yt[Qp]=pt("simple values are not supported");yt[244]=gt,yt[245]=gt,yt[246]=gt,yt[247]=function(t,e,n,r){if(!1===r.allowUndefined)throw new Error(`${C} undefined values are not supported`);return!0===r.coerceUndefinedToNull?new d(f.null,null,1):new d(f.undefined,void 0,1)},yt[248]=pt("simple values are not supported"),yt[249]=function(t,e,n,r){return ot(lt(t,e+1),3,r)},yt[250]=function(t,e,n,r){return ot(ft(t,e+1),5,r)},yt[251]=function(t,e,n,r){return ot(dt(t,e+1),9,r)},yt[252]=gt,yt[253]=gt,yt[254]=gt,yt[255]=function(t,e,n,r){if(!1===r.allowIndefinite)throw new Error(`${C} indefinite length items not allowed`);return new d(f.break,void 0,1)};const wt=[];for(let Qp=0;Qp<24;Qp++)wt[Qp]=new d(f.uint,Qp,1);for(let Qp=-1;Qp>=-24;Qp--)wt[31-Qp]=new d(f.negint,Qp,1);wt[64]=new d(f.bytes,new Uint8Array(0),1),wt[96]=new d(f.string,"",1),wt[128]=new d(f.array,0,1),wt[160]=new d(f.map,0,1),wt[244]=new d(f.false,!1,1),wt[245]=new d(f.true,!0,1),wt[246]=new d(f.null,null,1);const mt={float64:!1,mapSorter:function(t,e){const n=Array.isArray(t[0])?t[0][0]:t[0],r=Array.isArray(e[0])?e[0][0]:e[0];if(n.type!==r.type)return n.type.compare(r.type);const o=n.type.major,i=bt[o].compareTokens(n,r);0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return i},quickEncodeToken:function(t){switch(t.type){case f.false:return E([244]);case f.true:return E([245]);case f.null:return E([246]);case f.bytes:return t.value.length?void 0:E([64]);case f.string:return""===t.value?E([96]):void 0;case f.array:return 0===t.value?E([128]):void 0;case f.map:return 0===t.value?E([160]):void 0;case f.uint:return t.value<24?E([Number(t.value)]):void 0;case f.negint:if(t.value>=-24)return E([31-Number(t.value)])}}};const bt=function(){const t=[];return t[f.uint.major]=j,t[f.negint.major]=V,t[f.bytes.major]=q,t[f.string.major]=Z,t[f.array.major]=Q,t[f.map.major]=et,t[f.tag.major]=rt,t[f.float.major]=it,t}(),vt=new N;class Et{constructor(t,e){this.obj=t,this.parent=e}includes(t){let e=this;do{if(e.obj===t)return!0}while(e=e.parent);return!1}static createCheck(t,e){if(t&&t.includes(e))throw new Error(`${U} object contains circular references`);return new Et(e,t)}}const Bt={null:new d(f.null,null),undefined:new d(f.undefined,void 0),true:new d(f.true,!0),false:new d(f.false,!1),emptyArray:new d(f.array,0),emptyMap:new d(f.map,0)},kt={number:(t,e,n,r)=>Number.isInteger(t)&&Number.isSafeInteger(t)?new d(t>=0?f.uint:f.negint,t):new d(f.float,t),bigint:(t,e,n,r)=>t>=BigInt(0)?new d(f.uint,t):new d(f.negint,t),Uint8Array:(t,e,n,r)=>new d(f.bytes,t),string:(t,e,n,r)=>new d(f.string,t),boolean:(t,e,n,r)=>t?Bt.true:Bt.false,null:(t,e,n,r)=>Bt.null,undefined:(t,e,n,r)=>Bt.undefined,ArrayBuffer:(t,e,n,r)=>new d(f.bytes,new Uint8Array(t)),DataView:(t,e,n,r)=>new d(f.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),Array(t,e,n,r){if(!t.length)return!0===n.addBreakTokens?[Bt.emptyArray,new d(f.break)]:Bt.emptyArray;r=Et.createCheck(r,t);const o=[];let i=0;for(const s of t)o[i++]=At(s,n,r);return n.addBreakTokens?[new d(f.array,t.length),o,new d(f.break)]:[new d(f.array,t.length),o]},Object(t,e,n,r){const o="Object"!==e,i=o?t.keys():Object.keys(t),s=o?t.size:i.length;if(!s)return!0===n.addBreakTokens?[Bt.emptyMap,new d(f.break)]:Bt.emptyMap;r=Et.createCheck(r,t);const a=[];let u=0;for(const c of i)a[u++]=[At(c,n,r),At(o?t.get(c):t[c],n,r)];return function(t,e){e.mapSorter&&t.sort(e.mapSorter)}(a,n),n.addBreakTokens?[new d(f.map,s),a,new d(f.break)]:[new d(f.map,s),a]}};kt.Map=kt.Object,kt.Buffer=kt.Uint8Array;for(const Qp of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))kt[`${Qp}Array`]=kt.DataView;function At(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=h(t),o=e&&e.typeEncoders&&e.typeEncoders[r]||kt[r];if("function"===typeof o){const i=o(t,r,e,n);if(null!=i)return i}const i=kt[r];if(!i)throw new Error(`${U} unsupported type: ${r}`);return i(t,r,e,n)}function xt(t,e,n,r){if(Array.isArray(e))for(const o of e)xt(t,o,n,r);else n[e.type.major](t,e,r)}function St(t,e,n){const r=At(t,n);if(!Array.isArray(r)&&n.quickEncodeToken){const t=n.quickEncodeToken(r);if(t)return t;const o=e[r.type.major];if(o.encodedSize){const t=o.encodedSize(r,n),e=new N(t);if(o(e,r,n),1!==e.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${r} was wrong`);return m(e.chunks[0])}}return vt.reset(),xt(vt,r,e,n),vt.toBytes(!0)}const It={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Nt{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=t,this.options=e}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let e=wt[t];if(void 0===e){const n=yt[t];if(!n)throw new Error(`${C} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const r=31&t;e=n(this.data,this._pos,r,this.options)}return this._pos+=e.encodedLength,e}}const Ct=Symbol.for("DONE"),Ut=Symbol.for("BREAK");function Tt(t,e){if(t.done())return Ct;const n=t.next();if(n.type===f.break)return Ut;if(n.type.terminal)return n.value;if(n.type===f.array)return function(t,e,n){const r=[];for(let o=0;o<t.value;o++){const i=Tt(e,n);if(i===Ut){if(t.value===1/0)break;throw new Error(`${C} got unexpected break to lengthed array`)}if(i===Ct)throw new Error(`${C} found array but not enough entries (got ${o}, expected ${t.value})`);r[o]=i}return r}(n,t,e);if(n.type===f.map)return function(t,e,n){const r=!0===n.useMaps,o=r?void 0:{},i=r?new Map:void 0;for(let s=0;s<t.value;s++){const a=Tt(e,n);if(a===Ut){if(t.value===1/0)break;throw new Error(`${C} got unexpected break to lengthed map`)}if(a===Ct)throw new Error(`${C} found map but not enough entries (got ${s} [no key], expected ${t.value})`);if(!0!==r&&"string"!==typeof a)throw new Error(`${C} non-string keys not supported (got ${typeof a})`);if(!0===n.rejectDuplicateMapKeys&&(r&&i.has(a)||!r&&a in o))throw new Error(`${C} found repeat map key "${a}"`);const u=Tt(e,n);if(u===Ct)throw new Error(`${C} found map but not enough entries (got ${s} [no value], expected ${t.value})`);r?i.set(a,u):o[a]=u}return r?i:o}(n,t,e);if(n.type===f.tag){if(e.tags&&"function"===typeof e.tags[n.value]){const r=Tt(t,e);return e.tags[n.value](r)}throw new Error(`${C} tag not supported (${n.value})`)}throw new Error("unsupported")}function $t(t,e){const[n,r]=function(t,e){if(!(t instanceof Uint8Array))throw new Error(`${C} data to decode must be a Uint8Array`);const n=(e=Object.assign({},It,e)).tokenizer||new Nt(t,e),r=Tt(n,e);if(r===Ct)throw new Error(`${C} did not find any content to decode`);if(r===Ut)throw new Error(`${C} got unexpected break`);return[r,t.subarray(n.pos())]}(t,e);if(r.length>0)throw new Error(`${C} too many terminals, data makes no sense`);return n}var Ot=n(6053);function Lt(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}const Rt={float64:!0,typeEncoders:{Object:function(t){if(t.asCID!==t&&t["/"]!==t.bytes)return null;const e=Ot.TO.asCID(t);if(!e)return null;const n=new Uint8Array(e.bytes.byteLength+1);return n.set(e.bytes,1),[new d(f.tag,42),new d(f.bytes,n)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}},Pt={...Rt,typeEncoders:{...Rt.typeEncoders}};const Dt={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Dt.tags[42]=function(t){if(0!==t[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return Ot.TO.decode(t.subarray(1))};const jt={...Dt,tags:Dt.tags.slice()},_t="dag-cbor",Ht=113,Ft=t=>{return e=t,n=Rt,n=Object.assign({},mt,n),St(e,bt,n);var e,n},Vt=t=>$t(Lt(t),Dt),Mt=["string","number","bigint","symbol"],zt=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Gt(t){if(null===t)return"null";if(void 0===t)return"undefined";if(!0===t||!1===t)return"boolean";const e=typeof t;if(Mt.includes(e))return e;if("function"===e)return"Function";if(Array.isArray(t))return"Array";if(function(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}(t))return"Buffer";const n=function(t){const e=Object.prototype.toString.call(t).slice(8,-1);if(zt.includes(e))return e;return}(t);return n||"Object"}class qt{constructor(t,e,n){this.major=t,this.majorEncoded=t<<5,this.name=e,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}qt.uint=new qt(0,"uint",!0),qt.negint=new qt(1,"negint",!0),qt.bytes=new qt(2,"bytes",!0),qt.string=new qt(3,"string",!0),qt.array=new qt(4,"array",!1),qt.map=new qt(5,"map",!1),qt.tag=new qt(6,"tag",!1),qt.float=new qt(7,"float",!0),qt.false=new qt(7,"false",!0),qt.true=new qt(7,"true",!0),qt.null=new qt(7,"null",!0),qt.undefined=new qt(7,"undefined",!0),qt.break=new qt(7,"break",!0);class Wt{constructor(t,e,n){this.type=t,this.value=e,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const Jt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,Zt=new TextDecoder,Kt=new TextEncoder;function Yt(t){return Jt&&globalThis.Buffer.isBuffer(t)}function Qt(t){return t instanceof Uint8Array?Yt(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}const Xt=Jt?(t,e,n)=>n-e>64?globalThis.Buffer.from(t.subarray(e,n)).toString("utf8"):ie(t,e,n):(t,e,n)=>n-e>64?Zt.decode(t.subarray(e,n)):ie(t,e,n),te=Jt?t=>t.length>64?globalThis.Buffer.from(t):oe(t):t=>t.length>64?Kt.encode(t):oe(t),ee=Jt?(t,e,n)=>Yt(t)?new Uint8Array(t.subarray(e,n)):t.slice(e,n):(t,e,n)=>t.slice(e,n),ne=Jt?(t,e)=>(t=t.map((t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t))),Qt(globalThis.Buffer.concat(t,e))):(t,e)=>{const n=new Uint8Array(e);let r=0;for(let o of t)r+o.length>n.length&&(o=o.subarray(0,n.length-r)),n.set(o,r),r+=o.length;return n},re=Jt?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function oe(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):55296===(64512&o)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(o=65536+((1023&o)<<10)+(1023&t.charCodeAt(++r)),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e}function ie(t,e,n){const r=[];for(;e<n;){const o=t[e];let i=null,s=o>239?4:o>223?3:o>191?2:1;if(e+s<=n){let n,r,a,u;switch(s){case 1:o<128&&(i=o);break;case 2:n=t[e+1],128===(192&n)&&(u=(31&o)<<6|63&n,u>127&&(i=u));break;case 3:n=t[e+1],r=t[e+2],128===(192&n)&&128===(192&r)&&(u=(15&o)<<12|(63&n)<<6|63&r,u>2047&&(u<55296||u>57343)&&(i=u));break;case 4:n=t[e+1],r=t[e+2],a=t[e+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(u=(15&o)<<18|(63&n)<<12|(63&r)<<6|63&a,u>65535&&u<1114112&&(i=u))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),e+=s}return ae(r)}const se=4096;function ae(t){const e=t.length;if(e<=se)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=se));return n}class ue{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let e=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const n=e.length-(this.maxCursor-this.cursor)-1;e.set(t,n)}else{if(e){const t=e.length-(this.maxCursor-this.cursor)-1;t<e.length&&(this.chunks[this.chunks.length-1]=e.subarray(0,t),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(e=re(this.chunkSize),this.chunks.push(e),this.maxCursor+=e.length,null===this._initReuseChunk&&(this._initReuseChunk=e),e.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(){let t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(1===this.chunks.length){const n=this.chunks[0];e&&this.cursor>n.length/2?(t=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=ee(n,0,this.cursor)}else t=ne(this.chunks,this.cursor);return e&&this.reset(),t}}const ce="CBOR decode error:",le="CBOR encode error:",he=[];function fe(t,e,n){if(t.length-e<n)throw new Error(`${ce} not enough data for type`)}he[23]=1,he[24]=2,he[25]=3,he[26]=5,he[27]=9;const de=[24,256,65536,4294967296,BigInt("18446744073709551616")];function ge(t,e,n){fe(t,e,1);const r=t[e];if(!0===n.strict&&r<de[0])throw new Error(`${ce} integer encoded in more bytes than necessary (strict decode)`);return r}function pe(t,e,n){fe(t,e,2);const r=t[e]<<8|t[e+1];if(!0===n.strict&&r<de[1])throw new Error(`${ce} integer encoded in more bytes than necessary (strict decode)`);return r}function ye(t,e,n){fe(t,e,4);const r=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(!0===n.strict&&r<de[2])throw new Error(`${ce} integer encoded in more bytes than necessary (strict decode)`);return r}function we(t,e,n){fe(t,e,8);const r=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],o=16777216*t[e+4]+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],i=(BigInt(r)<<BigInt(32))+BigInt(o);if(!0===n.strict&&i<de[3])throw new Error(`${ce} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===n.allowBigInt)return i;throw new Error(`${ce} integers outside of the safe integer range are not supported`)}function me(t,e){return be(t,0,e.value)}function be(t,e,n){if(n<de[0]){const r=Number(n);t.push([e|r])}else if(n<de[1]){const r=Number(n);t.push([24|e,r])}else if(n<de[2]){const r=Number(n);t.push([25|e,r>>>8,255&r])}else if(n<de[3]){const r=Number(n);t.push([26|e,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<de[4]))throw new Error(`${ce} encountered BigInt larger than allowable range`);{const n=[27|e,0,0,0,0,0,0,0];let o=Number(r&BigInt(4294967295)),i=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&o,o>>=8,n[7]=255&o,o>>=8,n[6]=255&o,o>>=8,n[5]=255&o,n[4]=255&i,i>>=8,n[3]=255&i,i>>=8,n[2]=255&i,i>>=8,n[1]=255&i,t.push(n)}}}me.encodedSize=function(t){return be.encodedSize(t.value)},be.encodedSize=function(t){return t<de[0]?1:t<de[1]?2:t<de[2]?3:t<de[3]?5:9},me.compareTokens=function(t,e){return t.value<e.value?-1:t.value>e.value?1:0};const ve=BigInt(-1),Ee=BigInt(1);function Be(t,e){const n=e.value,r="bigint"===typeof n?n*ve-Ee:-1*n-1;be(t,e.type.majorEncoded,r)}function ke(t,e,n,r){fe(t,e,n+r);const o=ee(t,e+n,e+n+r);return new Wt(qt.bytes,o,n+r)}function Ae(t,e,n,r){return ke(t,e,1,n)}function xe(t){return void 0===t.encodedBytes&&(t.encodedBytes=t.type===qt.string?te(t.value):t.value),t.encodedBytes}function Se(t,e){const n=xe(e);be(t,e.type.majorEncoded,n.length),t.push(n)}function Ie(t,e,n,r,o){const i=n+r;fe(t,e,i);const s=new Wt(qt.string,Xt(t,e+n,e+i),i);return!0===o.retainStringBytes&&(s.byteValue=ee(t,e+n,e+i)),s}function Ne(t,e,n,r){return Ie(t,e,1,n,r)}Be.encodedSize=function(t){const e=t.value,n="bigint"===typeof e?e*ve-Ee:-1*e-1;return n<de[0]?1:n<de[1]?2:n<de[2]?3:n<de[3]?5:9},Be.compareTokens=function(t,e){return t.value<e.value?1:t.value>e.value?-1:0},Se.encodedSize=function(t){const e=xe(t);return be.encodedSize(e.length)+e.length},Se.compareTokens=function(t,e){return n=xe(t),r=xe(e),n.length<r.length?-1:n.length>r.length?1:function(t,e){if(Yt(t)&&Yt(e))return t.compare(e);for(let n=0;n<t.length;n++)if(t[n]!==e[n])return t[n]<e[n]?-1:1;return 0}(n,r);var n,r};const Ce=Se;function Ue(t,e,n,r){return new Wt(qt.array,r,n)}function Te(t,e,n,r){return Ue(0,0,1,n)}function $e(t,e){be(t,qt.array.majorEncoded,e.value)}function Oe(t,e,n,r){return new Wt(qt.map,r,n)}function Le(t,e,n,r){return Oe(0,0,1,n)}function Re(t,e){be(t,qt.map.majorEncoded,e.value)}function Pe(t,e,n,r){return new Wt(qt.tag,n,1)}function De(t,e){be(t,qt.tag.majorEncoded,e.value)}$e.compareTokens=me.compareTokens,$e.encodedSize=function(t){return be.encodedSize(t.value)},Re.compareTokens=me.compareTokens,Re.encodedSize=function(t){return be.encodedSize(t.value)},De.compareTokens=me.compareTokens,De.encodedSize=function(t){return be.encodedSize(t.value)};function je(t,e,n){if(n){if(!1===n.allowNaN&&Number.isNaN(t))throw new Error(`${ce} NaN values are not supported`);if(!1===n.allowInfinity&&(t===1/0||t===-1/0))throw new Error(`${ce} Infinity values are not supported`)}return new Wt(qt.float,t,e)}function _e(t,e,n){const r=e.value;if(!1===r)t.push([20|qt.float.majorEncoded]);else if(!0===r)t.push([21|qt.float.majorEncoded]);else if(null===r)t.push([22|qt.float.majorEncoded]);else if(void 0===r)t.push([23|qt.float.majorEncoded]);else{let e,i=!1;n&&!0===n.float64||(Me(r),e=ze(Ve,1),r===e||Number.isNaN(r)?(Ve[0]=249,t.push(Ve.slice(0,3)),i=!0):(Ge(r),e=qe(Ve,1),r===e&&(Ve[0]=250,t.push(Ve.slice(0,5)),i=!0))),i||(o=r,Fe.setFloat64(0,o,!1),e=We(Ve,1),Ve[0]=251,t.push(Ve.slice(0,9)))}var o}_e.encodedSize=function(t,e){const n=t.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!e||!0!==e.float64){Me(n);let t=ze(Ve,1);if(n===t||Number.isNaN(n))return 3;if(Ge(n),t=qe(Ve,1),n===t)return 5}return 9};const He=new ArrayBuffer(9),Fe=new DataView(He,1),Ve=new Uint8Array(He,0);function Me(t){if(t===1/0)Fe.setUint16(0,31744,!1);else if(t===-1/0)Fe.setUint16(0,64512,!1);else if(Number.isNaN(t))Fe.setUint16(0,32256,!1);else{Fe.setFloat32(0,t);const e=Fe.getUint32(0),n=(2139095040&e)>>23,r=8388607&e;if(255===n)Fe.setUint16(0,31744,!1);else if(0===n)Fe.setUint16(0,(2147483648&t)>>16|r>>13,!1);else{const t=n-127;t<-24?Fe.setUint16(0,0):t<-14?Fe.setUint16(0,(2147483648&e)>>16|1<<24+t,!1):Fe.setUint16(0,(2147483648&e)>>16|t+15<<10|r>>13,!1)}}}function ze(t,e){if(t.length-e<2)throw new Error(`${ce} not enough data for float16`);const n=(t[e]<<8)+t[e+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,o=1023&n;let i;return i=0===r?o*2**-24:31!==r?(o+1024)*2**(r-25):0===o?1/0:NaN,32768&n?-i:i}function Ge(t){Fe.setFloat32(0,t,!1)}function qe(t,e){if(t.length-e<4)throw new Error(`${ce} not enough data for float32`);const n=(t.byteOffset||0)+e;return new DataView(t.buffer,n,4).getFloat32(0,!1)}function We(t,e){if(t.length-e<8)throw new Error(`${ce} not enough data for float64`);const n=(t.byteOffset||0)+e;return new DataView(t.buffer,n,8).getFloat64(0,!1)}function Je(t,e,n){throw new Error(`${ce} encountered invalid minor (${n}) for major ${t[e]>>>5}`)}function Ze(t){return()=>{throw new Error(`${ce} ${t}`)}}_e.compareTokens=me.compareTokens;const Ke=[];for(let Qp=0;Qp<=23;Qp++)Ke[Qp]=Je;Ke[24]=function(t,e,n,r){return new Wt(qt.uint,ge(t,e+1,r),2)},Ke[25]=function(t,e,n,r){return new Wt(qt.uint,pe(t,e+1,r),3)},Ke[26]=function(t,e,n,r){return new Wt(qt.uint,ye(t,e+1,r),5)},Ke[27]=function(t,e,n,r){return new Wt(qt.uint,we(t,e+1,r),9)},Ke[28]=Je,Ke[29]=Je,Ke[30]=Je,Ke[31]=Je;for(let Qp=32;Qp<=55;Qp++)Ke[Qp]=Je;Ke[56]=function(t,e,n,r){return new Wt(qt.negint,-1-ge(t,e+1,r),2)},Ke[57]=function(t,e,n,r){return new Wt(qt.negint,-1-pe(t,e+1,r),3)},Ke[58]=function(t,e,n,r){return new Wt(qt.negint,-1-ye(t,e+1,r),5)},Ke[59]=function(t,e,n,r){const o=we(t,e+1,r);if("bigint"!==typeof o){const t=-1-o;if(t>=Number.MIN_SAFE_INTEGER)return new Wt(qt.negint,t,9)}if(!0!==r.allowBigInt)throw new Error(`${ce} integers outside of the safe integer range are not supported`);return new Wt(qt.negint,ve-BigInt(o),9)},Ke[60]=Je,Ke[61]=Je,Ke[62]=Je,Ke[63]=Je;for(let Qp=64;Qp<=87;Qp++)Ke[Qp]=Ae;Ke[88]=function(t,e,n,r){return ke(t,e,2,ge(t,e+1,r))},Ke[89]=function(t,e,n,r){return ke(t,e,3,pe(t,e+1,r))},Ke[90]=function(t,e,n,r){return ke(t,e,5,ye(t,e+1,r))},Ke[91]=function(t,e,n,r){const o=we(t,e+1,r);if("bigint"===typeof o)throw new Error(`${ce} 64-bit integer bytes lengths not supported`);return ke(t,e,9,o)},Ke[92]=Je,Ke[93]=Je,Ke[94]=Je,Ke[95]=Ze("indefinite length bytes/strings are not supported");for(let Qp=96;Qp<=119;Qp++)Ke[Qp]=Ne;Ke[120]=function(t,e,n,r){return Ie(t,e,2,ge(t,e+1,r),r)},Ke[121]=function(t,e,n,r){return Ie(t,e,3,pe(t,e+1,r),r)},Ke[122]=function(t,e,n,r){return Ie(t,e,5,ye(t,e+1,r),r)},Ke[123]=function(t,e,n,r){const o=we(t,e+1,r);if("bigint"===typeof o)throw new Error(`${ce} 64-bit integer string lengths not supported`);return Ie(t,e,9,o,r)},Ke[124]=Je,Ke[125]=Je,Ke[126]=Je,Ke[127]=Ze("indefinite length bytes/strings are not supported");for(let Qp=128;Qp<=151;Qp++)Ke[Qp]=Te;Ke[152]=function(t,e,n,r){return Ue(0,0,2,ge(t,e+1,r))},Ke[153]=function(t,e,n,r){return Ue(0,0,3,pe(t,e+1,r))},Ke[154]=function(t,e,n,r){return Ue(0,0,5,ye(t,e+1,r))},Ke[155]=function(t,e,n,r){const o=we(t,e+1,r);if("bigint"===typeof o)throw new Error(`${ce} 64-bit integer array lengths not supported`);return Ue(0,0,9,o)},Ke[156]=Je,Ke[157]=Je,Ke[158]=Je,Ke[159]=function(t,e,n,r){if(!1===r.allowIndefinite)throw new Error(`${ce} indefinite length items not allowed`);return Ue(0,0,1,1/0)};for(let Qp=160;Qp<=183;Qp++)Ke[Qp]=Le;Ke[184]=function(t,e,n,r){return Oe(0,0,2,ge(t,e+1,r))},Ke[185]=function(t,e,n,r){return Oe(0,0,3,pe(t,e+1,r))},Ke[186]=function(t,e,n,r){return Oe(0,0,5,ye(t,e+1,r))},Ke[187]=function(t,e,n,r){const o=we(t,e+1,r);if("bigint"===typeof o)throw new Error(`${ce} 64-bit integer map lengths not supported`);return Oe(0,0,9,o)},Ke[188]=Je,Ke[189]=Je,Ke[190]=Je,Ke[191]=function(t,e,n,r){if(!1===r.allowIndefinite)throw new Error(`${ce} indefinite length items not allowed`);return Oe(0,0,1,1/0)};for(let Qp=192;Qp<=215;Qp++)Ke[Qp]=Pe;Ke[216]=function(t,e,n,r){return new Wt(qt.tag,ge(t,e+1,r),2)},Ke[217]=function(t,e,n,r){return new Wt(qt.tag,pe(t,e+1,r),3)},Ke[218]=function(t,e,n,r){return new Wt(qt.tag,ye(t,e+1,r),5)},Ke[219]=function(t,e,n,r){return new Wt(qt.tag,we(t,e+1,r),9)},Ke[220]=Je,Ke[221]=Je,Ke[222]=Je,Ke[223]=Je;for(let Qp=224;Qp<=243;Qp++)Ke[Qp]=Ze("simple values are not supported");Ke[244]=Je,Ke[245]=Je,Ke[246]=Je,Ke[247]=function(t,e,n,r){if(!1===r.allowUndefined)throw new Error(`${ce} undefined values are not supported`);return!0===r.coerceUndefinedToNull?new Wt(qt.null,null,1):new Wt(qt.undefined,void 0,1)},Ke[248]=Ze("simple values are not supported"),Ke[249]=function(t,e,n,r){return je(ze(t,e+1),3,r)},Ke[250]=function(t,e,n,r){return je(qe(t,e+1),5,r)},Ke[251]=function(t,e,n,r){return je(We(t,e+1),9,r)},Ke[252]=Je,Ke[253]=Je,Ke[254]=Je,Ke[255]=function(t,e,n,r){if(!1===r.allowIndefinite)throw new Error(`${ce} indefinite length items not allowed`);return new Wt(qt.break,void 0,1)};const Ye=[];for(let Qp=0;Qp<24;Qp++)Ye[Qp]=new Wt(qt.uint,Qp,1);for(let Qp=-1;Qp>=-24;Qp--)Ye[31-Qp]=new Wt(qt.negint,Qp,1);Ye[64]=new Wt(qt.bytes,new Uint8Array(0),1),Ye[96]=new Wt(qt.string,"",1),Ye[128]=new Wt(qt.array,0,1),Ye[160]=new Wt(qt.map,0,1),Ye[244]=new Wt(qt.false,!1,1),Ye[245]=new Wt(qt.true,!0,1),Ye[246]=new Wt(qt.null,null,1);!function(){const t=[];t[qt.uint.major]=me,t[qt.negint.major]=Be,t[qt.bytes.major]=Se,t[qt.string.major]=Ce,t[qt.array.major]=$e,t[qt.map.major]=Re,t[qt.tag.major]=De,t[qt.float.major]=_e}();const Qe=new ue;class Xe{constructor(t,e){this.obj=t,this.parent=e}includes(t){let e=this;do{if(e.obj===t)return!0}while(e=e.parent);return!1}static createCheck(t,e){if(t&&t.includes(e))throw new Error(`${le} object contains circular references`);return new Xe(e,t)}}const tn={null:new Wt(qt.null,null),undefined:new Wt(qt.undefined,void 0),true:new Wt(qt.true,!0),false:new Wt(qt.false,!1),emptyArray:new Wt(qt.array,0),emptyMap:new Wt(qt.map,0)},en={number:(t,e,n,r)=>Number.isInteger(t)&&Number.isSafeInteger(t)?new Wt(t>=0?qt.uint:qt.negint,t):new Wt(qt.float,t),bigint:(t,e,n,r)=>t>=BigInt(0)?new Wt(qt.uint,t):new Wt(qt.negint,t),Uint8Array:(t,e,n,r)=>new Wt(qt.bytes,t),string:(t,e,n,r)=>new Wt(qt.string,t),boolean:(t,e,n,r)=>t?tn.true:tn.false,null:(t,e,n,r)=>tn.null,undefined:(t,e,n,r)=>tn.undefined,ArrayBuffer:(t,e,n,r)=>new Wt(qt.bytes,new Uint8Array(t)),DataView:(t,e,n,r)=>new Wt(qt.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),Array(t,e,n,r){if(!t.length)return!0===n.addBreakTokens?[tn.emptyArray,new Wt(qt.break)]:tn.emptyArray;r=Xe.createCheck(r,t);const o=[];let i=0;for(const s of t)o[i++]=nn(s,n,r);return n.addBreakTokens?[new Wt(qt.array,t.length),o,new Wt(qt.break)]:[new Wt(qt.array,t.length),o]},Object(t,e,n,r){const o="Object"!==e,i=o?t.keys():Object.keys(t),s=o?t.size:i.length;if(!s)return!0===n.addBreakTokens?[tn.emptyMap,new Wt(qt.break)]:tn.emptyMap;r=Xe.createCheck(r,t);const a=[];let u=0;for(const c of i)a[u++]=[nn(c,n,r),nn(o?t.get(c):t[c],n,r)];return function(t,e){e.mapSorter&&t.sort(e.mapSorter)}(a,n),n.addBreakTokens?[new Wt(qt.map,s),a,new Wt(qt.break)]:[new Wt(qt.map,s),a]}};en.Map=en.Object,en.Buffer=en.Uint8Array;for(const Qp of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))en[`${Qp}Array`]=en.DataView;function nn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=Gt(t),o=e&&e.typeEncoders&&e.typeEncoders[r]||en[r];if("function"===typeof o){const i=o(t,r,e,n);if(null!=i)return i}const i=en[r];if(!i)throw new Error(`${le} unsupported type: ${r}`);return i(t,r,e,n)}function rn(t,e,n,r){if(Array.isArray(e))for(const o of e)rn(t,o,n,r);else n[e.type.major](t,e,r)}function on(t,e,n){const r=nn(t,n);if(!Array.isArray(r)&&n.quickEncodeToken){const t=n.quickEncodeToken(r);if(t)return t;const o=e[r.type.major];if(o.encodedSize){const t=o.encodedSize(r,n),e=new ue(t);if(o(e,r,n),1!==e.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${r} was wrong`);return Qt(e.chunks[0])}}return Qe.reset(),rn(Qe,r,e,n),Qe.toBytes(!0)}const sn={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class an{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=t,this.options=e}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let e=Ye[t];if(void 0===e){const n=Ke[t];if(!n)throw new Error(`${ce} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const r=31&t;e=n(this.data,this._pos,r,this.options)}return this._pos+=e.encodedLength,e}}const un=Symbol.for("DONE"),cn=Symbol.for("BREAK");function ln(t,e){if(t.done())return un;const n=t.next();if(n.type===qt.break)return cn;if(n.type.terminal)return n.value;if(n.type===qt.array)return function(t,e,n){const r=[];for(let o=0;o<t.value;o++){const i=ln(e,n);if(i===cn){if(t.value===1/0)break;throw new Error(`${ce} got unexpected break to lengthed array`)}if(i===un)throw new Error(`${ce} found array but not enough entries (got ${o}, expected ${t.value})`);r[o]=i}return r}(n,t,e);if(n.type===qt.map)return function(t,e,n){const r=!0===n.useMaps,o=r?void 0:{},i=r?new Map:void 0;for(let s=0;s<t.value;s++){const a=ln(e,n);if(a===cn){if(t.value===1/0)break;throw new Error(`${ce} got unexpected break to lengthed map`)}if(a===un)throw new Error(`${ce} found map but not enough entries (got ${s} [no key], expected ${t.value})`);if(!0!==r&&"string"!==typeof a)throw new Error(`${ce} non-string keys not supported (got ${typeof a})`);if(!0===n.rejectDuplicateMapKeys&&(r&&i.has(a)||!r&&a in o))throw new Error(`${ce} found repeat map key "${a}"`);const u=ln(e,n);if(u===un)throw new Error(`${ce} found map but not enough entries (got ${s} [no value], expected ${t.value})`);r?i.set(a,u):o[a]=u}return r?i:o}(n,t,e);if(n.type===qt.tag){if(e.tags&&"function"===typeof e.tags[n.value]){const r=ln(t,e);return e.tags[n.value](r)}throw new Error(`${ce} tag not supported (${n.value})`)}throw new Error("unsupported")}function hn(t,e){const[n,r]=function(t,e){if(!(t instanceof Uint8Array))throw new Error(`${ce} data to decode must be a Uint8Array`);const n=(e=Object.assign({},sn,e)).tokenizer||new an(t,e),r=ln(n,e);if(r===un)throw new Error(`${ce} did not find any content to decode`);if(r===cn)throw new Error(`${ce} got unexpected break`);return[r,t.subarray(n.pos())]}(t,e);if(r.length>0)throw new Error(`${ce} too many terminals, data makes no sense`);return n}class fn extends Array{constructor(){super(),this.inRecursive=[]}prefix(t){const e=this.inRecursive[this.inRecursive.length-1];e&&(e.type===qt.array&&(e.elements++,1!==e.elements&&t.push([44])),e.type===qt.map&&(e.elements++,1!==e.elements&&(e.elements%2===1?t.push([44]):t.push([58]))))}[qt.uint.major](t,e){this.prefix(t);const n=String(e.value),r=[];for(let o=0;o<n.length;o++)r[o]=n.charCodeAt(o);t.push(r)}[qt.negint.major](t,e){this[qt.uint.major](t,e)}[qt.bytes.major](t,e){throw new Error(`${le} unsupported type: Uint8Array`)}[qt.string.major](t,e){this.prefix(t);const n=te(JSON.stringify(e.value));t.push(n.length>32?Qt(n):n)}[qt.array.major](t,e){this.prefix(t),this.inRecursive.push({type:qt.array,elements:0}),t.push([91])}[qt.map.major](t,e){this.prefix(t),this.inRecursive.push({type:qt.map,elements:0}),t.push([123])}[qt.tag.major](t,e){}[qt.float.major](t,e){if("break"===e.type.name){const e=this.inRecursive.pop();if(e){if(e.type===qt.array)t.push([93]);else{if(e.type!==qt.map)throw new Error("Unexpected recursive type; this should not happen!");t.push([125])}return}throw new Error("Unexpected break; this should not happen!")}if(void 0===e.value)throw new Error(`${le} unsupported type: undefined`);if(this.prefix(t),"true"===e.type.name)return void t.push([116,114,117,101]);if("false"===e.type.name)return void t.push([102,97,108,115,101]);if("null"===e.type.name)return void t.push([110,117,108,108]);const n=String(e.value),r=[];let o=!1;for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i),o||46!==r[i]&&101!==r[i]&&69!==r[i]||(o=!0);o||(r.push(46),r.push(48)),t.push(r)}}const dn={addBreakTokens:!0,mapSorter:function(t,e){if(Array.isArray(t[0])||Array.isArray(e[0]))throw new Error(`${le} complex map keys are not supported`);const n=t[0],r=e[0];if(n.type!==qt.string||r.type!==qt.string)throw new Error(`${le} non-string map keys are not supported`);if(n<r)return-1;if(n>r)return 1;throw new Error(`${le} unexpected duplicate map keys, this is not supported`)}};class gn{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._pos=0,this.data=t,this.options=e,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let t=this.ch();for(;32===t||9===t||13===t||10===t;)t=this.data[++this._pos]}expect(t){if(this.data.length-this._pos<t.length)throw new Error(`${ce} unexpected end of input at position ${this._pos}`);for(let e=0;e<t.length;e++)if(this.data[this._pos++]!==t[e])throw new Error(`${ce} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...t)}'`)}parseNumber(){const t=this._pos;let e=!1,n=!1;const r=t=>{for(;!this.done();){const e=this.ch();if(!t.includes(e))break;this._pos++}};if(45===this.ch()&&(e=!0,this._pos++),48===this.ch()){if(this._pos++,46!==this.ch())return new Wt(qt.uint,0,this._pos-t);this._pos++,n=!0}if(r([48,49,50,51,52,53,54,55,56,57]),e&&this._pos===t+1)throw new Error(`${ce} unexpected token at position ${this._pos}`);if(!this.done()&&46===this.ch()){if(n)throw new Error(`${ce} unexpected token at position ${this._pos}`);n=!0,this._pos++,r([48,49,50,51,52,53,54,55,56,57])}this.done()||101!==this.ch()&&69!==this.ch()||(n=!0,this._pos++,this.done()||43!==this.ch()&&45!==this.ch()||this._pos++,r([48,49,50,51,52,53,54,55,56,57]));const o=String.fromCharCode.apply(null,this.data.subarray(t,this._pos)),i=parseFloat(o);return n?new Wt(qt.float,i,this._pos-t):!0!==this.options.allowBigInt||Number.isSafeInteger(i)?new Wt(i>=0?qt.uint:qt.negint,i,this._pos-t):new Wt(i>=0?qt.uint:qt.negint,BigInt(o),this._pos-t)}parseString(){if(34!==this.ch())throw new Error(`${ce} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let o=this._pos,i=0;o<this.data.length&&i<65536;o++,i++){const t=this.data[o];if(92===t||t<32||t>=128)break;if(34===t){const t=String.fromCharCode.apply(null,this.data.subarray(this._pos,o));return this._pos=o+1,new Wt(qt.string,t,i)}}const t=this._pos,e=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error(`${ce} unexpected end of unicode escape sequence at position ${this._pos}`);let t=0;for(let e=0;e<4;e++){let e=this.ch();if(e>=48&&e<=57)e-=48;else if(e>=97&&e<=102)e=e-97+10;else{if(!(e>=65&&e<=70))throw new Error(`${ce} unexpected unicode escape character at position ${this._pos}`);e=e-65+10}t=16*t+e,this._pos++}return t},r=()=>{const t=this.ch();let n,r,o,i,s=null,a=t>239?4:t>223?3:t>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${ce} unexpected unicode sequence at position ${this._pos}`);switch(a){case 1:t<128&&(s=t);break;case 2:n=this.data[this._pos+1],128===(192&n)&&(i=(31&t)<<6|63&n,i>127&&(s=i));break;case 3:n=this.data[this._pos+1],r=this.data[this._pos+2],128===(192&n)&&128===(192&r)&&(i=(15&t)<<12|(63&n)<<6|63&r,i>2047&&(i<55296||i>57343)&&(s=i));break;case 4:n=this.data[this._pos+1],r=this.data[this._pos+2],o=this.data[this._pos+3],128===(192&n)&&128===(192&r)&&128===(192&o)&&(i=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&o,i>65535&&i<1114112&&(s=i))}null===s?(s=65533,a=1):s>65535&&(s-=65536,e.push(s>>>10&1023|55296),s=56320|1023&s),e.push(s),this._pos+=a};for(;!this.done();){const o=this.ch();let i;switch(o){case 92:if(this._pos++,this.done())throw new Error(`${ce} unexpected string termination at position ${this._pos}`);switch(i=this.ch(),this._pos++,i){case 34:case 39:case 92:case 47:e.push(i);break;case 98:e.push(8);break;case 116:e.push(9);break;case 110:e.push(10);break;case 102:e.push(12);break;case 114:e.push(13);break;case 117:e.push(n());break;default:throw new Error(`${ce} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new Wt(qt.string,ae(e),this._pos-t);default:if(o<32)throw new Error(`${ce} invalid control character at position ${this._pos}`);o<128?(e.push(o),this._pos++):r()}}throw new Error(`${ce} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new Wt(qt.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new Wt(qt.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Wt(qt.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Wt(qt.false,!1,5);case 116:return this.expect([116,114,117,101]),new Wt(qt.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${ce} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":if(this.modeStack.pop(),93===this.ch())return this._pos++,this.skipWhitespace(),new Wt(qt.break,void 0,1);if(44!==this.ch())throw new Error(`${ce} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue();case"array-start":return this.modeStack.pop(),93===this.ch()?(this._pos++,this.skipWhitespace(),new Wt(qt.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(125===this.ch())return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new Wt(qt.break,void 0,1);if(44!==this.ch())throw new Error(`${ce} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),125===this.ch())return this._pos++,this.skipWhitespace(),new Wt(qt.break,void 0,1);const t=this.parseString();if(this.skipWhitespace(),58!==this.ch())throw new Error(`${ce} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),t}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${ce} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}var pn=n(2877),yn=n(2469);function wn(t){const e=yn.base64.encode(t).slice(1);return[new Wt(qt.map,1/0,1),new Wt(qt.string,"/",1),new Wt(qt.map,1/0,1),new Wt(qt.string,"bytes",5),new Wt(qt.string,e,e.length),new Wt(qt.break,void 0,1),new Wt(qt.break,void 0,1)]}function mn(t){return wn(new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}const bn={typeEncoders:{Object:function(t){if(t.asCID!==t&&t["/"]!==t.bytes)return null;const e=pn.TO.asCID(t);if(!e)return null;const n=e.toString();return[new Wt(qt.map,1/0,1),new Wt(qt.string,"/",1),new Wt(qt.string,n,n.length),new Wt(qt.break,void 0,1)]},Buffer:wn,Uint8Array:wn,Int8Array:mn,Uint16Array:mn,Int16Array:mn,Uint32Array:mn,Int32Array:mn,Float32Array:mn,Float64Array:mn,Uint8ClampedArray:mn,BigInt64Array:mn,BigUint64Array:mn,DataView:mn,ArrayBuffer:function(t){return wn(new Uint8Array(t))},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};class vn extends gn{constructor(t,e){super(t,e),this.tokenBuffer=[]}done(){return 0===this.tokenBuffer.length&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const t=this._next();if(t.type===qt.map){const t=this._next();if(t.type===qt.string&&"/"===t.value){const t=this._next();if(t.type===qt.string){if(this._next().type!==qt.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(t),new Wt(qt.tag,42,0)}if(t.type===qt.map){const t=this._next();if(t.type===qt.string&&"bytes"===t.value){const t=this._next();if(t.type===qt.string){for(let t=0;t<2;t++){if(this._next().type!==qt.break)throw new Error("Invalid encoded Bytes form")}const e=yn.base64.decode(`m${t.value}`);return new Wt(qt.bytes,e,t.value.length)}this.tokenBuffer.push(t)}this.tokenBuffer.push(t)}this.tokenBuffer.push(t)}this.tokenBuffer.push(t)}return t}}const En={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};En.tags[42]=pn.TO.parse;const Bn="dag-json",kn=297,An=t=>{return e=t,n=bn,n=Object.assign({},dn,n),on(e,new fn,n);var e,n},xn=t=>{const e=function(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}(t);return function(t,e){return hn(t,e=Object.assign({tokenizer:new gn(t,e)},e))}(e,Object.assign(En,{tokenizer:new vn(e,En)}))},Sn=t=>In.decode(An(t)),In=new TextDecoder,Nn=t=>xn(Cn.encode(t)),Cn=new TextEncoder,Un=new TextDecoder;function Tn(t,e){let n=0;for(let r=0;;r+=7){if(r>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");const o=t[e++];if(n+=r<28?(127&o)<<r:(127&o)*2**r,o<128)break}return[n,e]}function $n(t,e){let n;[n,e]=Tn(t,e);const r=e+n;if(n<0||r<0)throw new Error("protobuf: invalid length");if(r>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,r),r]}function On(t,e){let n;return[n,e]=Tn(t,e),[7&n,n>>3,e]}function Ln(t){const e={},n=t.length;let r=0;for(;r<n;){let n,o;if([n,o,r]=On(t,r),1===o){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(2!==n)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(void 0!==e.Name)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(void 0!==e.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,r]=$n(t,r)}else if(2===o){if(void 0!==e.Name)throw new Error("protobuf: (PBLink) duplicate Name section");if(2!==n)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(void 0!==e.Tsize)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,r]=$n(t,r),e.Name=Un.decode(o)}else{if(3!==o)throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`);if(void 0!==e.Tsize)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(0!==n)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[e.Tsize,r]=Tn(t,r)}}if(r>n)throw new Error("protobuf: (PBLink) unexpected end of data");return e}const Rn=new TextEncoder,Pn=2**32,Dn=2**31;function jn(t,e){let n=e.length;if("number"===typeof t.Tsize){if(t.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(t.Tsize))throw new Error("Tsize too large for encoding");n=Fn(e,n,t.Tsize)-1,e[n]=24}if("string"===typeof t.Name){const r=Rn.encode(t.Name);n-=r.length,e.set(r,n),n=Fn(e,n,r.length)-1,e[n]=18}return t.Hash&&(n-=t.Hash.length,e.set(t.Hash,n),n=Fn(e,n,t.Hash.length)-1,e[n]=10),e.length-n}function _n(t){const e=function(t){let e=0;if(t.Data){const n=t.Data.length;e+=1+n+Vn(n)}if(t.Links)for(const n of t.Links){const t=Hn(n);e+=1+t+Vn(t)}return e}(t),n=new Uint8Array(e);let r=e;if(t.Data&&(r-=t.Data.length,n.set(t.Data,r),r=Fn(n,r,t.Data.length)-1,n[r]=10),t.Links)for(let o=t.Links.length-1;o>=0;o--){const e=jn(t.Links[o],n.subarray(0,r));r-=e,r=Fn(n,r,e)-1,n[r]=18}return n}function Hn(t){let e=0;if(t.Hash){const n=t.Hash.length;e+=1+n+Vn(n)}if("string"===typeof t.Name){const n=Rn.encode(t.Name).length;e+=1+n+Vn(n)}return"number"===typeof t.Tsize&&(e+=1+Vn(t.Tsize)),e}function Fn(t,e,n){const r=e-=Vn(n);for(;n>=Dn;)t[e++]=127&n|128,n/=128;for(;n>=128;)t[e++]=127&n|128,n>>>=7;return t[e]=n,r}function Vn(t){return t%2===0&&t++,Math.floor((function(t){let e=0;t>=Pn&&(t=Math.floor(t/Pn),e=32);t>=65536&&(t>>>=16,e+=16);t>=256&&(t>>>=8,e+=8);return e+Mn[t]}(t)+6)/7)}const Mn=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],zn=["Data","Links"],Gn=["Hash","Name","Tsize"],qn=new TextEncoder;function Wn(t,e){if(t===e)return 0;const n=t.Name?qn.encode(t.Name):[],r=e.Name?qn.encode(e.Name):[];let o=n.length,i=r.length;for(let s=0,a=Math.min(o,i);s<a;++s)if(n[s]!==r[s]){o=n[s],i=r[s];break}return o<i?-1:i<o?1:0}function Jn(t,e){return!Object.keys(t).some((t=>!e.includes(t)))}function Zn(t){if("object"===typeof t.asCID){const e=Ot.TO.asCID(t);if(!e)throw new TypeError("Invalid DAG-PB form");return{Hash:e}}if("object"!==typeof t||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");const e={};if(t.Hash){let r=Ot.TO.asCID(t.Hash);try{r||("string"===typeof t.Hash?r=Ot.TO.parse(t.Hash):t.Hash instanceof Uint8Array&&(r=Ot.TO.decode(t.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}r&&(e.Hash=r)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return"string"===typeof t.Name&&(e.Name=t.Name),"number"===typeof t.Tsize&&(e.Tsize=t.Tsize),e}function Kn(t){if((t instanceof Uint8Array||"string"===typeof t)&&(t={Data:t}),"object"!==typeof t||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");const e={};if(void 0!==t.Data)if("string"===typeof t.Data)e.Data=qn.encode(t.Data);else{if(!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form");e.Data=t.Data}if(void 0!==t.Links){if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form");e.Links=t.Links.map(Zn),e.Links.sort(Wn)}else e.Links=[];return e}function Yn(t){if(!t||"object"!==typeof t||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form");if(!Jn(t,zn))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(void 0!==t.Data&&!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let e=0;e<t.Links.length;e++){const n=t.Links[e];if(!n||"object"!==typeof n||Array.isArray(n)||n instanceof Uint8Array||n["/"]&&n["/"]===n.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!Jn(n,Gn))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(void 0===n.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(null==n.Hash||!n.Hash["/"]||n.Hash["/"]!==n.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(void 0!==n.Name&&"string"!==typeof n.Name)throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(void 0!==n.Tsize){if("number"!==typeof n.Tsize||n.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(n.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(e>0&&-1===Wn(n,t.Links[e-1]))throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function Qn(t){return Kn({Data:t,Links:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]})}function Xn(t,e,n){return Zn({Hash:n,Name:t,Tsize:e})}const tr="dag-pb",er=112;function nr(t){Yn(t);const e={};return t.Links&&(e.Links=t.Links.map((t=>{const e={};return t.Hash&&(e.Hash=t.Hash.bytes),void 0!==t.Name&&(e.Name=t.Name),void 0!==t.Tsize&&(e.Tsize=t.Tsize),e}))),t.Data&&(e.Data=t.Data),_n(e)}function rr(t){const e=function(t){const e=t.length;let n,r,o=0,i=!1;for(;o<e;){let e,s;if([e,s,o]=On(t,o),2!==e)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${e}`);if(1===s){if(r)throw new Error("protobuf: (PBNode) duplicate Data section");[r,o]=$n(t,o),n&&(i=!0)}else{if(2!==s)throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${s}`);{if(i)throw new Error("protobuf: (PBNode) duplicate Links section");let e;n||(n=[]),[e,o]=$n(t,o),n.push(Ln(e))}}}if(o>e)throw new Error("protobuf: (PBNode) unexpected end of data");const s={};return r&&(s.Data=r),s.Links=n||[],s}(function(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}(t)),n={};return e.Data&&(n.Data=e.Data),e.Links&&(n.Links=e.Links.map((t=>{const e={};try{e.Hash=Ot.TO.decode(t.Hash)}catch(n){}if(!e.Hash)throw new Error("Invalid Hash field found in link, expected CID");return void 0!==t.Name&&(e.Name=t.Name),void 0!==t.Tsize&&(e.Tsize=t.Tsize),e}))),n}new Uint8Array(0);function or(t){if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}var ir=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var o=0;o<t.length;o++){var i=t.charAt(o),s=i.charCodeAt(0);if(255!==n[s])throw new TypeError(i+" is ambiguous");n[s]=o}var a=t.length,u=t.charAt(0),c=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function h(t){if("string"!==typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var r=0,o=0;t[e]===u;)r++,e++;for(var i=(t.length-e)*c+1>>>0,s=new Uint8Array(i);t[e];){var l=n[t.charCodeAt(e)];if(255===l)return;for(var h=0,f=i-1;(0!==l||h<o)&&-1!==f;f--,h++)l+=a*s[f]>>>0,s[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");o=h,e++}if(" "!==t[e]){for(var d=i-o;d!==i&&0===s[d];)d++;for(var g=new Uint8Array(r+(i-d)),p=r;d!==i;)g[p++]=s[d++];return g}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var n=0,r=0,o=0,i=e.length;o!==i&&0===e[o];)o++,n++;for(var s=(i-o)*l+1>>>0,c=new Uint8Array(s);o!==i;){for(var h=e[o],f=0,d=s-1;(0!==h||f<r)&&-1!==d;d--,f++)h+=256*c[d]>>>0,c[d]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");r=f,o++}for(var g=s-r;g!==s&&0===c[g];)g++;for(var p=u.repeat(n);g<s;++g)p+=t.charAt(c[g]);return p},decodeUnsafe:h,decode:function(t){var n=h(t);if(n)return n;throw new Error(`Non-${e} character`)}}};const sr=ir;class ar{name;prefix;baseEncode;constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class ur{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,n){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=n}decode(t){if("string"===typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return lr(this,t)}}class cr{decoders;constructor(t){this.decoders=t}or(t){return lr(this,t)}decode(t){const e=t[0],n=this.decoders[e];if(null!=n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function lr(t,e){return new cr({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}class hr{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,n,r){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=r,this.encoder=new ar(t,e,n),this.decoder=new ur(t,e,r)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function fr({name:t,prefix:e,encode:n,decode:r}){return new hr(t,e,n,r)}function dr({name:t,prefix:e,alphabet:n}){const{encode:r,decode:o}=sr(n,t);return fr({prefix:e,name:t,encode:r,decode:t=>or(o(t))})}function gr({name:t,prefix:e,bitsPerChar:n,alphabet:r}){return fr({prefix:e,name:t,encode:t=>function(t,e,n){const r="="===e[e.length-1],o=(1<<n)-1;let i="",s=0,a=0;for(let u=0;u<t.length;++u)for(a=a<<8|t[u],s+=8;s>n;)s-=n,i+=e[o&a>>s];if(0!==s&&(i+=e[o&a<<n-s]),r)for(;0!==(i.length*n&7);)i+="=";return i}(t,r,n),decode:e=>function(t,e,n,r){const o={};for(let l=0;l<e.length;++l)o[e[l]]=l;let i=t.length;for(;"="===t[i-1];)--i;const s=new Uint8Array(i*n/8|0);let a=0,u=0,c=0;for(let l=0;l<i;++l){const e=o[t[l]];if(void 0===e)throw new SyntaxError(`Non-${r} character`);u=u<<n|e,a+=n,a>=8&&(a-=8,s[c++]=255&u>>a)}if(a>=n||0!==(255&u<<8-a))throw new SyntaxError("Unexpected end of data");return s}(e,r,n,t)})}gr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const pr=gr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});gr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function yr(t){return pr.encode(t).slice(1)}function wr(t){return pr.decode(`u${t}`)}const mr=gr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),br=(gr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),gr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),gr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),gr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),gr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),gr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),gr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),gr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),dr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}));dr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var vr=function t(e,n,r){n=n||[];var o=r=r||0;for(;e>=kr;)n[r++]=255&e|Er,e/=128;for(;e&Br;)n[r++]=255&e|Er,e>>>=7;return n[r]=0|e,t.bytes=r-o+1,n},Er=128,Br=-128,kr=Math.pow(2,31);var Ar=function t(e,n){var r,o=0,i=0,s=n=n||0,a=e.length;do{if(s>=a)throw t.bytes=0,new RangeError("Could not decode varint");r=e[s++],o+=i<28?(r&Sr)<<i:(r&Sr)*Math.pow(2,i),i+=7}while(r>=xr);return t.bytes=s-n,o},xr=128,Sr=127;var Ir=Math.pow(2,7),Nr=Math.pow(2,14),Cr=Math.pow(2,21),Ur=Math.pow(2,28),Tr=Math.pow(2,35),$r=Math.pow(2,42),Or=Math.pow(2,49),Lr=Math.pow(2,56),Rr=Math.pow(2,63);const Pr={encode:vr,decode:Ar,encodingLength:function(t){return t<Ir?1:t<Nr?2:t<Cr?3:t<Ur?4:t<Tr?5:t<$r?6:t<Or?7:t<Lr?8:t<Rr?9:10}};function Dr(t,e=0){return[Pr.decode(t,e),Pr.decode.bytes]}function jr(t,e,n=0){return Pr.encode(t,e,n),e}function _r(t){return Pr.encodingLength(t)}class Hr{code;size;digest;bytes;constructor(t,e,n,r){this.code=t,this.size=e,this.digest=n,this.bytes=r}}function Fr(t,e){const{bytes:n,version:r}=t;return 0===r?function(t,e,n){const{prefix:r}=n;if(r!==br.prefix)throw Error(`Cannot string encode V0 in ${n.name} encoding`);const o=e.get(r);if(null==o){const o=n.encode(t).slice(1);return e.set(r,o),o}return o}(n,Mr(t),e??br.encoder):function(t,e,n){const{prefix:r}=n,o=e.get(r);if(null==o){const o=n.encode(t);return e.set(r,o),o}return o}(n,Mr(t),e??mr.encoder)}const Vr=new WeakMap;function Mr(t){const e=Vr.get(t);if(null==e){const e=new Map;return Vr.set(t,e),e}return e}class zr{code;version;multihash;bytes;"/";constructor(t,e,n,r){this.code=e,this.version=t,this.multihash=n,this.bytes=r,this["/"]=r}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==Gr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==qr)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return zr.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,n=function(t,e){const n=e.byteLength,r=_r(t),o=r+_r(n),i=new Uint8Array(o+n);return jr(t,i,0),jr(n,i,r),i.set(e,o),new Hr(t,n,e,i)}(t,e);return zr.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return zr.equals(this,t)}static equals(t,e){const n=e;return null!=n&&t.code===n.code&&t.version===n.version&&function(t,e){if(t===e)return!0;{const n=e;return t.code===n.code&&t.size===n.size&&n.bytes instanceof Uint8Array&&function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.byteLength;n++)if(t[n]!==e[n])return!1;return!0}(t.bytes,n.bytes)}}(t.multihash,n.multihash)}toString(t){return Fr(this,t)}toJSON(){return{"/":Fr(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof zr)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:n,multihash:r,bytes:o}=e;return new zr(t,n,r,o??Wr(t,n,r.bytes))}if(!0===e[Jr]){const{version:t,multihash:n,code:r}=e,o=function(t){const e=or(t),[n,r]=Dr(e),[o,i]=Dr(e.subarray(r)),s=e.subarray(r+i);if(s.byteLength!==o)throw new Error("Incorrect length");return new Hr(n,o,s,e)}(n);return zr.create(t,r,o)}return null}static create(t,e,n){if("number"!==typeof e)throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==Gr)throw new Error(`Version 0 CID must use dag-pb (code: ${Gr}) block encoding`);return new zr(t,e,n,n.bytes);case 1:{const r=Wr(t,e,n.bytes);return new zr(t,e,n,r)}default:throw new Error("Invalid version")}}static createV0(t){return zr.create(0,Gr,t)}static createV1(t,e){return zr.create(1,t,e)}static decode(t){const[e,n]=zr.decodeFirst(t);if(0!==n.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=zr.inspectBytes(t),n=e.size-e.multihashSize,r=or(t.subarray(n,n+e.multihashSize));if(r.byteLength!==e.multihashSize)throw new Error("Incorrect length");const o=r.subarray(e.multihashSize-e.digestSize),i=new Hr(e.multihashCode,e.digestSize,o,r);return[0===e.version?zr.createV0(i):zr.createV1(e.codec,i),t.subarray(e.size)]}static inspectBytes(t){let e=0;const n=()=>{const[n,r]=Dr(t.subarray(e));return e+=r,n};let r=n(),o=Gr;if(18===r?(r=0,e=0):o=n(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const i=e,s=n(),a=n(),u=e+a;return{version:r,codec:o,multihashCode:s,digestSize:a,multihashSize:u-i,size:u}}static parse(t,e){const[n,r]=function(t,e){switch(t[0]){case"Q":{const n=e??br;return[br.prefix,n.decode(`${br.prefix}${t}`)]}case br.prefix:{const n=e??br;return[br.prefix,n.decode(t)]}case mr.prefix:{const n=e??mr;return[mr.prefix,n.decode(t)]}default:if(null==e)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}(t,e),o=zr.decode(r);if(0===o.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return Mr(o).set(n,t),o}}const Gr=112,qr=18;function Wr(t,e,n){const r=_r(t),o=r+_r(e),i=new Uint8Array(o+n.byteLength);return jr(t,i,0),jr(e,i,r),i.set(n,o),i}const Jr=Symbol.for("@ipld/js-cid/CID");function Zr(t){const e={signature:wr(t.signature)};return t.header&&(e.header=t.header),t.protected&&(e.protected=wr(t.protected)),e}function Kr(t){const e={signature:yr(t.signature)};return t.header&&(e.header=t.header),t.protected&&(e.protected=yr(t.protected)),e}function Yr(t){const e={payload:yr(t.payload),signatures:t.signatures.map(Kr)};try{return e.pld=Qr((n=t.payload,JSON.parse((new TextDecoder).decode(n)))),e}catch(r){try{return e.link=zr.decode(new Uint8Array(t.payload)),e}catch(r){throw new Error("Invalid payload, must be either JSON or CID")}}var n}function Qr(t){if("string"===typeof t){if(t.startsWith("ipfs://"))return zr.parse(t.slice(7))}else{if(Array.isArray(t))return t.map(Qr);if(function(t){return"object"===typeof t&&null!==t}(t)){const e={};for(const n in t)e[n]=Qr(t[n]);return e}}return t}function Xr(t){const e={};return t.encrypted_key&&(e.encrypted_key=wr(t.encrypted_key)),t.header&&(e.header=t.header),e}function to(t){const e={};return t.encrypted_key&&(e.encrypted_key=yr(t.encrypted_key)),t.header&&(e.header=t.header),e}const eo=["string","number","bigint","symbol"],no=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function ro(t){if(null===t)return"null";if(void 0===t)return"undefined";if(!0===t||!1===t)return"boolean";const e=typeof t;if(eo.includes(e))return e;if("function"===e)return"Function";if(Array.isArray(t))return"Array";if(function(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}(t))return"Buffer";const n=function(t){const e=Object.prototype.toString.call(t).slice(8,-1);if(no.includes(e))return e;return}(t);return n||"Object"}class oo{constructor(t,e,n){this.major=t,this.majorEncoded=t<<5,this.name=e,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}oo.uint=new oo(0,"uint",!0),oo.negint=new oo(1,"negint",!0),oo.bytes=new oo(2,"bytes",!0),oo.string=new oo(3,"string",!0),oo.array=new oo(4,"array",!1),oo.map=new oo(5,"map",!1),oo.tag=new oo(6,"tag",!1),oo.float=new oo(7,"float",!0),oo.false=new oo(7,"false",!0),oo.true=new oo(7,"true",!0),oo.null=new oo(7,"null",!0),oo.undefined=new oo(7,"undefined",!0),oo.break=new oo(7,"break",!0);class io{constructor(t,e,n){this.type=t,this.value=e,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const so=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&"function"===typeof globalThis.Buffer.isBuffer,ao=new TextDecoder,uo=new TextEncoder;function co(t){return so&&globalThis.Buffer.isBuffer(t)}function lo(t){return t instanceof Uint8Array?co(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}const ho=so?(t,e,n)=>n-e>64?globalThis.Buffer.from(t.subarray(e,n)).toString("utf8"):bo(t,e,n):(t,e,n)=>n-e>64?ao.decode(t.subarray(e,n)):bo(t,e,n),fo=so?t=>t.length>64?globalThis.Buffer.from(t):mo(t):t=>t.length>64?uo.encode(t):mo(t),go=t=>Uint8Array.from(t),po=so?(t,e,n)=>co(t)?new Uint8Array(t.subarray(e,n)):t.slice(e,n):(t,e,n)=>t.slice(e,n),yo=so?(t,e)=>(t=t.map((t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t))),lo(globalThis.Buffer.concat(t,e))):(t,e)=>{const n=new Uint8Array(e);let r=0;for(let o of t)r+o.length>n.length&&(o=o.subarray(0,n.length-r)),n.set(o,r),r+=o.length;return n},wo=so?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function mo(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):55296===(64512&o)&&r+1<t.length&&56320===(64512&t.charCodeAt(r+1))?(o=65536+((1023&o)<<10)+(1023&t.charCodeAt(++r)),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e}function bo(t,e,n){const r=[];for(;e<n;){const o=t[e];let i=null,s=o>239?4:o>223?3:o>191?2:1;if(e+s<=n){let n,r,a,u;switch(s){case 1:o<128&&(i=o);break;case 2:n=t[e+1],128===(192&n)&&(u=(31&o)<<6|63&n,u>127&&(i=u));break;case 3:n=t[e+1],r=t[e+2],128===(192&n)&&128===(192&r)&&(u=(15&o)<<12|(63&n)<<6|63&r,u>2047&&(u<55296||u>57343)&&(i=u));break;case 4:n=t[e+1],r=t[e+2],a=t[e+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(u=(15&o)<<18|(63&n)<<12|(63&r)<<6|63&a,u>65535&&u<1114112&&(i=u))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),e+=s}return function(t){const e=t.length;if(e<=vo)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=vo));return n}(r)}const vo=4096;class Eo{constructor(t=256){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),null!==this._initReuseChunk&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let e=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const n=e.length-(this.maxCursor-this.cursor)-1;e.set(t,n)}else{if(e){const t=e.length-(this.maxCursor-this.cursor)-1;t<e.length&&(this.chunks[this.chunks.length-1]=e.subarray(0,t),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(e=wo(this.chunkSize),this.chunks.push(e),this.maxCursor+=e.length,null===this._initReuseChunk&&(this._initReuseChunk=e),e.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let e;if(1===this.chunks.length){const n=this.chunks[0];t&&this.cursor>n.length/2?(e=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):e=po(n,0,this.cursor)}else e=yo(this.chunks,this.cursor);return t&&this.reset(),e}}const Bo="CBOR decode error:",ko="CBOR encode error:",Ao=[];function xo(t,e,n){if(t.length-e<n)throw new Error(`${Bo} not enough data for type`)}Ao[23]=1,Ao[24]=2,Ao[25]=3,Ao[26]=5,Ao[27]=9;const So=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Io(t,e,n){xo(t,e,1);const r=t[e];if(!0===n.strict&&r<So[0])throw new Error(`${Bo} integer encoded in more bytes than necessary (strict decode)`);return r}function No(t,e,n){xo(t,e,2);const r=t[e]<<8|t[e+1];if(!0===n.strict&&r<So[1])throw new Error(`${Bo} integer encoded in more bytes than necessary (strict decode)`);return r}function Co(t,e,n){xo(t,e,4);const r=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(!0===n.strict&&r<So[2])throw new Error(`${Bo} integer encoded in more bytes than necessary (strict decode)`);return r}function Uo(t,e,n){xo(t,e,8);const r=16777216*t[e]+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],o=16777216*t[e+4]+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],i=(BigInt(r)<<BigInt(32))+BigInt(o);if(!0===n.strict&&i<So[3])throw new Error(`${Bo} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(!0===n.allowBigInt)return i;throw new Error(`${Bo} integers outside of the safe integer range are not supported`)}function To(t,e){return $o(t,0,e.value)}function $o(t,e,n){if(n<So[0]){const r=Number(n);t.push([e|r])}else if(n<So[1]){const r=Number(n);t.push([24|e,r])}else if(n<So[2]){const r=Number(n);t.push([25|e,r>>>8,255&r])}else if(n<So[3]){const r=Number(n);t.push([26|e,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}else{const r=BigInt(n);if(!(r<So[4]))throw new Error(`${Bo} encountered BigInt larger than allowable range`);{const n=[27|e,0,0,0,0,0,0,0];let o=Number(r&BigInt(4294967295)),i=Number(r>>BigInt(32)&BigInt(4294967295));n[8]=255&o,o>>=8,n[7]=255&o,o>>=8,n[6]=255&o,o>>=8,n[5]=255&o,n[4]=255&i,i>>=8,n[3]=255&i,i>>=8,n[2]=255&i,i>>=8,n[1]=255&i,t.push(n)}}}To.encodedSize=function(t){return $o.encodedSize(t.value)},$o.encodedSize=function(t){return t<So[0]?1:t<So[1]?2:t<So[2]?3:t<So[3]?5:9},To.compareTokens=function(t,e){return t.value<e.value?-1:t.value>e.value?1:0};const Oo=BigInt(-1),Lo=BigInt(1);function Ro(t,e){const n=e.value,r="bigint"===typeof n?n*Oo-Lo:-1*n-1;$o(t,e.type.majorEncoded,r)}function Po(t,e,n,r){xo(t,e,n+r);const o=po(t,e+n,e+n+r);return new io(oo.bytes,o,n+r)}function Do(t,e,n,r){return Po(t,e,1,n)}function jo(t){return void 0===t.encodedBytes&&(t.encodedBytes=t.type===oo.string?fo(t.value):t.value),t.encodedBytes}function _o(t,e){const n=jo(e);$o(t,e.type.majorEncoded,n.length),t.push(n)}function Ho(t,e,n,r,o){const i=n+r;xo(t,e,i);const s=new io(oo.string,ho(t,e+n,e+i),i);return!0===o.retainStringBytes&&(s.byteValue=po(t,e+n,e+i)),s}function Fo(t,e,n,r){return Ho(t,e,1,n,r)}Ro.encodedSize=function(t){const e=t.value,n="bigint"===typeof e?e*Oo-Lo:-1*e-1;return n<So[0]?1:n<So[1]?2:n<So[2]?3:n<So[3]?5:9},Ro.compareTokens=function(t,e){return t.value<e.value?1:t.value>e.value?-1:0},_o.encodedSize=function(t){const e=jo(t);return $o.encodedSize(e.length)+e.length},_o.compareTokens=function(t,e){return n=jo(t),r=jo(e),n.length<r.length?-1:n.length>r.length?1:function(t,e){if(co(t)&&co(e))return t.compare(e);for(let n=0;n<t.length;n++)if(t[n]!==e[n])return t[n]<e[n]?-1:1;return 0}(n,r);var n,r};const Vo=_o;function Mo(t,e,n,r){return new io(oo.array,r,n)}function zo(t,e,n,r){return Mo(0,0,1,n)}function Go(t,e){$o(t,oo.array.majorEncoded,e.value)}function qo(t,e,n,r){return new io(oo.map,r,n)}function Wo(t,e,n,r){return qo(0,0,1,n)}function Jo(t,e){$o(t,oo.map.majorEncoded,e.value)}function Zo(t,e,n,r){return new io(oo.tag,n,1)}function Ko(t,e){$o(t,oo.tag.majorEncoded,e.value)}Go.compareTokens=To.compareTokens,Go.encodedSize=function(t){return $o.encodedSize(t.value)},Jo.compareTokens=To.compareTokens,Jo.encodedSize=function(t){return $o.encodedSize(t.value)},Ko.compareTokens=To.compareTokens,Ko.encodedSize=function(t){return $o.encodedSize(t.value)};function Yo(t,e,n){if(n){if(!1===n.allowNaN&&Number.isNaN(t))throw new Error(`${Bo} NaN values are not supported`);if(!1===n.allowInfinity&&(t===1/0||t===-1/0))throw new Error(`${Bo} Infinity values are not supported`)}return new io(oo.float,t,e)}function Qo(t,e,n){const r=e.value;if(!1===r)t.push([20|oo.float.majorEncoded]);else if(!0===r)t.push([21|oo.float.majorEncoded]);else if(null===r)t.push([22|oo.float.majorEncoded]);else if(void 0===r)t.push([23|oo.float.majorEncoded]);else{let e,i=!1;n&&!0===n.float64||(ni(r),e=ri(ei,1),r===e||Number.isNaN(r)?(ei[0]=249,t.push(ei.slice(0,3)),i=!0):(oi(r),e=ii(ei,1),r===e&&(ei[0]=250,t.push(ei.slice(0,5)),i=!0))),i||(o=r,ti.setFloat64(0,o,!1),e=si(ei,1),ei[0]=251,t.push(ei.slice(0,9)))}var o}Qo.encodedSize=function(t,e){const n=t.value;if(!1===n||!0===n||null===n||void 0===n)return 1;if(!e||!0!==e.float64){ni(n);let t=ri(ei,1);if(n===t||Number.isNaN(n))return 3;if(oi(n),t=ii(ei,1),n===t)return 5}return 9};const Xo=new ArrayBuffer(9),ti=new DataView(Xo,1),ei=new Uint8Array(Xo,0);function ni(t){if(t===1/0)ti.setUint16(0,31744,!1);else if(t===-1/0)ti.setUint16(0,64512,!1);else if(Number.isNaN(t))ti.setUint16(0,32256,!1);else{ti.setFloat32(0,t);const e=ti.getUint32(0),n=(2139095040&e)>>23,r=8388607&e;if(255===n)ti.setUint16(0,31744,!1);else if(0===n)ti.setUint16(0,(2147483648&t)>>16|r>>13,!1);else{const t=n-127;t<-24?ti.setUint16(0,0):t<-14?ti.setUint16(0,(2147483648&e)>>16|1<<24+t,!1):ti.setUint16(0,(2147483648&e)>>16|t+15<<10|r>>13,!1)}}}function ri(t,e){if(t.length-e<2)throw new Error(`${Bo} not enough data for float16`);const n=(t[e]<<8)+t[e+1];if(31744===n)return 1/0;if(64512===n)return-1/0;if(32256===n)return NaN;const r=n>>10&31,o=1023&n;let i;return i=0===r?o*2**-24:31!==r?(o+1024)*2**(r-25):0===o?1/0:NaN,32768&n?-i:i}function oi(t){ti.setFloat32(0,t,!1)}function ii(t,e){if(t.length-e<4)throw new Error(`${Bo} not enough data for float32`);const n=(t.byteOffset||0)+e;return new DataView(t.buffer,n,4).getFloat32(0,!1)}function si(t,e){if(t.length-e<8)throw new Error(`${Bo} not enough data for float64`);const n=(t.byteOffset||0)+e;return new DataView(t.buffer,n,8).getFloat64(0,!1)}function ai(t,e,n){throw new Error(`${Bo} encountered invalid minor (${n}) for major ${t[e]>>>5}`)}function ui(t){return()=>{throw new Error(`${Bo} ${t}`)}}Qo.compareTokens=To.compareTokens;const ci=[];for(let Qp=0;Qp<=23;Qp++)ci[Qp]=ai;ci[24]=function(t,e,n,r){return new io(oo.uint,Io(t,e+1,r),2)},ci[25]=function(t,e,n,r){return new io(oo.uint,No(t,e+1,r),3)},ci[26]=function(t,e,n,r){return new io(oo.uint,Co(t,e+1,r),5)},ci[27]=function(t,e,n,r){return new io(oo.uint,Uo(t,e+1,r),9)},ci[28]=ai,ci[29]=ai,ci[30]=ai,ci[31]=ai;for(let Qp=32;Qp<=55;Qp++)ci[Qp]=ai;ci[56]=function(t,e,n,r){return new io(oo.negint,-1-Io(t,e+1,r),2)},ci[57]=function(t,e,n,r){return new io(oo.negint,-1-No(t,e+1,r),3)},ci[58]=function(t,e,n,r){return new io(oo.negint,-1-Co(t,e+1,r),5)},ci[59]=function(t,e,n,r){const o=Uo(t,e+1,r);if("bigint"!==typeof o){const t=-1-o;if(t>=Number.MIN_SAFE_INTEGER)return new io(oo.negint,t,9)}if(!0!==r.allowBigInt)throw new Error(`${Bo} integers outside of the safe integer range are not supported`);return new io(oo.negint,Oo-BigInt(o),9)},ci[60]=ai,ci[61]=ai,ci[62]=ai,ci[63]=ai;for(let Qp=64;Qp<=87;Qp++)ci[Qp]=Do;ci[88]=function(t,e,n,r){return Po(t,e,2,Io(t,e+1,r))},ci[89]=function(t,e,n,r){return Po(t,e,3,No(t,e+1,r))},ci[90]=function(t,e,n,r){return Po(t,e,5,Co(t,e+1,r))},ci[91]=function(t,e,n,r){const o=Uo(t,e+1,r);if("bigint"===typeof o)throw new Error(`${Bo} 64-bit integer bytes lengths not supported`);return Po(t,e,9,o)},ci[92]=ai,ci[93]=ai,ci[94]=ai,ci[95]=ui("indefinite length bytes/strings are not supported");for(let Qp=96;Qp<=119;Qp++)ci[Qp]=Fo;ci[120]=function(t,e,n,r){return Ho(t,e,2,Io(t,e+1,r),r)},ci[121]=function(t,e,n,r){return Ho(t,e,3,No(t,e+1,r),r)},ci[122]=function(t,e,n,r){return Ho(t,e,5,Co(t,e+1,r),r)},ci[123]=function(t,e,n,r){const o=Uo(t,e+1,r);if("bigint"===typeof o)throw new Error(`${Bo} 64-bit integer string lengths not supported`);return Ho(t,e,9,o,r)},ci[124]=ai,ci[125]=ai,ci[126]=ai,ci[127]=ui("indefinite length bytes/strings are not supported");for(let Qp=128;Qp<=151;Qp++)ci[Qp]=zo;ci[152]=function(t,e,n,r){return Mo(0,0,2,Io(t,e+1,r))},ci[153]=function(t,e,n,r){return Mo(0,0,3,No(t,e+1,r))},ci[154]=function(t,e,n,r){return Mo(0,0,5,Co(t,e+1,r))},ci[155]=function(t,e,n,r){const o=Uo(t,e+1,r);if("bigint"===typeof o)throw new Error(`${Bo} 64-bit integer array lengths not supported`);return Mo(0,0,9,o)},ci[156]=ai,ci[157]=ai,ci[158]=ai,ci[159]=function(t,e,n,r){if(!1===r.allowIndefinite)throw new Error(`${Bo} indefinite length items not allowed`);return Mo(0,0,1,1/0)};for(let Qp=160;Qp<=183;Qp++)ci[Qp]=Wo;ci[184]=function(t,e,n,r){return qo(0,0,2,Io(t,e+1,r))},ci[185]=function(t,e,n,r){return qo(0,0,3,No(t,e+1,r))},ci[186]=function(t,e,n,r){return qo(0,0,5,Co(t,e+1,r))},ci[187]=function(t,e,n,r){const o=Uo(t,e+1,r);if("bigint"===typeof o)throw new Error(`${Bo} 64-bit integer map lengths not supported`);return qo(0,0,9,o)},ci[188]=ai,ci[189]=ai,ci[190]=ai,ci[191]=function(t,e,n,r){if(!1===r.allowIndefinite)throw new Error(`${Bo} indefinite length items not allowed`);return qo(0,0,1,1/0)};for(let Qp=192;Qp<=215;Qp++)ci[Qp]=Zo;ci[216]=function(t,e,n,r){return new io(oo.tag,Io(t,e+1,r),2)},ci[217]=function(t,e,n,r){return new io(oo.tag,No(t,e+1,r),3)},ci[218]=function(t,e,n,r){return new io(oo.tag,Co(t,e+1,r),5)},ci[219]=function(t,e,n,r){return new io(oo.tag,Uo(t,e+1,r),9)},ci[220]=ai,ci[221]=ai,ci[222]=ai,ci[223]=ai;for(let Qp=224;Qp<=243;Qp++)ci[Qp]=ui("simple values are not supported");ci[244]=ai,ci[245]=ai,ci[246]=ai,ci[247]=function(t,e,n,r){if(!1===r.allowUndefined)throw new Error(`${Bo} undefined values are not supported`);return!0===r.coerceUndefinedToNull?new io(oo.null,null,1):new io(oo.undefined,void 0,1)},ci[248]=ui("simple values are not supported"),ci[249]=function(t,e,n,r){return Yo(ri(t,e+1),3,r)},ci[250]=function(t,e,n,r){return Yo(ii(t,e+1),5,r)},ci[251]=function(t,e,n,r){return Yo(si(t,e+1),9,r)},ci[252]=ai,ci[253]=ai,ci[254]=ai,ci[255]=function(t,e,n,r){if(!1===r.allowIndefinite)throw new Error(`${Bo} indefinite length items not allowed`);return new io(oo.break,void 0,1)};const li=[];for(let Qp=0;Qp<24;Qp++)li[Qp]=new io(oo.uint,Qp,1);for(let Qp=-1;Qp>=-24;Qp--)li[31-Qp]=new io(oo.negint,Qp,1);li[64]=new io(oo.bytes,new Uint8Array(0),1),li[96]=new io(oo.string,"",1),li[128]=new io(oo.array,0,1),li[160]=new io(oo.map,0,1),li[244]=new io(oo.false,!1,1),li[245]=new io(oo.true,!0,1),li[246]=new io(oo.null,null,1);const hi={float64:!1,mapSorter:function(t,e){const n=Array.isArray(t[0])?t[0][0]:t[0],r=Array.isArray(e[0])?e[0][0]:e[0];if(n.type!==r.type)return n.type.compare(r.type);const o=n.type.major,i=fi[o].compareTokens(n,r);0===i&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone");return i},quickEncodeToken:function(t){switch(t.type){case oo.false:return go([244]);case oo.true:return go([245]);case oo.null:return go([246]);case oo.bytes:return t.value.length?void 0:go([64]);case oo.string:return""===t.value?go([96]):void 0;case oo.array:return 0===t.value?go([128]):void 0;case oo.map:return 0===t.value?go([160]):void 0;case oo.uint:return t.value<24?go([Number(t.value)]):void 0;case oo.negint:if(t.value>=-24)return go([31-Number(t.value)])}}};const fi=function(){const t=[];return t[oo.uint.major]=To,t[oo.negint.major]=Ro,t[oo.bytes.major]=_o,t[oo.string.major]=Vo,t[oo.array.major]=Go,t[oo.map.major]=Jo,t[oo.tag.major]=Ko,t[oo.float.major]=Qo,t}(),di=new Eo;class gi{constructor(t,e){this.obj=t,this.parent=e}includes(t){let e=this;do{if(e.obj===t)return!0}while(e=e.parent);return!1}static createCheck(t,e){if(t&&t.includes(e))throw new Error(`${ko} object contains circular references`);return new gi(e,t)}}const pi={null:new io(oo.null,null),undefined:new io(oo.undefined,void 0),true:new io(oo.true,!0),false:new io(oo.false,!1),emptyArray:new io(oo.array,0),emptyMap:new io(oo.map,0)},yi={number:(t,e,n,r)=>Number.isInteger(t)&&Number.isSafeInteger(t)?new io(t>=0?oo.uint:oo.negint,t):new io(oo.float,t),bigint:(t,e,n,r)=>t>=BigInt(0)?new io(oo.uint,t):new io(oo.negint,t),Uint8Array:(t,e,n,r)=>new io(oo.bytes,t),string:(t,e,n,r)=>new io(oo.string,t),boolean:(t,e,n,r)=>t?pi.true:pi.false,null:(t,e,n,r)=>pi.null,undefined:(t,e,n,r)=>pi.undefined,ArrayBuffer:(t,e,n,r)=>new io(oo.bytes,new Uint8Array(t)),DataView:(t,e,n,r)=>new io(oo.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),Array(t,e,n,r){if(!t.length)return!0===n.addBreakTokens?[pi.emptyArray,new io(oo.break)]:pi.emptyArray;r=gi.createCheck(r,t);const o=[];let i=0;for(const s of t)o[i++]=wi(s,n,r);return n.addBreakTokens?[new io(oo.array,t.length),o,new io(oo.break)]:[new io(oo.array,t.length),o]},Object(t,e,n,r){const o="Object"!==e,i=o?t.keys():Object.keys(t),s=o?t.size:i.length;if(!s)return!0===n.addBreakTokens?[pi.emptyMap,new io(oo.break)]:pi.emptyMap;r=gi.createCheck(r,t);const a=[];let u=0;for(const c of i)a[u++]=[wi(c,n,r),wi(o?t.get(c):t[c],n,r)];return function(t,e){e.mapSorter&&t.sort(e.mapSorter)}(a,n),n.addBreakTokens?[new io(oo.map,s),a,new io(oo.break)]:[new io(oo.map,s),a]}};yi.Map=yi.Object,yi.Buffer=yi.Uint8Array;for(const Qp of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))yi[`${Qp}Array`]=yi.DataView;function wi(t,e={},n){const r=ro(t),o=e&&e.typeEncoders&&e.typeEncoders[r]||yi[r];if("function"===typeof o){const i=o(t,r,e,n);if(null!=i)return i}const i=yi[r];if(!i)throw new Error(`${ko} unsupported type: ${r}`);return i(t,r,e,n)}function mi(t,e,n,r){if(Array.isArray(e))for(const o of e)mi(t,o,n,r);else n[e.type.major](t,e,r)}function bi(t,e,n){const r=wi(t,n);if(!Array.isArray(r)&&n.quickEncodeToken){const t=n.quickEncodeToken(r);if(t)return t;const o=e[r.type.major];if(o.encodedSize){const t=o.encodedSize(r,n),e=new Eo(t);if(o(e,r,n),1!==e.chunks.length)throw new Error(`Unexpected error: pre-calculated length for ${r} was wrong`);return lo(e.chunks[0])}}return di.reset(),mi(di,r,e,n),di.toBytes(!0)}const vi={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Ei{constructor(t,e={}){this._pos=0,this.data=t,this.options=e}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let e=li[t];if(void 0===e){const n=ci[t];if(!n)throw new Error(`${Bo} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const r=31&t;e=n(this.data,this._pos,r,this.options)}return this._pos+=e.encodedLength,e}}const Bi=Symbol.for("DONE"),ki=Symbol.for("BREAK");function Ai(t,e){if(t.done())return Bi;const n=t.next();if(n.type===oo.break)return ki;if(n.type.terminal)return n.value;if(n.type===oo.array)return function(t,e,n){const r=[];for(let o=0;o<t.value;o++){const i=Ai(e,n);if(i===ki){if(t.value===1/0)break;throw new Error(`${Bo} got unexpected break to lengthed array`)}if(i===Bi)throw new Error(`${Bo} found array but not enough entries (got ${o}, expected ${t.value})`);r[o]=i}return r}(n,t,e);if(n.type===oo.map)return function(t,e,n){const r=!0===n.useMaps,o=r?void 0:{},i=r?new Map:void 0;for(let s=0;s<t.value;s++){const a=Ai(e,n);if(a===ki){if(t.value===1/0)break;throw new Error(`${Bo} got unexpected break to lengthed map`)}if(a===Bi)throw new Error(`${Bo} found map but not enough entries (got ${s} [no key], expected ${t.value})`);if(!0!==r&&"string"!==typeof a)throw new Error(`${Bo} non-string keys not supported (got ${typeof a})`);if(!0===n.rejectDuplicateMapKeys&&(r&&i.has(a)||!r&&a in o))throw new Error(`${Bo} found repeat map key "${a}"`);const u=Ai(e,n);if(u===Bi)throw new Error(`${Bo} found map but not enough entries (got ${s} [no value], expected ${t.value})`);r?i.set(a,u):o[a]=u}return r?i:o}(n,t,e);if(n.type===oo.tag){if(e.tags&&"function"===typeof e.tags[n.value]){const r=Ai(t,e);return e.tags[n.value](r)}throw new Error(`${Bo} tag not supported (${n.value})`)}throw new Error("unsupported")}function xi(t,e){const[n,r]=function(t,e){if(!(t instanceof Uint8Array))throw new Error(`${Bo} data to decode must be a Uint8Array`);const n=(e=Object.assign({},vi,e)).tokenizer||new Ei(t,e),r=Ai(n,e);if(r===Bi)throw new Error(`${Bo} did not find any content to decode`);if(r===ki)throw new Error(`${Bo} got unexpected break`);return[r,t.subarray(n.pos())]}(t,e);if(r.length>0)throw new Error(`${Bo} too many terminals, data makes no sense`);return n}const Si={float64:!0,typeEncoders:{Object:function(t){if(t.asCID!==t&&t["/"]!==t.bytes)return null;const e=zr.asCID(t);if(!e)return null;const n=new Uint8Array(e.bytes.byteLength+1);return n.set(e.bytes,1),[new io(oo.tag,42),new io(oo.bytes,n)]},undefined:function(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")},number:function(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}}};const Ii={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Ii.tags[42]=function(t){if(0!==t[0])throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return zr.decode(t.subarray(1))};Ii.tags.slice();const Ni=t=>{return e=t,n=Si,n=Object.assign({},hi,n),bi(e,fi,n);var e,n},Ci=t=>xi(function(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}(t),Ii),Ui="dag-jose",Ti=133;function $i(t){return"payload"in t&&"string"===typeof t.payload&&"signatures"in t&&Array.isArray(t.signatures)}function Oi(t){return"ciphertext"in t&&"string"===typeof t.ciphertext&&"iv"in t&&"string"===typeof t.iv&&"protected"in t&&"string"===typeof t.protected&&"tag"in t&&"string"===typeof t.tag}function Li(t){if("string"===typeof t){const e=t.split(".");if(3===e.length)return function(t){const[e,n,r]=t;return{payload:n,signatures:[{protected:e,signature:r}],link:zr.decode(wr(n))}}(e);if(5===e.length)return function(t){const[e,n,r,o,i]=t,s={ciphertext:o,iv:r,protected:e,tag:i};return n&&(s.recipients=[{encrypted_key:n}]),s}(e);throw new Error("Not a valid JOSE string")}if($i(t)||Oi(t))return t;throw new Error("Not a valid unencoded JOSE object")}function Ri(t){let e;if("string"===typeof t&&(t=Li(t)),$i(t))e={payload:wr((n=t).payload),signatures:n.signatures.map(Zr)};else{if(!Oi(t))throw new Error("Not a valid JOSE object");e=function(t){const e={ciphertext:wr(t.ciphertext),protected:wr(t.protected),iv:wr(t.iv),tag:wr(t.tag)};return t.aad&&(e.aad=wr(t.aad)),t.recipients&&(e.recipients=t.recipients.map(Xr)),t.unprotected&&(e.unprotected=t.unprotected),e}(t)}var n;return new Uint8Array(Ni(e))}function Pi(t){let e;try{e=Ci(t)}catch(r){throw new Error("Not a valid DAG-JOSE object")}if("payload"in(n=e)&&n.payload instanceof Uint8Array&&"signatures"in n&&Array.isArray(n.signatures))return Yr(e);if(function(t){return"ciphertext"in t&&t.ciphertext instanceof Uint8Array&&"iv"in t&&t.iv instanceof Uint8Array&&"protected"in t&&t.protected instanceof Uint8Array&&"tag"in t&&t.tag instanceof Uint8Array}(e))return function(t){const e={ciphertext:yr(t.ciphertext),protected:yr(t.protected),iv:yr(t.iv),tag:yr(t.tag)};return t.aad&&(e.aad=yr(t.aad)),t.recipients&&(e.recipients=t.recipients.map(to)),t.unprotected&&(e.unprotected=t.unprotected),e}(e);throw new Error("Not a valid DAG-JOSE object");var n}var Di=n(1046),ji=n(2970);function _i(t){const e=new globalThis.AbortController;function n(){e.abort();for(const e of t)null!=e?.removeEventListener&&e.removeEventListener("abort",n)}for(const o of t){if(!0===o?.aborted){n();break}null!=o?.addEventListener&&o.addEventListener("abort",n)}const r=e.signal;return r.clear=function(){for(const e of t)null!=e?.removeEventListener&&e.removeEventListener("abort",n)},r}var Hi=n(4053),Fi=n.n(Hi);const Vi="object"===typeof window&&"object"===typeof document&&9===document.nodeType,Mi=Fi()(),zi=Vi&&!Mi,Gi=Mi&&Vi,qi="undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.release&&"node"===globalThis.process.release.name&&!Mi,Wi="function"===typeof importScripts&&"undefined"!==typeof self&&"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;"undefined"!==typeof globalThis.process&&"undefined"!==typeof globalThis.process.env&&globalThis.process.env.NODE_ENV,"undefined"!==typeof navigator&&navigator.product;function Ji(t){try{let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const n=t.getReader();try{for(;;){const t=await n.read();if(t.done)return;yield t.value}}finally{!0!==e.preventCancel&&await n.cancel(),n.releaseLock()}}()}catch(e){return Promise.reject(e)}}var Zi=n(4823),Ki=n.n(Zi);const Yi=function(t){const[e,n]=null!=t[Symbol.asyncIterator]?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],r=[];return{peek:()=>e.next(),push:t=>{r.push(t)},next:()=>r.length>0?{done:!1,value:r.shift()}:e.next(),[n](){return this}}};const Qi=function(t,e){let n=0;if(null!=t[Symbol.asyncIterator])return async function*(){for await(const r of t)yield e(r,n++)}();const r=Yi(t),{value:o,done:i}=r.next();if(!0===i)return function*(){}();const s=e(o,n++);if("function"===typeof s.then)return async function*(){yield await s;for await(const t of r)yield e(t,n++)}();const a=e;return function*(){yield s;for(const t of r)yield a(t,n++)}()};Error;Error;class Xi extends Error{response;constructor(t){super(t.statusText),this.name="HTTPError",this.response=t}}class ts extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid mtime"),this.name="InvalidMtimeError"}}function es(t){return ArrayBuffer.isView(t)||t instanceof ArrayBuffer}function ns(t){return null!=t.constructor&&("Blob"===t.constructor.name||"File"===t.constructor.name)&&"function"===typeof t.stream}function rs(t){return"object"===typeof t&&(null!=t.path||null!=t.content)}function os(t){return"function"===typeof t?.getReader}function is(t){if(null!=t)return"string"===typeof t&&(t=parseInt(t,8)),4095&t}function ss(t){if(null!=t){var e;if(e=t,Object.prototype.hasOwnProperty.call(e,"secs")&&(t={secs:t.secs,nsecs:t.nsecs}),function(t){return Object.prototype.hasOwnProperty.call(t,"Seconds")}(t)&&(t={secs:BigInt(t.Seconds),nsecs:t.FractionalNanoseconds}),function(t){return Array.isArray(t)}(t)&&(t={secs:BigInt(t[0]),nsecs:t[1]}),t instanceof Date){const e=t.getTime(),n=Math.floor(e/1e3);t={secs:BigInt(n),nsecs:1e3*(e-1e3*n)}}if("bigint"===typeof t){const e=t/BigInt(1e9),n=t-e*BigInt(1e9);t={secs:e,nsecs:Number(n)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(null!=t.nsecs&&(t.nsecs<0||t.nsecs>999999999))throw new ts("mtime-nsecs must be within the range [0,999999999]");return t}}}async function as(t,e){const{path:n,mode:r,mtime:o,content:i}=t,s={path:n??"",mode:is(r),mtime:ss(o)};return null!=i?s.content=await e(i):null==n&&(s.content=await e(t)),s}Error;Error;Error;class us extends Error{static name="InvalidParametersError";constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid parameters"),this.name="InvalidParametersError"}}Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;const cs=function(t){if(null!=t[Symbol.asyncIterator])return(async()=>{const e=[];for await(const n of t)e.push(n);return e})();const e=[];for(const n of t)e.push(n);return e};async function ls(t){if(es(t))return new Blob([t]);if("string"===typeof t||t instanceof String)return new Blob([t.toString()]);if(ns(t))return t;if(os(t)&&(t=Ji(t)),Symbol.iterator in t||Symbol.asyncIterator in t){const e=Yi(t),{value:n,done:r}=await e.peek();if(!0===r)return hs(e);if(e.push(n),Number.isInteger(n))return new Blob([Uint8Array.from(await cs(e))]);if(es(n)||"string"===typeof n||n instanceof String)return hs(e)}throw new us(`Unexpected input: ${t}`)}async function hs(t){const e=[];for await(const n of t)e.push(n);return new Blob(e)}function fs(t){return async function*(t,e){if("string"===typeof t||t instanceof String||es(t)||ns(t)||null!=t._readableState)throw Ki()(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(os(t)&&(t=Ji(t)),Symbol.iterator in t||Symbol.asyncIterator in t){const n=Yi(t),{value:r,done:o}=await n.peek();if(!0===o)return void(yield*[]);if(n.push(r),Number.isInteger(r))throw Ki()(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(null!=r._readableState)return void(yield*Qi(n,(async t=>as({content:t},e))));if(es(r))return void(yield as({content:n},e));if(rs(r)||r[Symbol.iterator]||r[Symbol.asyncIterator]||os(r)||ns(r))return void(yield*Qi(n,(async t=>as(t,e))))}if(rs(t))throw Ki()(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");throw Ki()(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}(t,ls)}function ds(t){if(null!=t)return"string"===typeof t?t:t.toString(8).padStart(4,"0")}async function gs(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=[],o=new FormData;let i=0,s=0;for await(const{content:a,path:u,mode:c,mtime:l}of fs(t)){let t="";i>0&&(t=`-${i}`);let e=(null!=a?"file":"dir")+t;const n=[];if(null!==c&&void 0!==c&&n.push(`mode=${ds(c)}`),null!=l){const{secs:t,nsecs:e}=l;n.push(`mtime=${t}`),null!=e&&n.push(`mtime-nsecs=${e}`)}if(n.length>0&&(e=`${e}?${n.join("&")}`),null!=a){o.set(e,a,null!=u?encodeURIComponent(u):void 0);const t=s+a.size;r.push({name:u,start:s,end:t}),s=t}else{if(null==u)throw new Error("path or content or both must be set");o.set(e,new File([""],encodeURIComponent(u),{type:"application/x-directory"}))}i++}return{total:s,parts:r,headers:n,body:o}}async function ps(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:`-----------------------------${function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&n[t]];return e}()}`,o=gs;return Gi&&(o=gs),o(t,e,n,r)}function ys(t){if(null==t)return t;const e=/^[A-Z]+$/;return Object.keys(t).reduce(((n,r)=>(e.test(r)?n[r.toLowerCase()]=t[r]:e.test(r[0])?n[r[0].toLowerCase()+r.slice(1)]=t[r]:n[r]=t[r],n)),{})}function ws(){let{arg:t,searchParams:e,hashAlg:n,mtime:r,mode:o,...i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null!=e&&(i={...i,...e}),null!=n&&(i.hash=n),null!=r&&(r=ss(r),i.mtime=r.secs,i.mtimeNsecs=r.nsecs),null!=o&&(i.mode=ds(o)),isNaN(i.timeout)||(i.timeout=`${i.timeout}ms`),void 0===t||null===t?t=[]:Array.isArray(t)||(t=[t]);const s=new URLSearchParams(i);return t.forEach((t=>{s.append("arg",t)})),s}function ms(t){return function(e){try{let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=new AbortController,o=_i([r.signal,n.signal]);try{const{headers:i,body:s,total:a,parts:u}=await ps(e,r,n.headers),[c,l]="function"===typeof n.progress?bs(a,n.progress,u):[void 0,void 0],h=await t.post("add",{searchParams:ws({"stream-channels":!0,...n,progress:Boolean(c)}),onUploadProgress:l,signal:o,headers:i,body:s});for await(let t of h.ndjson())t=ys(t),void 0!==t.hash?yield Es(t):null!=c&&c(t.bytes??0,t.name)}finally{o.clear()}}()}catch(n){return Promise.reject(n)}}}const bs=(t,e,n)=>null!=n?[void 0,vs(t,n,e)]:[e,void 0],vs=(t,e,n)=>{let r=0;const o=e.length;return i=>{let{loaded:s,total:a}=i;const u=Math.floor(s/a*t);for(;r<o;){const{start:t,end:o,name:i}=e[r];if(u<o){n(u-t,i);break}n(o-t,i),r+=1}}};function Es(t){let{name:e,hash:n,size:r,mode:o,mtime:i,mtimeNsecs:s}=t;const a={path:e,cid:Ot.TO.parse(n),size:parseInt(r)};return null!=o&&(a.mode=parseInt(o,8)),null!=i&&(a.mtime={secs:i,nsecs:s??0}),a}const Bs=function(t){if(null!=t[Symbol.asyncIterator])return(async()=>{let e;for await(const n of t)e=n;return e})();let e;for(const n of t)e=n;return e};async function ks(t,e){const{path:n,mode:r,mtime:o,content:i}=t,s={path:n??"",mode:is(r),mtime:ss(o)};return null!=i?s.content=await e(i):null==n&&(s.content=await e(t)),s}function As(t){return async function*(t,e){if(null===t||void 0===t)throw Ki()(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT");if("string"===typeof t||t instanceof String)yield ks(t.toString(),e);else if(es(t)||ns(t))yield ks(t,e);else{if(os(t)&&(t=Ji(t)),Symbol.iterator in t||Symbol.asyncIterator in t){const n=Yi(t),{value:r,done:o}=await n.peek();if(!0===o)return void(yield{content:[]});if(n.push(r),Number.isInteger(r)||es(r)||"string"===typeof r||r instanceof String)return void(yield ks(n,e));throw Ki()(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(!rs(t))throw Ki()(new Error('Unexpected input: cannot convert "'+typeof t+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT");yield ks(t,e)}}(t,ls)}Error;Error;Error;class xs extends Error{static name="InvalidParametersError";constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid parameters"),this.name="InvalidParametersError"}}class Ss extends Error{static name="InvalidPublicKeyError";constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid public key"),this.name="InvalidPublicKeyError"}}Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;class Is extends Error{static name="UnsupportedKeyTypeError";constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unsupported key type"),this.name="UnsupportedKeyTypeError"}}var Ns=n(1454),Cs=n(5716);function Us(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.byteLength;n++)if(t[n]!==e[n])return!1;return!0}function Ts(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function $s(t){if(!((e=t)instanceof Uint8Array||null!=e&&"object"===typeof e&&"Uint8Array"===e.constructor.name))throw new Error("Uint8Array expected");for(var e,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(r.length>0&&!r.includes(t.length))throw new Error(`Uint8Array expected of length ${r}, not of length=${t.length}`)}function Os(t){if("function"!==typeof t||"function"!==typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");Ts(t.outputLen),Ts(t.blockLen)}function Ls(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Rs(t,e){$s(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Ps="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;const Ds=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),js=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];function _s(t){return"string"===typeof t&&(t=function(t){if("string"!==typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}(t)),$s(t),t}class Hs{clone(){return this._cloneInto()}}function Fs(t){const e=e=>t().update(_s(e)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Vs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(Ps&&"function"===typeof Ps.getRandomValues)return Ps.getRandomValues(new Uint8Array(t));if(Ps&&"function"===typeof Ps.randomBytes)return Ps.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const Ms=(t,e,n)=>t&e^t&n^e&n;class zs extends Hs{constructor(t,e,n,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ds(this.buffer)}update(t){Ls(this);const{view:e,buffer:n,blockLen:r}=this,o=(t=_s(t)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(t.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=Ds(t);for(;r<=o-i;i+=r)this.process(e,i)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ls(this),Rs(t,this),this.finished=!0;const{buffer:e,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;e[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let l=i;l<r;l++)e[l]=0;!function(t,e,n,r){if("function"===typeof t.setBigUint64)return t.setBigUint64(e,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),u=r?4:0,c=r?0:4;t.setUint32(e+u,s,r),t.setUint32(e+c,a,r)}(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=Ds(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=a/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)s.setUint32(4*l,c[l],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const n=t.slice(0,e);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return t.length=r,t.pos=s,t.finished=o,t.destroyed=i,r%e&&t.buffer.set(n),t}}const Gs=BigInt(2**32-1),qs=BigInt(32);function Ws(t){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(t&Gs),l:Number(t>>qs&Gs)}:{h:0|Number(t>>qs&Gs),l:0|Number(t&Gs)}}const Js={fromBig:Ws,split:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let o=0;o<t.length;o++){const{h:i,l:s}=Ws(t[o],e);[n[o],r[o]]=[i,s]}return[n,r]},toBig:(t,e)=>BigInt(t>>>0)<<qs|BigInt(e>>>0),shrSH:(t,e,n)=>t>>>n,shrSL:(t,e,n)=>t<<32-n|e>>>n,rotrSH:(t,e,n)=>t>>>n|e<<32-n,rotrSL:(t,e,n)=>t<<32-n|e>>>n,rotrBH:(t,e,n)=>t<<64-n|e>>>n-32,rotrBL:(t,e,n)=>t>>>n-32|e<<64-n,rotr32H:(t,e)=>e,rotr32L:(t,e)=>t,rotlSH:(t,e,n)=>t<<n|e>>>32-n,rotlSL:(t,e,n)=>e<<n|t>>>32-n,rotlBH:(t,e,n)=>e<<n-32|t>>>64-n,rotlBL:(t,e,n)=>t<<n-32|e>>>64-n,add:function(t,e,n,r){const o=(e>>>0)+(r>>>0);return{h:t+n+(o/2**32|0)|0,l:0|o}},add3L:(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),add3H:(t,e,n,r)=>e+n+r+(t/2**32|0)|0,add4L:(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),add4H:(t,e,n,r,o)=>e+n+r+o+(t/2**32|0)|0,add5H:(t,e,n,r,o,i)=>e+n+r+o+i+(t/2**32|0)|0,add5L:(t,e,n,r,o)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(o>>>0)},Zs=Js,[Ks,Ys]=(()=>Zs.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))))(),Qs=new Uint32Array(80),Xs=new Uint32Array(80);class ta extends zs{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:n,Bl:r,Ch:o,Cl:i,Dh:s,Dl:a,Eh:u,El:c,Fh:l,Fl:h,Gh:f,Gl:d,Hh:g,Hl:p}=this;return[t,e,n,r,o,i,s,a,u,c,l,h,f,d,g,p]}set(t,e,n,r,o,i,s,a,u,c,l,h,f,d,g,p){this.Ah=0|t,this.Al=0|e,this.Bh=0|n,this.Bl=0|r,this.Ch=0|o,this.Cl=0|i,this.Dh=0|s,this.Dl=0|a,this.Eh=0|u,this.El=0|c,this.Fh=0|l,this.Fl=0|h,this.Gh=0|f,this.Gl=0|d,this.Hh=0|g,this.Hl=0|p}process(t,e){for(let m=0;m<16;m++,e+=4)Qs[m]=t.getUint32(e),Xs[m]=t.getUint32(e+=4);for(let m=16;m<80;m++){const t=0|Qs[m-15],e=0|Xs[m-15],n=Zs.rotrSH(t,e,1)^Zs.rotrSH(t,e,8)^Zs.shrSH(t,e,7),r=Zs.rotrSL(t,e,1)^Zs.rotrSL(t,e,8)^Zs.shrSL(t,e,7),o=0|Qs[m-2],i=0|Xs[m-2],s=Zs.rotrSH(o,i,19)^Zs.rotrBH(o,i,61)^Zs.shrSH(o,i,6),a=Zs.rotrSL(o,i,19)^Zs.rotrBL(o,i,61)^Zs.shrSL(o,i,6),u=Zs.add4L(r,a,Xs[m-7],Xs[m-16]),c=Zs.add4H(u,n,s,Qs[m-7],Qs[m-16]);Qs[m]=0|c,Xs[m]=0|u}let{Ah:n,Al:r,Bh:o,Bl:i,Ch:s,Cl:a,Dh:u,Dl:c,Eh:l,El:h,Fh:f,Fl:d,Gh:g,Gl:p,Hh:y,Hl:w}=this;for(let m=0;m<80;m++){const t=Zs.rotrSH(l,h,14)^Zs.rotrSH(l,h,18)^Zs.rotrBH(l,h,41),e=Zs.rotrSL(l,h,14)^Zs.rotrSL(l,h,18)^Zs.rotrBL(l,h,41),b=l&f^~l&g,v=h&d^~h&p,E=Zs.add5L(w,e,v,Ys[m],Xs[m]),B=Zs.add5H(E,y,t,b,Ks[m],Qs[m]),k=0|E,A=Zs.rotrSH(n,r,28)^Zs.rotrBH(n,r,34)^Zs.rotrBH(n,r,39),x=Zs.rotrSL(n,r,28)^Zs.rotrBL(n,r,34)^Zs.rotrBL(n,r,39),S=n&o^n&s^o&s,I=r&i^r&a^i&a;y=0|g,w=0|p,g=0|f,p=0|d,f=0|l,d=0|h,({h:l,l:h}=Zs.add(0|u,0|c,0|B,0|k)),u=0|s,c=0|a,s=0|o,a=0|i,o=0|n,i=0|r;const N=Zs.add3L(k,x,I);n=Zs.add3H(N,B,A,S),r=0|N}({h:n,l:r}=Zs.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:o,l:i}=Zs.add(0|this.Bh,0|this.Bl,0|o,0|i)),({h:s,l:a}=Zs.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:u,l:c}=Zs.add(0|this.Dh,0|this.Dl,0|u,0|c)),({h:l,l:h}=Zs.add(0|this.Eh,0|this.El,0|l,0|h)),({h:f,l:d}=Zs.add(0|this.Fh,0|this.Fl,0|f,0|d)),({h:g,l:p}=Zs.add(0|this.Gh,0|this.Gl,0|g,0|p)),({h:y,l:w}=Zs.add(0|this.Hh,0|this.Hl,0|y,0|w)),this.set(n,r,o,i,s,a,u,c,l,h,f,d,g,p,y,w)}roundClean(){Qs.fill(0),Xs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const ea=Fs((()=>new ta)),na=BigInt(0),ra=BigInt(1),oa=BigInt(2);function ia(t){return t instanceof Uint8Array||null!=t&&"object"===typeof t&&"Uint8Array"===t.constructor.name}function sa(t){if(!ia(t))throw new Error("Uint8Array expected")}function aa(t,e){if("boolean"!==typeof e)throw new Error(`${t} must be valid boolean, got "${e}".`)}const ua=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function ca(t){sa(t);let e="";for(let n=0;n<t.length;n++)e+=ua[t[n]];return e}function la(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function ha(t){if("string"!==typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}const fa={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function da(t){return t>=fa._0&&t<=fa._9?t-fa._0:t>=fa._A&&t<=fa._F?t-(fa._A-10):t>=fa._a&&t<=fa._f?t-(fa._a-10):void 0}function ga(t){if("string"!==typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let o=0,i=0;o<n;o++,i+=2){const e=da(t.charCodeAt(i)),n=da(t.charCodeAt(i+1));if(void 0===e||void 0===n){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}r[o]=16*e+n}return r}function pa(t){return ha(ca(t))}function ya(t){return sa(t),ha(ca(Uint8Array.from(t).reverse()))}function wa(t,e){return ga(t.toString(16).padStart(2*e,"0"))}function ma(t,e){return wa(t,e).reverse()}function ba(t,e,n){let r;if("string"===typeof e)try{r=ga(e)}catch(i){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else{if(!ia(e))throw new Error(`${t} must be hex string or Uint8Array`);r=Uint8Array.from(e)}const o=r.length;if("number"===typeof n&&o!==n)throw new Error(`${t} expected ${n} bytes, got ${o}`);return r}function va(){let t=0;for(let n=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];sa(e),t+=e.length}const e=new Uint8Array(t);for(let n=0,r=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];e.set(t,r),r+=t.length}return e}const Ea=t=>"bigint"===typeof t&&na<=t;function Ba(t,e,n){return Ea(t)&&Ea(e)&&Ea(n)&&e<=t&&t<n}function ka(t,e,n,r){if(!Ba(e,n,r))throw new Error(`expected valid ${t}: ${n} <= n < ${r}, got ${typeof e} ${e}`)}function Aa(t){let e;for(e=0;t>na;t>>=ra,e+=1);return e}const xa=t=>(oa<<BigInt(t-1))-ra,Sa=t=>new Uint8Array(t),Ia=t=>Uint8Array.from(t);function Na(t,e,n){if("number"!==typeof t||t<2)throw new Error("hashLen must be a number");if("number"!==typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!==typeof n)throw new Error("hmacFn must be a function");let r=Sa(t),o=Sa(t),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return n(o,r,...e)},u=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sa();o=a(Ia([0]),t),r=a(),0!==t.length&&(o=a(Ia([1]),t),r=a())},c=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const n=[];for(;t<e;){r=a();const e=r.slice();n.push(e),t+=r.length}return va(...n)};return(t,e)=>{let n;for(s(),u(t);!(n=e(c()));)u();return s(),n}}const Ca={bigint:t=>"bigint"===typeof t,function:t=>"function"===typeof t,boolean:t=>"boolean"===typeof t,string:t=>"string"===typeof t,stringOrUint8Array:t=>"string"===typeof t||ia(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"===typeof t&&Number.isSafeInteger(t.outputLen)};function Ua(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=(e,n,r)=>{const o=Ca[n];if("function"!==typeof o)throw new Error(`Invalid validator "${n}", expected function`);const i=t[e];if((!r||void 0!==i)&&!o(i,t))throw new Error(`Invalid param ${String(e)}=${i} (${typeof i}), expected ${n}`)};for(const[o,i]of Object.entries(e))r(o,i,!1);for(const[o,i]of Object.entries(n))r(o,i,!0);return t}function Ta(t){const e=new WeakMap;return function(n){const r=e.get(n);if(void 0!==r)return r;for(var o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];const a=t(n,...i);return e.set(n,a),a}}const $a=BigInt(0),Oa=BigInt(1),La=BigInt(2),Ra=BigInt(3),Pa=BigInt(4),Da=BigInt(5),ja=BigInt(8);BigInt(9),BigInt(16);function _a(t,e){const n=t%e;return n>=$a?n:e+n}function Ha(t,e,n){if(n<=$a||e<$a)throw new Error("Expected power/modulo > 0");if(n===Oa)return $a;let r=Oa;for(;e>$a;)e&Oa&&(r=r*t%n),t=t*t%n,e>>=Oa;return r}function Fa(t,e,n){let r=t;for(;e-- >$a;)r*=r,r%=n;return r}function Va(t,e){if(t===$a||e<=$a)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let n=_a(t,e),r=e,o=$a,i=Oa,s=Oa,a=$a;for(;n!==$a;){const t=r/n,e=r%n,u=o-s*t,c=i-a*t;r=n,n=e,o=s,i=a,s=u,a=c}if(r!==Oa)throw new Error("invert: does not exist");return _a(o,e)}function Ma(t){if(t%Pa===Ra){const e=(t+Oa)/Pa;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}if(t%ja===Da){const e=(t-Da)/ja;return function(t,n){const r=t.mul(n,La),o=t.pow(r,e),i=t.mul(n,o),s=t.mul(t.mul(i,La),o),a=t.mul(i,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),n))throw new Error("Cannot find square root");return a}}return function(t){const e=(t-Oa)/La;let n,r,o;for(n=t-Oa,r=0;n%La===$a;n/=La,r++);for(o=La;o<t&&Ha(o,e,t)!==t-Oa;o++);if(1===r){const e=(t+Oa)/Pa;return function(t,n){const r=t.pow(n,e);if(!t.eql(t.sqr(r),n))throw new Error("Cannot find square root");return r}}const i=(n+Oa)/La;return function(t,s){if(t.pow(s,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let a=r,u=t.pow(t.mul(t.ONE,o),n),c=t.pow(s,i),l=t.pow(s,n);for(;!t.eql(l,t.ONE);){if(t.eql(l,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(l);e<a&&!t.eql(r,t.ONE);e++)r=t.sqr(r);const n=t.pow(u,Oa<<BigInt(a-e-1));u=t.sqr(n),c=t.mul(c,n),l=t.mul(l,u),a=e}return c}}(t)}const za=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ga(t,e){const n=void 0!==e?e:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function qa(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t<=$a)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:i}=Ga(t,e);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=Ma(t),a=Object.freeze({ORDER:t,BITS:o,BYTES:i,MASK:xa(o),ZERO:$a,ONE:Oa,create:e=>_a(e,t),isValid:e=>{if("bigint"!==typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return $a<=e&&e<t},is0:t=>t===$a,isOdd:t=>(t&Oa)===Oa,neg:e=>_a(-e,t),eql:(t,e)=>t===e,sqr:e=>_a(e*e,t),add:(e,n)=>_a(e+n,t),sub:(e,n)=>_a(e-n,t),mul:(e,n)=>_a(e*n,t),pow:(t,e)=>function(t,e,n){if(n<$a)throw new Error("Expected power > 0");if(n===$a)return t.ONE;if(n===Oa)return e;let r=t.ONE,o=e;for(;n>$a;)n&Oa&&(r=t.mul(r,o)),o=t.sqr(o),n>>=Oa;return r}(a,t,e),div:(e,n)=>_a(e*Va(n,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>Va(e,t),sqrt:r.sqrt||(t=>s(a,t)),invertBatch:t=>function(t,e){const n=new Array(e.length),r=e.reduce(((e,r,o)=>t.is0(r)?e:(n[o]=e,t.mul(e,r))),t.ONE),o=t.inv(r);return e.reduceRight(((e,r,o)=>t.is0(r)?e:(n[o]=t.mul(e,n[o]),t.mul(e,r))),o),n}(a,t),cmov:(t,e,n)=>n?e:t,toBytes:t=>n?ma(t,i):wa(t,i),fromBytes:t=>{if(t.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${t.length}`);return n?ya(t):pa(t)}});return Object.freeze(a)}function Wa(t){if("bigint"!==typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Ja(t){const e=Wa(t);return e+Math.ceil(e/2)}const Za=BigInt(0),Ka=BigInt(1),Ya=new WeakMap,Qa=new WeakMap;function Xa(t,e){const n=(t,e)=>{const n=e.negate();return t?n:e},r=t=>{if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error(`Wrong window size=${t}, should be [1..${e}]`)},o=t=>{r(t);return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1)}};return{constTimeNegate:n,unsafeLadder(e,n){let r=t.ZERO,o=e;for(;n>Za;)n&Ka&&(r=r.add(o)),o=o.double(),n>>=Ka;return r},precomputeWindow(t,e){const{windows:n,windowSize:r}=o(e),i=[];let s=t,a=s;for(let o=0;o<n;o++){a=s,i.push(a);for(let t=1;t<r;t++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(e,r,i){const{windows:s,windowSize:a}=o(e);let u=t.ZERO,c=t.BASE;const l=BigInt(2**e-1),h=2**e,f=BigInt(e);for(let t=0;t<s;t++){const e=t*a;let o=Number(i&l);i>>=f,o>a&&(o-=h,i+=Ka);const s=e,d=e+Math.abs(o)-1,g=t%2!==0,p=o<0;0===o?c=c.add(n(g,r[s])):u=u.add(n(p,r[d]))}return{p:u,f:c}},wNAFCached(t,e,n){const r=Qa.get(t)||1;let o=Ya.get(t);return o||(o=this.precomputeWindow(t,r),1!==r&&Ya.set(t,n(o))),this.wNAF(r,o,e)},setWindowSize(t,e){r(e),Qa.set(t,e),Ya.delete(t)}}}function tu(t,e,n,r){if(!Array.isArray(n)||!Array.isArray(r)||r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");r.forEach(((t,n)=>{if(!e.isValid(t))throw new Error(`wrong scalar at index ${n}`)})),n.forEach(((e,n)=>{if(!(e instanceof t))throw new Error(`wrong point at index ${n}`)}));const o=Aa(BigInt(n.length)),i=o>12?o-3:o>4?o-2:o?2:1,s=(1<<i)-1,a=new Array(s+1).fill(t.ZERO),u=Math.floor((e.BITS-1)/i)*i;let c=t.ZERO;for(let l=u;l>=0;l-=i){a.fill(t.ZERO);for(let t=0;t<r.length;t++){const e=r[t],o=Number(e>>BigInt(l)&BigInt(s));a[o]=a[o].add(n[t])}let e=t.ZERO;for(let n=a.length-1,r=t.ZERO;n>0;n--)r=r.add(a[n]),e=e.add(r);if(c=c.add(e),0!==l)for(let t=0;t<i;t++)c=c.double()}return c}function eu(t){return function(t){const e=za.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});Ua(t,e)}(t.Fp),Ua(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Ga(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const nu=BigInt(0),ru=BigInt(1),ou=BigInt(2),iu=BigInt(8),su={zip215:!0};function au(t){const e=function(t){const e=eu(t);return Ua(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:n,n:r,prehash:o,hash:i,randomBytes:s,nByteLength:a,h:u}=e,c=ou<<BigInt(8*a)-ru,l=n.create,h=qa(e.n,e.nBitLength),f=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:n.sqrt(t*n.inv(e))}}catch(r){return{isValid:!1,value:nu}}}),d=e.adjustScalarBytes||(t=>t),g=e.domain||((t,e,n)=>{if(aa("phflag",n),e.length||n)throw new Error("Contexts/pre-hash are not supported");return t});function p(t,e){ka("coordinate "+t,e,nu,c)}function y(t){if(!(t instanceof b))throw new Error("ExtendedPoint expected")}const w=Ta(((t,e)=>{const{ex:r,ey:o,ez:i}=t,s=t.is0();null==e&&(e=s?iu:n.inv(i));const a=l(r*e),u=l(o*e),c=l(i*e);if(s)return{x:nu,y:ru};if(c!==ru)throw new Error("invZ was invalid");return{x:a,y:u}})),m=Ta((t=>{const{a:n,d:r}=e;if(t.is0())throw new Error("bad point: ZERO");const{ex:o,ey:i,ez:s,et:a}=t,u=l(o*o),c=l(i*i),h=l(s*s),f=l(h*h),d=l(u*n);if(l(h*l(d+c))!==l(f+l(r*l(u*c))))throw new Error("bad point: equation left != right (1)");if(l(o*i)!==l(s*a))throw new Error("bad point: equation left != right (2)");return!0}));class b{constructor(t,e,n,r){this.ex=t,this.ey=e,this.ez=n,this.et=r,p("x",t),p("y",e),p("z",n),p("t",r),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof b)throw new Error("extended point not allowed");const{x:e,y:n}=t||{};return p("x",e),p("y",n),new b(e,n,ru,l(e*n))}static normalizeZ(t){const e=n.invertBatch(t.map((t=>t.ez)));return t.map(((t,n)=>t.toAffine(e[n]))).map(b.fromAffine)}static msm(t,e){return tu(b,h,t,e)}_setWindowSize(t){B.setWindowSize(this,t)}assertValidity(){m(this)}equals(t){y(t);const{ex:e,ey:n,ez:r}=this,{ex:o,ey:i,ez:s}=t,a=l(e*s),u=l(o*r),c=l(n*s),h=l(i*r);return a===u&&c===h}is0(){return this.equals(b.ZERO)}negate(){return new b(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:t}=e,{ex:n,ey:r,ez:o}=this,i=l(n*n),s=l(r*r),a=l(ou*l(o*o)),u=l(t*i),c=n+r,h=l(l(c*c)-i-s),f=u+s,d=f-a,g=u-s,p=l(h*d),y=l(f*g),w=l(h*g),m=l(d*f);return new b(p,y,m,w)}add(t){y(t);const{a:n,d:r}=e,{ex:o,ey:i,ez:s,et:a}=this,{ex:u,ey:c,ez:h,et:f}=t;if(n===BigInt(-1)){const t=l((i-o)*(c+u)),e=l((i+o)*(c-u)),n=l(e-t);if(n===nu)return this.double();const r=l(s*ou*f),d=l(a*ou*h),g=d+r,p=e+t,y=d-r,w=l(g*n),m=l(p*y),v=l(g*y),E=l(n*p);return new b(w,m,E,v)}const d=l(o*u),g=l(i*c),p=l(a*r*f),w=l(s*h),m=l((o+i)*(u+c)-d-g),v=w-p,E=w+p,B=l(g-n*d),k=l(m*v),A=l(E*B),x=l(m*B),S=l(v*E);return new b(k,A,S,x)}subtract(t){return this.add(t.negate())}wNAF(t){return B.wNAFCached(this,t,b.normalizeZ)}multiply(t){const e=t;ka("scalar",e,ru,r);const{p:n,f:o}=this.wNAF(e);return b.normalizeZ([n,o])[0]}multiplyUnsafe(t){const e=t;return ka("scalar",e,nu,r),e===nu?E:this.equals(E)||e===ru?this:this.equals(v)?this.wNAF(e).p:B.unsafeLadder(this,e)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}isTorsionFree(){return B.unsafeLadder(this,r).is0()}toAffine(t){return w(this,t)}clearCofactor(){const{h:t}=e;return t===ru?this:this.multiplyUnsafe(t)}static fromHex(t){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{d:o,a:i}=e,s=n.BYTES;t=ba("pointHex",t,s),aa("zip215",r);const a=t.slice(),u=t[s-1];a[s-1]=-129&u;const h=ya(a),d=r?c:n.ORDER;ka("pointHex.y",h,nu,d);const g=l(h*h),p=l(g-ru),y=l(o*g-i);let{isValid:w,value:m}=f(p,y);if(!w)throw new Error("Point.fromHex: invalid y coordinate");const v=(m&ru)===ru,E=0!==(128&u);if(!r&&m===nu&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==v&&(m=l(-m)),b.fromAffine({x:m,y:h})}static fromPrivateKey(t){return x(t).point}toRawBytes(){const{x:t,y:e}=this.toAffine(),r=ma(e,n.BYTES);return r[r.length-1]|=t&ru?128:0,r}toHex(){return ca(this.toRawBytes())}}b.BASE=new b(e.Gx,e.Gy,ru,l(e.Gx*e.Gy)),b.ZERO=new b(nu,ru,ru,nu);const{BASE:v,ZERO:E}=b,B=Xa(b,8*a);function k(t){return _a(t,r)}function A(t){return k(ya(t))}function x(t){const e=a;t=ba("private key",t,e);const n=ba("hashed private key",i(t),2*e),r=d(n.slice(0,e)),o=n.slice(e,2*e),s=A(r),u=v.multiply(s),c=u.toRawBytes();return{head:r,prefix:o,scalar:s,point:u,pointBytes:c}}function S(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array;for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];const s=va(...n);return A(i(g(s,ba("context",t),!!o)))}const I=su;v._setWindowSize(8);const N={getExtendedPublicKey:x,randomPrivateKey:()=>s(n.BYTES),precompute(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.BASE;return e._setWindowSize(t),e.multiply(BigInt(3)),e}};return{CURVE:e,getPublicKey:function(t){return x(t).pointBytes},sign:function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t=ba("message",t),o&&(t=o(t));const{prefix:s,scalar:u,pointBytes:c}=x(e),l=S(i.context,s,t),h=v.multiply(l).toRawBytes(),f=k(l+S(i.context,h,c,t)*u);return ka("signature.s",f,nu,r),ba("result",va(h,ma(f,n.BYTES)),2*a)},verify:function(t,e,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:I;const{context:s,zip215:a}=i,u=n.BYTES;t=ba("signature",t,2*u),e=ba("message",e),void 0!==a&&aa("zip215",a),o&&(e=o(e));const c=ya(t.slice(u,2*u));let l,h,f;try{l=b.fromHex(r,a),h=b.fromHex(t.slice(0,u),a),f=v.multiplyUnsafe(c)}catch(g){return!1}if(!a&&l.isSmallOrder())return!1;const d=S(s,h.toRawBytes(),l.toRawBytes(),e);return h.add(l.multiplyUnsafe(d)).subtract(f).clearCofactor().equals(b.ZERO)},ExtendedPoint:b,utils:N}}const uu=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),cu=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),lu=(BigInt(0),BigInt(1)),hu=BigInt(2),fu=(BigInt(3),BigInt(5)),du=BigInt(8);function gu(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),i=uu,s=t*t%i*t%i,a=Fa(s,hu,i)*s%i,u=Fa(a,lu,i)*t%i,c=Fa(u,fu,i)*u%i,l=Fa(c,e,i)*c%i,h=Fa(l,n,i)*l%i,f=Fa(h,r,i)*h%i,d=Fa(f,o,i)*f%i,g=Fa(d,o,i)*f%i,p=Fa(g,e,i)*c%i;return{pow_p_5_8:Fa(p,hu,i)*t%i,b2:s}}function pu(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function yu(t,e){const n=uu,r=_a(e*e*e,n),o=_a(r*r*e,n);let i=_a(t*r*gu(t*o).pow_p_5_8,n);const s=_a(e*i*i,n),a=i,u=_a(i*cu,n),c=s===t,l=s===_a(-t,n),h=s===_a(-t*cu,n);return c&&(i=a),(l||h)&&(i=u),((t,e)=>(_a(t,e)&Oa)===Oa)(i,n)&&(i=_a(-i,n)),{isValid:c||l,value:i}}const wu=(()=>qa(uu,void 0,!0))(),mu=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:wu,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:du,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:ea,randomBytes:Vs,adjustScalarBytes:pu,uvRatio:yu}))(),bu=(()=>au(mu))();class vu{type="Ed25519";raw;constructor(t){this.raw=Bu(t,32)}toMultihash(){return ji.identity.digest(uf(this))}toCID(){return Ot.TO.createV1(114,this.toMultihash())}toString(){return Ns.base58btc.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&Us(this.raw,t.raw)}verify(t,e){return function(t,e,n){return bu.verify(e,n instanceof Uint8Array?n:n.subarray(),t)}(this.raw,e,t)}}function Eu(t){return t=Bu(t,32),new vu(t)}function Bu(t,e){if((t=Uint8Array.from(t??[])).length!==e)throw new xs(`Key must be a Uint8Array of length ${e}, got ${t.length}`);return t}var ku=n(8990);const Au=new Float32Array([-0]),xu=new Uint8Array(Au.buffer);function Su(t,e,n){Au[0]=t,e[n]=xu[0],e[n+1]=xu[1],e[n+2]=xu[2],e[n+3]=xu[3]}const Iu=new Float64Array([-0]),Nu=new Uint8Array(Iu.buffer);function Cu(t,e,n){Iu[0]=t,e[n]=Nu[0],e[n+1]=Nu[1],e[n+2]=Nu[2],e[n+3]=Nu[3],e[n+4]=Nu[4],e[n+5]=Nu[5],e[n+6]=Nu[6],e[n+7]=Nu[7]}const Uu=BigInt(Number.MAX_SAFE_INTEGER),Tu=BigInt(Number.MIN_SAFE_INTEGER);class $u{lo;hi;constructor(t,e){this.lo=0|t,this.hi=0|e}toNumber(){if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&this.hi>>>31>0){const t=1+~this.lo>>>0;let e=~this.hi>>>0;return 0===t&&(e=e+1>>>0),-(t+4294967296*e)}return this.lo+4294967296*this.hi}toBigInt(){if(arguments.length>0&&void 0!==arguments[0]&&arguments[0])return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){const t=1+~this.lo>>>0;let e=~this.hi>>>0;return 0===t&&(e=e+1>>>0),-(BigInt(t)+(BigInt(e)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.toBigInt(t).toString()}zzEncode(){const t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){const t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){const t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}static fromBigInt(t){if(0n===t)return Ou;if(t<Uu&&t>Tu)return this.fromNumber(Number(t));const e=t<0n;e&&(t=-t);let n=t>>32n,r=t-(n<<32n);return e&&(n=0n|~n,r=0n|~r,++r>Lu&&(r=0n,++n>Lu&&(n=0n))),new $u(Number(r),Number(n))}static fromNumber(t){if(0===t)return Ou;const e=t<0;e&&(t=-t);let n=t>>>0,r=(t-n)/4294967296>>>0;return e&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new $u(n,r)}static from(t){return"number"===typeof t?$u.fromNumber(t):"bigint"===typeof t?$u.fromBigInt(t):"string"===typeof t?$u.fromBigInt(BigInt(t)):null!=t.low||null!=t.high?new $u(t.low>>>0,t.high>>>0):Ou}}const Ou=new $u(0,0);Ou.toBigInt=function(){return 0n},Ou.zzEncode=Ou.zzDecode=function(){return this},Ou.length=function(){return 1};const Lu=4294967296n;function Ru(t,e,n){const r=n;let o,i;for(let s=0;s<t.length;++s)o=t.charCodeAt(s),o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):55296===(64512&o)&&56320===(64512&(i=t.charCodeAt(s+1)))?(o=65536+((1023&o)<<10)+(1023&i),++s,e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128);return n-r}function Pu(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function Du(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}class ju{buf;pos;len;_slice=(()=>Uint8Array.prototype.subarray)();constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return t;if(t=(t|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Pu(this,10);return t}int32(){return 0|this.uint32()}sint32(){const t=this.uint32();return t>>>1^-(1&t)}bool(){return 0!==this.uint32()}fixed32(){if(this.pos+4>this.len)throw Pu(this,4);return Du(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Pu(this,4);return 0|Du(this.buf,this.pos+=4)}float(){if(this.pos+4>this.len)throw Pu(this,4);const t=function(t,e){return xu[0]=t[e],xu[1]=t[e+1],xu[2]=t[e+2],xu[3]=t[e+3],Au[0]}(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw Pu(this,4);const t=function(t,e){return Nu[0]=t[e],Nu[1]=t[e+1],Nu[2]=t[e+2],Nu[3]=t[e+3],Nu[4]=t[e+4],Nu[5]=t[e+5],Nu[6]=t[e+6],Nu[7]=t[e+7],Iu[0]}(this.buf,this.pos);return this.pos+=8,t}bytes(){const t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw Pu(this,t);return this.pos+=t,e===n?new Uint8Array(0):this.buf.subarray(e,n)}string(){const t=this.bytes();return function(t,e,n){if(n-e<1)return"";let r;const o=[];let i,s=0;for(;e<n;)i=t[e++],i<128?o[s++]=i:i>191&&i<224?o[s++]=(31&i)<<6|63&t[e++]:i>239&&i<365?(i=((7&i)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,o[s++]=55296+(i>>10),o[s++]=56320+(1023&i)):o[s++]=(15&i)<<12|(63&t[e++])<<6|63&t[e++],s>8191&&((r??(r=[])).push(String.fromCharCode.apply(String,o)),s=0);return null!=r?(s>0&&r.push(String.fromCharCode.apply(String,o.slice(0,s))),r.join("")):String.fromCharCode.apply(String,o.slice(0,s))}(t,0,t.length)}skip(t){if("number"===typeof t){if(this.pos+t>this.len)throw Pu(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw Pu(this)}while(0!==(128&this.buf[this.pos++]));return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){const t=new $u(0,0);let e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw Pu(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Pu(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Pu(this,8);const t=Du(this.buf,this.pos+=4),e=Du(this.buf,this.pos+=4);return new $u(t,e)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const t=(0,ku.Sb)(this.buf,this.pos);return this.pos+=(0,ku.OY)(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function _u(t,e,n){const r=function(t){return new ju(t instanceof Uint8Array?t:t.subarray())}(t);return e.decode(r,void 0,n)}function Hu(t=0){return new Uint8Array(t)}function Fu(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Vu=Fu("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),Mu=Fu("ascii","a",(t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}),(t=>{const e=Hu((t=t.substring(1)).length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e})),zu={utf8:Vu,"utf-8":Vu,hex:Di.Fo.base16,latin1:Mu,ascii:Mu,binary:Mu,...Di.Fo};class Gu{fn;len;next;val;constructor(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}}function qu(){}class Wu{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}}const Ju=function(t){const e=t??8192,n=e>>>1;let r,o=e;return function(t){if(t<1||t>n)return Hu(t);o+t>e&&(r=Hu(e),o=0);const i=r.subarray(o,o+=t);return 0!==(7&o)&&(o=1+(7|o)),i}}();class Zu{len;head;tail;states;constructor(){this.len=0,this.head=new Gu(qu,0,0),this.tail=this.head,this.states=null}_push(t,e,n){return this.tail=this.tail.next=new Gu(t,e,n),this.len+=e,this}uint32(t){return this.len+=(this.tail=this.tail.next=new Qu((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(Xu,10,$u.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){const e=$u.fromBigInt(t);return this._push(Xu,e.length(),e)}uint64Number(t){return this._push(ku.mD,(0,ku.OY)(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){const e=$u.fromBigInt(t).zzEncode();return this._push(Xu,e.length(),e)}sint64Number(t){const e=$u.fromNumber(t).zzEncode();return this._push(Xu,e.length(),e)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(Ku,1,t?1:0)}fixed32(t){return this._push(tc,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){const e=$u.fromBigInt(t);return this._push(tc,4,e.lo)._push(tc,4,e.hi)}fixed64Number(t){const e=$u.fromNumber(t);return this._push(tc,4,e.lo)._push(tc,4,e.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(Su,4,t)}double(t){return this._push(Cu,8,t)}bytes(t){const e=t.length>>>0;return 0===e?this._push(Ku,1,0):this.uint32(e)._push(ec,e,t)}string(t){const e=function(t){let e=0,n=0;for(let r=0;r<t.length;++r)n=t.charCodeAt(r),n<128?e+=1:n<2048?e+=2:55296===(64512&n)&&56320===(64512&t.charCodeAt(r+1))?(++r,e+=4):e+=3;return e}(t);return 0!==e?this.uint32(e)._push(Ru,e,t):this._push(Ku,1,0)}fork(){return this.states=new Wu(this),this.head=this.tail=new Gu(qu,0,0),this.len=0,this}reset(){return null!=this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Gu(qu,0,0),this.len=0),this}ldelim(){const t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),0!==n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this}finish(){let t=this.head.next;const e=(n=this.len,null!=globalThis.Buffer?Hu(n):Ju(n));var n;let r=0;for(;null!=t;)t.fn(t.val,e,r),r+=t.len,t=t.next;return e}}function Ku(t,e,n){e[n]=255&t}function Yu(t,e,n){for(;t>127;)e[n++]=127&t|128,t>>>=7;e[n]=t}class Qu extends Gu{next;constructor(t,e){super(Yu,t,e),this.next=void 0}}function Xu(t,e,n){for(;0!==t.hi;)e[n++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[n++]=127&t.lo|128,t.lo=t.lo>>>7;e[n++]=t.lo}function tc(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}function ec(t,e,n){e.set(t,n)}function nc(t,e,n){e.set(t,n)}function rc(t,e,n){t.length<40?Ru(t,e,n):null!=e.utf8Write?e.utf8Write(t,n):e.set(function(t,e="utf8"){const n=zu[e];if(null==n)throw new Error(`Unsupported encoding "${e}"`);return n.decoder.decode(`${n.prefix}${t}`)}(t),n)}function oc(t,e){const n=new Zu;return e.encode(t,n,{lengthDelimited:!1}),n.finish()}var ic,sc,ac,uc,cc;function lc(t,e,n,r){return{name:t,type:e,encode:n,decode:r}}function hc(t,e){return lc("message",ic.LENGTH_DELIMITED,t,e)}null!=globalThis.Buffer&&(Zu.prototype.bytes=function(t){const e=t.length>>>0;return this.uint32(e),e>0&&this._push(nc,e,t),this},Zu.prototype.string=function(t){const e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(rc,e,t),this}),function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"}(ic||(ic={}));Error;!function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.secp256k1="secp256k1"}(sc||(sc={})),function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.secp256k1=2]="secp256k1"}(ac||(ac={})),function(t){t.codec=()=>function(t){function e(e){if(null==t[e.toString()])throw new Error("Invalid enum value");return t[e]}return lc("enum",ic.VARINT,(function(t,n){const r=e(t);n.int32(r)}),(function(t){return e(t.int32())}))}(ac)}(sc||(sc={})),function(t){let e;t.codec=()=>(null==e&&(e=hc((function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&e.fork(),null!=t.Type&&(e.uint32(8),sc.codec().encode(t.Type,e)),null!=t.Data&&(e.uint32(18),e.bytes(t.Data)),!1!==n.lengthDelimited&&e.ldelim()}),(function(t,e){const n={},r=null==e?t.len:t.pos+e;for(;t.pos<r;){const e=t.uint32();switch(e>>>3){case 1:n.Type=sc.codec().decode(t);break;case 2:n.Data=t.bytes();break;default:t.skipType(7&e)}}return n}))),e),t.encode=e=>oc(e,t.codec()),t.decode=(e,n)=>_u(e,t.codec(),n)}(uc||(uc={})),function(t){let e;t.codec=()=>(null==e&&(e=hc((function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!1!==n.lengthDelimited&&e.fork(),null!=t.Type&&(e.uint32(8),sc.codec().encode(t.Type,e)),null!=t.Data&&(e.uint32(18),e.bytes(t.Data)),!1!==n.lengthDelimited&&e.ldelim()}),(function(t,e){const n={},r=null==e?t.len:t.pos+e;for(;t.pos<r;){const e=t.uint32();switch(e>>>3){case 1:n.Type=sc.codec().decode(t);break;case 2:n.Data=t.bytes();break;default:t.skipType(7&e)}}return n}))),e),t.encode=e=>oc(e,t.codec()),t.decode=(e,n)=>_u(e,t.codec(),n)}(cc||(cc={}));const fc=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),dc=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),gc=new Uint32Array(64);class pc extends zs{constructor(){super(64,32,8,!1),this.A=0|dc[0],this.B=0|dc[1],this.C=0|dc[2],this.D=0|dc[3],this.E=0|dc[4],this.F=0|dc[5],this.G=0|dc[6],this.H=0|dc[7]}get(){const{A:t,B:e,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[t,e,n,r,o,i,s,a]}set(t,e,n,r,o,i,s,a){this.A=0|t,this.B=0|e,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(t,e){for(let h=0;h<16;h++,e+=4)gc[h]=t.getUint32(e,!1);for(let h=16;h<64;h++){const t=gc[h-15],e=gc[h-2],n=js(t,7)^js(t,18)^t>>>3,r=js(e,17)^js(e,19)^e>>>10;gc[h]=r+gc[h-7]+n+gc[h-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:u,H:c}=this;for(let h=0;h<64;h++){const t=c+(js(s,6)^js(s,11)^js(s,25))+((l=s)&a^~l&u)+fc[h]+gc[h]|0,e=(js(n,2)^js(n,13)^js(n,22))+Ms(n,r,o)|0;c=u,u=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+e|0}var l;n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,r,o,i,s,a,u,c)}roundClean(){gc.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const yc=Fs((()=>new pc));var wc=n(8275);function mc(t,e){let n=0;if(1===t.length)return t[0];for(let r=t.length-1;r>=0;r--)n+=t[t.length-1-r]*Math.pow(2,e*r);return n}function bc(t,e){const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;let r=t,o=0,i=Math.pow(2,e);for(let s=1;s<8;s++){if(t<i){let t;if(n<0)t=new ArrayBuffer(s),o=s;else{if(n<s)return new ArrayBuffer(0);t=new ArrayBuffer(n),o=n}const i=new Uint8Array(t);for(let n=s-1;n>=0;n--){const t=Math.pow(2,n*e);i[o-n-1]=Math.floor(r/t),r-=i[o-n-1]*t}return t}i*=Math.pow(2,e)}return new ArrayBuffer(0)}function vc(){let t=0,e=0;for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];for(const a of r)t+=a.length;const i=new ArrayBuffer(t),s=new Uint8Array(i);for(const a of r)s.set(a,e),e+=a.length;return s}function Ec(){const t=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const e=255===t[0]&&128&t[1],n=0===t[0]&&0===(128&t[1]);(e||n)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),n=new Uint8Array(e);for(let s=0;s<this.valueHex.byteLength;s++)n[s]=0;n[0]=128&t[0];const r=mc(n,8),o=new ArrayBuffer(this.valueHex.byteLength),i=new Uint8Array(o);for(let s=0;s<this.valueHex.byteLength;s++)i[s]=t[s];i[0]&=127;return mc(i,8)-r}function Bc(t,e){const n=t.toString(10);if(e<n.length)return"";const r=e-n.length,o=new Array(r);for(let i=0;i<r;i++)o[i]="0";return o.join("").concat(n)}Math.log(2);function kc(){if("undefined"===typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Ac(t){let e=0,n=0;for(let o=0;o<t.length;o++){e+=t[o].byteLength}const r=new Uint8Array(e);for(let o=0;o<t.length;o++){const e=t[o];r.set(new Uint8Array(e),n),n+=e.byteLength}return r.buffer}function xc(t,e,n,r){return e instanceof Uint8Array?e.byteLength?n<0?(t.error="Wrong parameter: inputOffset less than zero",!1):r<0?(t.error="Wrong parameter: inputLength less than zero",!1):!(e.byteLength-n-r<0)||(t.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(t.error="Wrong parameter: inputBuffer has zero length",!1):(t.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class Sc{constructor(){this.items=[]}write(t){this.items.push(t)}final(){return Ac(this.items)}}const Ic=[new Uint8Array([1])],Nc="0123456789",Cc="",Uc=new ArrayBuffer(0),Tc=new Uint8Array(0),$c="EndOfContent",Oc="OCTET STRING",Lc="BIT STRING";function Rc(t){var e;return e=class extends t{constructor(){var t;super(...arguments);const e=(arguments.length<=0?void 0:arguments[0])||{};this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?wc._H.toUint8Array(e.valueHex):Tc}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(t){this.valueHexView=new Uint8Array(t)}fromBER(t,e,n){const r=t instanceof ArrayBuffer?new Uint8Array(t):t;if(!xc(this,r,e,n))return-1;const o=e+n;return this.valueHexView=r.subarray(e,o),this.valueHexView.length?(this.blockLength=n,o):(this.warnings.push("Zero buffer length"),e)}toBER(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isHexOnly?t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Uc)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:wc.U$.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}class Pc{constructor(){let{blockLength:t=0,error:e=Cc,warnings:n=[],valueBeforeDecode:r=Tc}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.blockLength=t,this.error=e,this.warnings=n,this.valueBeforeDecodeView=wc._H.toUint8Array(r)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(t){this.valueBeforeDecodeView=new Uint8Array(t)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:wc.U$.ToHex(this.valueBeforeDecodeView)}}}Pc.NAME="baseBlock";class Dc extends Pc{fromBER(t,e,n){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(t,e){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}Dc.NAME="valueBlock";class jc extends(Rc(Pc)){constructor(){let{idBlock:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var e,n,r,o;super(),t?(this.isHexOnly=null!==(e=t.isHexOnly)&&void 0!==e&&e,this.valueHexView=t.valueHex?wc._H.toUint8Array(t.valueHex):Tc,this.tagClass=null!==(n=t.tagClass)&&void 0!==n?n:-1,this.tagNumber=null!==(r=t.tagNumber)&&void 0!==r?r:-1,this.isConstructed=null!==(o=t.isConstructed)&&void 0!==o&&o):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=0;switch(this.tagClass){case 1:e|=0;break;case 2:e|=64;break;case 3:e|=128;break;case 4:e|=192;break;default:return this.error="Unknown tag class",Uc}if(this.isConstructed&&(e|=32),this.tagNumber<31&&!this.isHexOnly){const n=new Uint8Array(1);if(!t){let t=this.tagNumber;t&=31,e|=t,n[0]=e}return n.buffer}if(!this.isHexOnly){const n=bc(this.tagNumber,7),r=new Uint8Array(n),o=n.byteLength,i=new Uint8Array(o+1);if(i[0]=31|e,!t){for(let t=0;t<o-1;t++)i[t+1]=128|r[t];i[o]=r[o-1]}return i.buffer}const n=new Uint8Array(this.valueHexView.byteLength+1);if(n[0]=31|e,!t){const t=this.valueHexView;for(let e=0;e<t.length-1;e++)n[e+1]=128|t[e];n[this.valueHexView.byteLength]=t[t.length-1]}return n.buffer}fromBER(t,e,n){const r=wc._H.toUint8Array(t);if(!xc(this,r,e,n))return-1;const o=r.subarray(e,e+n);if(0===o.length)return this.error="Zero buffer length",-1;switch(192&o[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32===(32&o[0]),this.isHexOnly=!1;const i=31&o[0];if(31!==i)this.tagNumber=i,this.blockLength=1;else{let t=1,e=this.valueHexView=new Uint8Array(255),n=255;for(;128&o[t];){if(e[t-1]=127&o[t],t++,t>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(t===n){n+=255;const t=new Uint8Array(n);for(let n=0;n<e.length;n++)t[n]=e[n];e=this.valueHexView=new Uint8Array(n)}}this.blockLength=t+1,e[t-1]=127&o[t];const r=new Uint8Array(t);for(let o=0;o<t;o++)r[o]=e[o];e=this.valueHexView=new Uint8Array(t),e.set(r),this.blockLength<=9?this.tagNumber=mc(e,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return e+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}jc.NAME="identificationBlock";class _c extends Pc{constructor(){let{lenBlock:t={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var e,n,r;super(),this.isIndefiniteForm=null!==(e=t.isIndefiniteForm)&&void 0!==e&&e,this.longFormUsed=null!==(n=t.longFormUsed)&&void 0!==n&&n,this.length=null!==(r=t.length)&&void 0!==r?r:0}fromBER(t,e,n){const r=wc._H.toUint8Array(t);if(!xc(this,r,e,n))return-1;const o=r.subarray(e,e+n);if(0===o.length)return this.error="Zero buffer length",-1;if(255===o[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===o[0],this.isIndefiniteForm)return this.blockLength=1,e+this.blockLength;if(this.longFormUsed=!!(128&o[0]),!1===this.longFormUsed)return this.length=o[0],this.blockLength=1,e+this.blockLength;const i=127&o[0];if(i>8)return this.error="Too big integer",-1;if(i+1>o.length)return this.error="End of input reached before message was fully decoded",-1;const s=e+1,a=r.subarray(s,s+i);return 0===a[i-1]&&this.warnings.push("Needlessly long encoded length"),this.length=mc(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=i+1,e+this.blockLength}toBER(){let t,e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===n&&(e=new Uint8Array(t),e[0]=128),t;if(this.longFormUsed){const r=bc(this.length,8);if(r.byteLength>127)return this.error="Too big length",Uc;if(t=new ArrayBuffer(r.byteLength+1),n)return t;const o=new Uint8Array(r);e=new Uint8Array(t),e[0]=128|r.byteLength;for(let t=0;t<r.byteLength;t++)e[t+1]=o[t];return t}return t=new ArrayBuffer(1),!1===n&&(e=new Uint8Array(t),e[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}_c.NAME="lengthBlock";const Hc={};class Fc extends Pc{constructor(){let{name:t=Cc,optional:e=!1,primitiveSchema:n,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;super(r),this.name=t,this.optional=e,n&&(this.primitiveSchema=n),this.idBlock=new jc(r),this.lenBlock=new _c(r),this.valueBlock=o?new o(r):new Dc(r)}fromBER(t,e,n){const r=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return-1===r?(this.error=this.valueBlock.error,r):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}toBER(t,e){const n=e||new Sc;e||Vc(this);const r=this.idBlock.toBER(t);if(n.write(r),this.lenBlock.isIndefiniteForm)n.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(t,n),n.write(new ArrayBuffer(2));else{const e=this.valueBlock.toBER(t);this.lenBlock.length=e.byteLength;const r=this.lenBlock.toBER(t);n.write(r),n.write(e)}return e?Uc:n.final()}toJSON(){const t={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(t.primitiveSchema=this.primitiveSchema.toJSON()),t}toString(){return"ascii"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ascii")?this.onAsciiEncoding():wc.U$.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${wc.U$.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(t){if(this===t)return!0;if(!(t instanceof this.constructor))return!1;return function(t,e){if(t.byteLength!==e.byteLength)return!1;const n=new Uint8Array(t),r=new Uint8Array(e);for(let o=0;o<n.length;o++)if(n[o]!==r[o])return!1;return!0}(this.toBER(),t.toBER())}}function Vc(t){if(t instanceof Hc.Constructed)for(const e of t.valueBlock.value)Vc(e)&&(t.lenBlock.isIndefiniteForm=!0);return!!t.lenBlock.isIndefiniteForm}Fc.NAME="BaseBlock";class Mc extends Fc{constructor(){let{value:t=Cc,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e,arguments.length>1?arguments[1]:void 0),t&&this.fromString(t)}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}fromBER(t,e,n){const r=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return-1===r?(this.error=this.valueBlock.error,r):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}Mc.NAME="BaseStringBlock";class zc extends(Rc(Dc)){constructor(){let{isHexOnly:t=!0,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.isHexOnly=t}}var Gc,qc,Wc,Jc,Zc,Kc,Yc,Qc,Xc,tl,el,nl,rl,ol,il,sl,al,ul,cl,ll,hl,fl,dl,gl,pl,yl,wl,ml,bl,vl,El,Bl,kl;zc.NAME="PrimitiveValueBlock";class Al extends Fc{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},zc),this.idBlock.isConstructed=!1}}function xl(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length;const r=e;let o=new Fc({},Dc);const i=new Pc;if(!xc(i,t,e,n))return o.error=i.error,{offset:-1,result:o};if(!t.subarray(e,e+n).length)return o.error="Zero buffer length",{offset:-1,result:o};let s=o.idBlock.fromBER(t,e,n);if(o.idBlock.warnings.length&&o.warnings.concat(o.idBlock.warnings),-1===s)return o.error=o.idBlock.error,{offset:-1,result:o};if(e=s,n-=o.idBlock.blockLength,s=o.lenBlock.fromBER(t,e,n),o.lenBlock.warnings.length&&o.warnings.concat(o.lenBlock.warnings),-1===s)return o.error=o.lenBlock.error,{offset:-1,result:o};if(e=s,n-=o.lenBlock.blockLength,!o.idBlock.isConstructed&&o.lenBlock.isIndefiniteForm)return o.error="Indefinite length form used for primitive encoding form",{offset:-1,result:o};let a=Fc;if(1===o.idBlock.tagClass){if(o.idBlock.tagNumber>=37&&!1===o.idBlock.isHexOnly)return o.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:o};switch(o.idBlock.tagNumber){case 0:if(o.idBlock.isConstructed&&o.lenBlock.length>0)return o.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:o};a=Hc.EndOfContent;break;case 1:a=Hc.Boolean;break;case 2:a=Hc.Integer;break;case 3:a=Hc.BitString;break;case 4:a=Hc.OctetString;break;case 5:a=Hc.Null;break;case 6:a=Hc.ObjectIdentifier;break;case 10:a=Hc.Enumerated;break;case 12:a=Hc.Utf8String;break;case 13:a=Hc.RelativeObjectIdentifier;break;case 14:a=Hc.TIME;break;case 15:return o.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:o};case 16:a=Hc.Sequence;break;case 17:a=Hc.Set;break;case 18:a=Hc.NumericString;break;case 19:a=Hc.PrintableString;break;case 20:a=Hc.TeletexString;break;case 21:a=Hc.VideotexString;break;case 22:a=Hc.IA5String;break;case 23:a=Hc.UTCTime;break;case 24:a=Hc.GeneralizedTime;break;case 25:a=Hc.GraphicString;break;case 26:a=Hc.VisibleString;break;case 27:a=Hc.GeneralString;break;case 28:a=Hc.UniversalString;break;case 29:a=Hc.CharacterString;break;case 30:a=Hc.BmpString;break;case 31:a=Hc.DATE;break;case 32:a=Hc.TimeOfDay;break;case 33:a=Hc.DateTime;break;case 34:a=Hc.Duration;break;default:{const t=o.idBlock.isConstructed?new Hc.Constructed:new Hc.Primitive;t.idBlock=o.idBlock,t.lenBlock=o.lenBlock,t.warnings=o.warnings,o=t}}}else a=o.idBlock.isConstructed?Hc.Constructed:Hc.Primitive;return o=function(t,e){if(t instanceof e)return t;const n=new e;return n.idBlock=t.idBlock,n.lenBlock=t.lenBlock,n.warnings=t.warnings,n.valueBeforeDecodeView=t.valueBeforeDecodeView,n}(o,a),s=o.fromBER(t,e,o.lenBlock.isIndefiniteForm?n:o.lenBlock.length),o.valueBeforeDecodeView=t.subarray(r,r+o.blockLength),{offset:s,result:o}}Gc=Al,Hc.Primitive=Gc,Al.NAME="PRIMITIVE";class Sl extends Dc{constructor(){let{value:t=[],isIndefiniteForm:e=!1,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(n),this.value=t,this.isIndefiniteForm=e}fromBER(t,e,n){const r=wc._H.toUint8Array(t);if(!xc(this,r,e,n))return-1;if(this.valueBeforeDecodeView=r.subarray(e,e+n),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),e;let o=e;for(;i=this.isIndefiniteForm,s=n,(i?1:s)>0;){const t=xl(r,o,n);if(-1===t.offset)return this.error=t.result.error,this.warnings.concat(t.result.warnings),-1;if(o=t.offset,this.blockLength+=t.result.blockLength,n-=t.result.blockLength,this.value.push(t.result),this.isIndefiniteForm&&t.result.constructor.NAME===$c)break}var i,s;return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===$c?this.value.pop():this.warnings.push("No EndOfContent block encoded")),o}toBER(t,e){const n=e||new Sc;for(let r=0;r<this.value.length;r++)this.value[r].toBER(t,n);return e?Uc:n.final()}toJSON(){const t={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const e of this.value)t.value.push(e.toJSON());return t}}Sl.NAME="ConstructedValueBlock";class Il extends Fc{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Sl),this.idBlock.isConstructed=!0}fromBER(t,e,n){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const r=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return-1===r?(this.error=this.valueBlock.error,r):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),r)}onAsciiEncoding(){const t=[];for(const n of this.valueBlock.value)t.push(n.toString("ascii").split("\n").map((t=>`  ${t}`)).join("\n"));const e=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return t.length?`${e} :\n${t.join("\n")}`:`${e} :`}}qc=Il,Hc.Constructed=qc,Il.NAME="CONSTRUCTED";class Nl extends Dc{fromBER(t,e,n){return e}toBER(t){return Uc}}Nl.override="EndOfContentValueBlock";class Cl extends Fc{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Nl),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}Wc=Cl,Hc.EndOfContent=Wc,Cl.NAME=$c;class Ul extends Fc{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Dc),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(t,e,n){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=n,e+n>t.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+n}toBER(t,e){const n=new ArrayBuffer(2);if(!t){const t=new Uint8Array(n);t[0]=5,t[1]=0}return e&&e.write(n),n}onAsciiEncoding(){return`${this.constructor.NAME}`}}Jc=Ul,Hc.Null=Jc,Ul.NAME="NULL";class Tl extends(Rc(Dc)){constructor(){let{value:t,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),e.valueHex?this.valueHexView=wc._H.toUint8Array(e.valueHex):this.valueHexView=new Uint8Array(1),t&&(this.value=t)}get value(){for(const t of this.valueHexView)if(t>0)return!0;return!1}set value(t){this.valueHexView[0]=t?255:0}fromBER(t,e,n){const r=wc._H.toUint8Array(t);return xc(this,r,e,n)?(this.valueHexView=r.subarray(e,e+n),n>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Ec.call(this),this.blockLength=n,e+n):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}Tl.NAME="BooleanValueBlock";class $l extends Fc{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Tl),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}Zc=$l,Hc.Boolean=Zc,$l.NAME="BOOLEAN";class Ol extends(Rc(Sl)){constructor(){let{isConstructed:t=!1,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.isConstructed=t}fromBER(t,e,n){let r=0;if(this.isConstructed){if(this.isHexOnly=!1,r=Sl.prototype.fromBER.call(this,t,e,n),-1===r)return r;for(let t=0;t<this.value.length;t++){const e=this.value[t].constructor.NAME;if(e===$c){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(e!==Oc)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,r=super.fromBER(t,e,n),this.blockLength=n;return r}toBER(t,e){return this.isConstructed?Sl.prototype.toBER.call(this,t,e):t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}Ol.NAME="OctetStringValueBlock";class Ll extends Fc{constructor(){let{idBlock:t={},lenBlock:e={},...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var r,o;null!==(r=n.isConstructed)&&void 0!==r||(n.isConstructed=!!(null===(o=n.value)||void 0===o?void 0:o.length)),super({idBlock:{isConstructed:n.isConstructed,...t},lenBlock:{...e,isIndefiniteForm:!!n.isIndefiniteForm},...n},Ol),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(t,e,n){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===n)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),e;if(!this.valueBlock.isConstructed){const o=(t instanceof ArrayBuffer?new Uint8Array(t):t).subarray(e,e+n);try{if(o.byteLength){const t=xl(o,0,o.byteLength);-1!==t.offset&&t.offset===n&&(this.valueBlock.value=[t.result])}}catch(r){}}return super.fromBER(t,e,n)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?Il.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${wc.U$.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const t=[];for(const e of this.valueBlock.value)e instanceof Ll&&t.push(e.valueBlock.valueHexView);return wc._H.concat(t)}}Kc=Ll,Hc.OctetString=Kc,Ll.NAME=Oc;class Rl extends(Rc(Sl)){constructor(){let{unusedBits:t=0,isConstructed:e=!1,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(n),this.unusedBits=t,this.isConstructed=e,this.blockLength=this.valueHexView.byteLength}fromBER(t,e,n){if(!n)return e;let r=-1;if(this.isConstructed){if(r=Sl.prototype.fromBER.call(this,t,e,n),-1===r)return r;for(const t of this.value){const e=t.constructor.NAME;if(e===$c){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(e!==Lc)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const n=t.valueBlock;if(this.unusedBits>0&&n.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=n.unusedBits}return r}const o=wc._H.toUint8Array(t);if(!xc(this,o,e,n))return-1;const i=o.subarray(e,e+n);if(this.unusedBits=i[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const t=i.subarray(1);try{if(t.byteLength){const e=xl(t,0,t.byteLength);-1!==e.offset&&e.offset===n-1&&(this.value=[e.result])}}catch(s){}}return this.valueHexView=i.subarray(1),this.blockLength=i.length,e+n}toBER(t,e){if(this.isConstructed)return Sl.prototype.toBER.call(this,t,e);if(t)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Uc;const n=new Uint8Array(this.valueHexView.length+1);return n[0]=this.unusedBits,n.set(this.valueHexView,1),n.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}Rl.NAME="BitStringValueBlock";class Pl extends Fc{constructor(){let{idBlock:t={},lenBlock:e={},...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var r,o;null!==(r=n.isConstructed)&&void 0!==r||(n.isConstructed=!!(null===(o=n.value)||void 0===o?void 0:o.length)),super({idBlock:{isConstructed:n.isConstructed,...t},lenBlock:{...e,isIndefiniteForm:!!n.isIndefiniteForm},...n},Rl),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(t,e,n){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(t,e,n)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Il.prototype.onAsciiEncoding.call(this);{const t=[],e=this.valueBlock.valueHexView;for(const r of e)t.push(r.toString(2).padStart(8,"0"));const n=t.join("");return`${this.constructor.NAME} : ${n.substring(0,n.length-this.valueBlock.unusedBits)}`}}}function Dl(t,e){const n=new Uint8Array([0]),r=new Uint8Array(t),o=new Uint8Array(e);let i=r.slice(0);const s=i.length-1,a=o.slice(0),u=a.length-1;let c=0;let l=0;for(let h=u<s?s:u;h>=0;h--,l++){if(!0===l<a.length)c=i[s-l]+a[u-l]+n[0];else c=i[s-l]+n[0];if(n[0]=c/10,!0===l>=i.length)i=vc(new Uint8Array([c%10]),i);else i[s-l]=c%10}return n[0]>0&&(i=vc(n,i)),i}function jl(t){if(t>=Ic.length)for(let e=Ic.length;e<=t;e++){const t=new Uint8Array([0]);let n=Ic[e-1].slice(0);for(let e=n.length-1;e>=0;e--){const r=new Uint8Array([(n[e]<<1)+t[0]]);t[0]=r[0]/10,n[e]=r[0]%10}t[0]>0&&(n=vc(t,n)),Ic.push(n)}return Ic[t]}function _l(t,e){let n=0;const r=new Uint8Array(t),o=new Uint8Array(e),i=r.slice(0),s=i.length-1,a=o.slice(0),u=a.length-1;let c,l=0;for(let h=u;h>=0;h--,l++)if(c=i[s-l]-a[u-l]-n,!0===c<0)n=1,i[s-l]=c+10;else n=0,i[s-l]=c;if(n>0)for(let h=s-u+1;h>=0;h--,l++){if(c=i[s-l]-n,!(c<0)){n=0,i[s-l]=c;break}n=1,i[s-l]=c+10}return i.slice()}Yc=Pl,Hc.BitString=Yc,Pl.NAME=Lc;class Hl extends(Rc(Dc)){constructor(){let{value:t,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this._valueDec=0,e.valueHex&&this.setValueHex(),void 0!==t&&(this.valueDec=t)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Ec.call(this)))}set valueDec(t){this._valueDec=t,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(t){const e=t<0?-1*t:t;let n=128;for(let r=1;r<8;r++){if(e<=n){if(t<0){const t=bc(n-e,8,r);return new Uint8Array(t)[0]|=128,t}let o=bc(e,8,r),i=new Uint8Array(o);if(128&i[0]){const t=o.slice(0),e=new Uint8Array(t);o=new ArrayBuffer(o.byteLength+1),i=new Uint8Array(o);for(let n=0;n<t.byteLength;n++)i[n+1]=e[n];i[0]=0}return o}n*=Math.pow(2,8)}return new ArrayBuffer(0)}(t))}get valueDec(){return this._valueDec}fromDER(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=this.fromBER(t,e,n);if(-1===o)return o;const i=this.valueHexView;return 0===i[0]&&0!==(128&i[1])?this.valueHexView=i.subarray(1):0!==r&&i.length<r&&(r-i.length>1&&(r=i.length+1),this.valueHexView=i.subarray(r-i.length)),o}toDER(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.valueHexView;switch(!0){case 0!==(128&e[0]):{const t=new Uint8Array(this.valueHexView.length+1);t[0]=0,t.set(e,1),this.valueHexView=t}break;case 0===e[0]&&0===(128&e[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(t)}fromBER(t,e,n){const r=super.fromBER(t,e,n);return-1===r||this.setValueHex(),r}toBER(t){return t?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const t=8*this.valueHexView.length-1;let e,n=new Uint8Array(8*this.valueHexView.length/3),r=0;const o=this.valueHexView;let i="",s=!1;for(let a=o.byteLength-1;a>=0;a--){e=o[a];for(let o=0;o<8;o++){if(1===(1&e))if(r===t)n=_l(jl(r),n),i="-";else n=Dl(n,jl(r));r++,e>>=1}}for(let a=0;a<n.length;a++)n[a]&&(s=!0),s&&(i+=Nc.charAt(n[a]));return!1===s&&(i+=Nc.charAt(0)),i}}Qc=Hl,Hl.NAME="IntegerValueBlock",Object.defineProperty(Qc.prototype,"valueHex",{set:function(t){this.valueHexView=new Uint8Array(t),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class Fl extends Fc{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Hl),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return kc(),BigInt(this.valueBlock.toString())}static fromBigInt(t){kc();const e=BigInt(t),n=new Sc,r=e.toString(16).replace(/^-/,""),o=new Uint8Array(wc.U$.FromHex(r));if(e<0){const t=new Uint8Array(o.length+(128&o[0]?1:0));t[0]|=128;const r=BigInt(`0x${wc.U$.ToHex(t)}`)+e,i=wc._H.toUint8Array(wc.U$.FromHex(r.toString(16)));i[0]|=128,n.write(i)}else 128&o[0]&&n.write(new Uint8Array([0])),n.write(o);return new Fl({valueHex:n.final()})}convertToDER(){const t=new Fl({valueHex:this.valueBlock.valueHexView});return t.valueBlock.toDER(),t}convertFromDER(){return new Fl({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Xc=Fl,Hc.Integer=Xc,Fl.NAME="INTEGER";class Vl extends Fl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}tl=Vl,Hc.Enumerated=tl,Vl.NAME="ENUMERATED";class Ml extends(Rc(Dc)){constructor(){let{valueDec:t=-1,isFirstSid:e=!1,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(n),this.valueDec=t,this.isFirstSid=e}fromBER(t,e,n){if(!n)return e;const r=wc._H.toUint8Array(t);if(!xc(this,r,e,n))return-1;const o=r.subarray(e,e+n);this.valueHexView=new Uint8Array(n);for(let s=0;s<n&&(this.valueHexView[s]=127&o[s],this.blockLength++,0!==(128&o[s]));s++);const i=new Uint8Array(this.blockLength);for(let s=0;s<this.blockLength;s++)i[s]=this.valueHexView[s];return this.valueHexView=i,0!==(128&o[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=mc(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}set valueBigInt(t){kc();let e=BigInt(t).toString(2);for(;e.length%7;)e="0"+e;const n=new Uint8Array(e.length/7);for(let r=0;r<n.length;r++)n[r]=parseInt(e.slice(7*r,7*r+7),2)+(r+1<n.length?128:0);this.fromBER(n.buffer,0,n.length)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const e=this.valueHexView,n=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength-1;t++)n[t]=128|e[t];return n[this.blockLength-1]=e[this.blockLength-1],n.buffer}const e=bc(this.valueDec,7);if(0===e.byteLength)return this.error="Error during encoding SID value",Uc;const n=new Uint8Array(e.byteLength);if(!t){const t=new Uint8Array(e),r=e.byteLength-1;for(let e=0;e<r;e++)n[e]=128|t[e];n[r]=t[r]}return n}toString(){let t="";if(this.isHexOnly)t=wc.U$.ToHex(this.valueHexView);else if(this.isFirstSid){let e=this.valueDec;this.valueDec<=39?t="0.":this.valueDec<=79?(t="1.",e-=40):(t="2.",e-=80),t+=e.toString()}else t=this.valueDec.toString();return t}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Ml.NAME="sidBlock";class zl extends Dc{constructor(){let{value:t=Cc,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,n){let r=e;for(;n>0;){const e=new Ml;if(r=e.fromBER(t,r,n),-1===r)return this.blockLength=0,this.error=e.error,r;0===this.value.length&&(e.isFirstSid=!0),this.blockLength+=e.blockLength,n-=e.blockLength,this.value.push(e)}return r}toBER(t){const e=[];for(let n=0;n<this.value.length;n++){const r=this.value[n].toBER(t);if(0===r.byteLength)return this.error=this.value[n].error,Uc;e.push(r)}return Ac(e)}fromString(t){this.value=[];let e=0,n=0,r="",o=!1;do{if(n=t.indexOf(".",e),r=-1===n?t.substring(e):t.substring(e,n),e=n+1,o){const t=this.value[0];let e=0;switch(t.valueDec){case 0:break;case 1:e=40;break;case 2:e=80;break;default:return void(this.value=[])}const n=parseInt(r,10);if(isNaN(n))return;t.valueDec=n+e,o=!1}else{const t=new Ml;if(r>Number.MAX_SAFE_INTEGER){kc();const e=BigInt(r);t.valueBigInt=e}else if(t.valueDec=parseInt(r,10),isNaN(t.valueDec))return;this.value.length||(t.isFirstSid=!0,o=!0),this.value.push(t)}}while(-1!==n)}toString(){let t="",e=!1;for(let n=0;n<this.value.length;n++){e=this.value[n].isHexOnly;let r=this.value[n].toString();0!==n&&(t=`${t}.`),e?(r=`{${r}}`,this.value[n].isFirstSid?t=`2.{${r} - 80}`:t+=r):t+=r}return t}toJSON(){const t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}zl.NAME="ObjectIdentifierValueBlock";class Gl extends Fc{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},zl),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}el=Gl,Hc.ObjectIdentifier=el,Gl.NAME="OBJECT IDENTIFIER";class ql extends(Rc(Pc)){constructor(){let{valueDec:t=0,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.valueDec=t}fromBER(t,e,n){if(0===n)return e;const r=wc._H.toUint8Array(t);if(!xc(this,r,e,n))return-1;const o=r.subarray(e,e+n);this.valueHexView=new Uint8Array(n);for(let s=0;s<n&&(this.valueHexView[s]=127&o[s],this.blockLength++,0!==(128&o[s]));s++);const i=new Uint8Array(this.blockLength);for(let s=0;s<this.blockLength;s++)i[s]=this.valueHexView[s];return this.valueHexView=i,0!==(128&o[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=mc(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const e=this.valueHexView,n=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength-1;t++)n[t]=128|e[t];return n[this.blockLength-1]=e[this.blockLength-1],n.buffer}const e=bc(this.valueDec,7);if(0===e.byteLength)return this.error="Error during encoding SID value",Uc;const n=new Uint8Array(e.byteLength);if(!t){const t=new Uint8Array(e),r=e.byteLength-1;for(let e=0;e<r;e++)n[e]=128|t[e];n[r]=t[r]}return n.buffer}toString(){let t="";return t=this.isHexOnly?wc.U$.ToHex(this.valueHexView):this.valueDec.toString(),t}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}ql.NAME="relativeSidBlock";class Wl extends Dc{constructor(){let{value:t=Cc,...e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.value=[],t&&this.fromString(t)}fromBER(t,e,n){let r=e;for(;n>0;){const e=new ql;if(r=e.fromBER(t,r,n),-1===r)return this.blockLength=0,this.error=e.error,r;this.blockLength+=e.blockLength,n-=e.blockLength,this.value.push(e)}return r}toBER(t,e){const n=[];for(let r=0;r<this.value.length;r++){const e=this.value[r].toBER(t);if(0===e.byteLength)return this.error=this.value[r].error,Uc;n.push(e)}return Ac(n)}fromString(t){this.value=[];let e=0,n=0,r="";do{n=t.indexOf(".",e),r=-1===n?t.substring(e):t.substring(e,n),e=n+1;const o=new ql;if(o.valueDec=parseInt(r,10),isNaN(o.valueDec))return!0;this.value.push(o)}while(-1!==n);return!0}toString(){let t="",e=!1;for(let n=0;n<this.value.length;n++){e=this.value[n].isHexOnly;let r=this.value[n].toString();0!==n&&(t=`${t}.`),e?(r=`{${r}}`,t+=r):t+=r}return t}toJSON(){const t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}Wl.NAME="RelativeObjectIdentifierValueBlock";class Jl extends Fc{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},Wl),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}nl=Jl,Hc.RelativeObjectIdentifier=nl,Jl.NAME="RelativeObjectIdentifier";class Zl extends Il{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}rl=Zl,Hc.Sequence=rl,Zl.NAME="SEQUENCE";class Kl extends Il{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}ol=Kl,Hc.Set=ol,Kl.NAME="SET";class Yl extends(Rc(Dc)){constructor(){let{...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.isHexOnly=!0,this.value=Cc}toJSON(){return{...super.toJSON(),value:this.value}}}Yl.NAME="StringValueBlock";class Ql extends Yl{}Ql.NAME="SimpleStringValueBlock";class Xl extends Mc{constructor(){let{...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t,Ql)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,wc._H.toUint8Array(t))}fromString(t){const e=t.length,n=this.valueBlock.valueHexView=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=t.charCodeAt(r);this.valueBlock.value=t}}Xl.NAME="SIMPLE STRING";class th extends Xl{fromBuffer(t){this.valueBlock.valueHexView=wc._H.toUint8Array(t);try{this.valueBlock.value=wc.U$.ToUtf8String(t)}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`),this.valueBlock.value=wc.U$.ToBinary(t)}}fromString(t){this.valueBlock.valueHexView=new Uint8Array(wc.U$.FromUtf8String(t)),this.valueBlock.value=t}}th.NAME="Utf8StringValueBlock";class eh extends th{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}il=eh,Hc.Utf8String=il,eh.NAME="UTF8String";class nh extends Xl{fromBuffer(t){this.valueBlock.value=wc.U$.ToUtf16String(t),this.valueBlock.valueHexView=wc._H.toUint8Array(t)}fromString(t){this.valueBlock.value=t,this.valueBlock.valueHexView=new Uint8Array(wc.U$.FromUtf16String(t))}}nh.NAME="BmpStringValueBlock";class rh extends nh{constructor(){let{...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}sl=rh,Hc.BmpString=sl,rh.NAME="BMPString";class oh extends Xl{fromBuffer(t){const e=ArrayBuffer.isView(t)?t.slice().buffer:t.slice(0),n=new Uint8Array(e);for(let r=0;r<n.length;r+=4)n[r]=n[r+3],n[r+1]=n[r+2],n[r+2]=0,n[r+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(e))}fromString(t){const e=t.length,n=this.valueBlock.valueHexView=new Uint8Array(4*e);for(let r=0;r<e;r++){const e=bc(t.charCodeAt(r),8),o=new Uint8Array(e);if(o.length>4)continue;const i=4-o.length;for(let t=o.length-1;t>=0;t--)n[4*r+t+i]=o[t]}this.valueBlock.value=t}}oh.NAME="UniversalStringValueBlock";class ih extends oh{constructor(){let{...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}al=ih,Hc.UniversalString=al,ih.NAME="UniversalString";class sh extends Xl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}ul=sh,Hc.NumericString=ul,sh.NAME="NumericString";class ah extends Xl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}cl=ah,Hc.PrintableString=cl,ah.NAME="PrintableString";class uh extends Xl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}ll=uh,Hc.TeletexString=ll,uh.NAME="TeletexString";class ch extends Xl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}hl=ch,Hc.VideotexString=hl,ch.NAME="VideotexString";class lh extends Xl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}fl=lh,Hc.IA5String=fl,lh.NAME="IA5String";class hh extends Xl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}dl=hh,Hc.GraphicString=dl,hh.NAME="GraphicString";class fh extends Xl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}gl=fh,Hc.VisibleString=gl,fh.NAME="VisibleString";class dh extends Xl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}pl=dh,Hc.GeneralString=pl,dh.NAME="GeneralString";class gh extends Xl{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}yl=gh,Hc.CharacterString=yl,gh.NAME="CharacterString";class ph extends fh{constructor(){let{value:t,valueDate:e,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(super(n),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,t){this.fromString(t),this.valueBlock.valueHexView=new Uint8Array(t.length);for(let e=0;e<t.length;e++)this.valueBlock.valueHexView[e]=t.charCodeAt(e)}e&&(this.fromDate(e),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,wc._H.toUint8Array(t)))}toBuffer(){const t=this.toString(),e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return e}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(t){const e=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(t);if(null===e)return void(this.error="Wrong input string for conversion");const n=parseInt(e[1],10);this.year=n>=50?1900+n:2e3+n,this.month=parseInt(e[2],10),this.day=parseInt(e[3],10),this.hour=parseInt(e[4],10),this.minute=parseInt(e[5],10),this.second=parseInt(e[6],10)}toString(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"iso";if("iso"===t){const t=new Array(7);return t[0]=Bc(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=Bc(this.month,2),t[2]=Bc(this.day,2),t[3]=Bc(this.hour,2),t[4]=Bc(this.minute,2),t[5]=Bc(this.second,2),t[6]="Z",t.join("")}return super.toString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}wl=ph,Hc.UTCTime=wl,ph.NAME="UTCTime";class yh extends ph{constructor(){var t;super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(t){super.fromDate(t),this.millisecond=t.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(t){let e,n=!1,r="",o="",i=0,s=0,a=0;if("Z"===t[t.length-1])r=t.substring(0,t.length-1),n=!0;else{const e=new Number(t[t.length-1]);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");r=t}if(n){if(-1!==r.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==r.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let t=1,e=r.indexOf("+"),n="";if(-1===e&&(e=r.indexOf("-"),t=-1),-1!==e){if(n=r.substring(e+1),r=r.substring(0,e),2!==n.length&&4!==n.length)throw new Error("Wrong input string for conversion");let o=parseInt(n.substring(0,2),10);if(isNaN(o.valueOf()))throw new Error("Wrong input string for conversion");if(s=t*o,4===n.length){if(o=parseInt(n.substring(2,4),10),isNaN(o.valueOf()))throw new Error("Wrong input string for conversion");a=t*o}}}let u=r.indexOf(".");if(-1===u&&(u=r.indexOf(",")),-1!==u){const t=new Number(`0${r.substring(u)}`);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");i=t.valueOf(),o=r.substring(0,u)}else o=r;switch(!0){case 8===o.length:if(e=/(\d{4})(\d{2})(\d{2})/gi,-1!==u)throw new Error("Wrong input string for conversion");break;case 10===o.length:if(e=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==u){let t=60*i;this.minute=Math.floor(t),t=60*(t-this.minute),this.second=Math.floor(t),t=1e3*(t-this.second),this.millisecond=Math.floor(t)}break;case 12===o.length:if(e=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==u){let t=60*i;this.second=Math.floor(t),t=1e3*(t-this.second),this.millisecond=Math.floor(t)}break;case 14===o.length:if(e=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==u){const t=1e3*i;this.millisecond=Math.floor(t)}break;default:throw new Error("Wrong input string for conversion")}const c=e.exec(o);if(null===c)throw new Error("Wrong input string for conversion");for(let l=1;l<c.length;l++)switch(l){case 1:this.year=parseInt(c[l],10);break;case 2:this.month=parseInt(c[l],10);break;case 3:this.day=parseInt(c[l],10);break;case 4:this.hour=parseInt(c[l],10)+s;break;case 5:this.minute=parseInt(c[l],10)+a;break;case 6:this.second=parseInt(c[l],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===n){const t=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=t.getUTCFullYear(),this.month=t.getUTCMonth(),this.day=t.getUTCDay(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds(),this.millisecond=t.getUTCMilliseconds()}}toString(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"iso";if("iso"===t){const t=[];return t.push(Bc(this.year,4)),t.push(Bc(this.month,2)),t.push(Bc(this.day,2)),t.push(Bc(this.hour,2)),t.push(Bc(this.minute,2)),t.push(Bc(this.second,2)),0!==this.millisecond&&(t.push("."),t.push(Bc(this.millisecond,3))),t.push("Z"),t.join("")}return super.toString(t)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}ml=yh,Hc.GeneralizedTime=ml,yh.NAME="GeneralizedTime";class wh extends eh{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}bl=wh,Hc.DATE=bl,wh.NAME="DATE";class mh extends eh{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}vl=mh,Hc.TimeOfDay=vl,mh.NAME="TimeOfDay";class bh extends eh{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}El=bh,Hc.DateTime=El,bh.NAME="DateTime";class vh extends eh{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}Bl=vh,Hc.Duration=Bl,vh.NAME="Duration";class Eh extends eh{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}kl=Eh,Hc.TIME=kl,Eh.NAME="TIME";function Bh(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const kh=Bh("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),Ah=Bh("ascii","a",(t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}),(t=>{const e=function(t=0){return new Uint8Array(t)}((t=t.substring(1)).length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e})),xh={utf8:kh,"utf-8":kh,hex:Di.Fo.base16,latin1:Ah,ascii:Ah,binary:Ah,...Di.Fo};function Sh(t,e="utf8"){const n=xh[e];if(null==n)throw new Error(`Unsupported encoding "${e}"`);return n.decoder.decode(`${n.prefix}${t}`)}Error;class Ih extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An error occurred while verifying a message"),this.name="VerificationError"}}class Nh extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Missing Web Crypto API"),this.name="WebCryptoMissingError"}}const Ch={get(){const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:globalThis).crypto;if(null==t?.subtle)throw new Nh("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};class Uh{type="RSA";_key;_raw;_multihash;constructor(t,e){this._key=t,this._multihash=e}get raw(){return null==this._raw&&(this._raw=Oh(this._key)),this._raw}toMultihash(){return this._multihash}toCID(){return Ot.TO.createV1(114,this._multihash)}toString(){return Ns.base58btc.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&Us(this.raw,t.raw)}verify(t,e){return async function(t,e,n){const r=await Ch.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Ch.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},r,e,n instanceof Uint8Array?n:n.subarray())}(this._key,e,t)}}const Th=8192;function $h(t){const{result:e}=function(t){if(!t.byteLength){const t=new Fc({},Dc);return t.error="Input buffer has zero length",{offset:-1,result:t}}return xl(wc._H.toUint8Array(t).slice(),0,t.byteLength)}(t),n=e.valueBlock.value[1].valueBlock.value[0].valueBlock.value;return{kty:"RSA",n:Lh(n[0]),e:Lh(n[1])}}function Oh(t){if(null==t.n||null==t.e)throw new xs("JWK was missing components");const e=new Zl({value:[new Zl({value:[new Gl({value:"1.2.840.113549.1.1.1"}),new Ul]}),new Pl({valueHex:new Zl({value:[Fl.fromBigInt(Rh(Sh(t.n,"base64url"))),Fl.fromBigInt(Rh(Sh(t.e,"base64url")))]}).toBER()})]}).toBER();return new Uint8Array(e,0,e.byteLength)}function Lh(t){let e=t.valueBlock.valueHexView;for(;0===e[0];)e=e.subarray(1);return function(t,e="utf8"){const n=xh[e];if(null==n)throw new Error(`Unsupported encoding "${e}"`);return n.encoder.encode(t).substring(1)}(e,"base64url")}function Rh(t){const e=[];return t.forEach((function(t){let n=t.toString(16);n.length%2>0&&(n=`0${n}`),e.push(n)})),BigInt("0x"+e.join(""))}function Ph(t){const e=$h(t);if(function(t){if("RSA"!==t.kty)throw new xs("invalid key type");if(null==t.n)throw new xs("invalid key modulus");return 8*Sh(t.n,"base64url").length}(e)>Th)throw new Ss("Key size is too large");const n=yc(uc.encode({Type:sc.RSA,Data:t})),r=(0,Cs.vt)(18,n);return new Uh(e,r)}class Dh extends Hs{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,Os(t);const n=_s(e);if(this.iHash=t.create(),"function"!==typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(t){return Ls(this),this.iHash.update(t),this}digestInto(t){Ls(this),$s(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return t.finished=r,t.destroyed=o,t.blockLen=i,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const jh=(t,e,n)=>new Dh(t,e).update(n).digest();function _h(t){void 0!==t.lowS&&aa("lowS",t.lowS),void 0!==t.prehash&&aa("prehash",t.prehash)}jh.create=(t,e)=>new Dh(t,e);const{Ph:Hh,aT:Fh}=a,Vh={Err:class extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")}},_tlv:{encode:(t,e)=>{const{Err:n}=Vh;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(1&e.length)throw new n("tlv.encode: unpadded data");const r=e.length/2,o=la(r);if(o.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?la(o.length/2|128):"";return`${la(t)}${i}${o}${e}`},decode(t,e){const{Err:n}=Vh;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const o=e[r++];let i=0;if(!!(128&o)){const t=127&o;if(!t)throw new n("tlv.decode(long): indefinite length not supported");if(t>4)throw new n("tlv.decode(long): byte length is too big");const s=e.subarray(r,r+t);if(s.length!==t)throw new n("tlv.decode: length bytes not complete");if(0===s[0])throw new n("tlv.decode(long): zero leftmost byte");for(const e of s)i=i<<8|e;if(r+=t,i<128)throw new n("tlv.decode(long): not minimal encoding")}else i=o;const s=e.subarray(r,r+i);if(s.length!==i)throw new n("tlv.decode: wrong value length");return{v:s,l:e.subarray(r+i)}}},_int:{encode(t){const{Err:e}=Vh;if(t<Mh)throw new e("integer: negative integers are not allowed");let n=la(t);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new e("unexpected assertion");return n},decode(t){const{Err:e}=Vh;if(128&t[0])throw new e("Invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new e("Invalid signature integer: unnecessary leading zero");return Hh(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Vh,o="string"===typeof t?Fh(t):t;sa(o);const{v:i,l:s}=r.decode(48,o);if(s.length)throw new e("Invalid signature: left bytes after parsing");const{v:a,l:u}=r.decode(2,i),{v:c,l:l}=r.decode(2,u);if(l.length)throw new e("Invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(c)}},hexFromSig(t){const{_tlv:e,_int:n}=Vh,r=`${e.encode(2,n.encode(t.r))}${e.encode(2,n.encode(t.s))}`;return e.encode(48,r)}},Mh=BigInt(0),zh=BigInt(1),Gh=(BigInt(2),BigInt(3));BigInt(4);function qh(t){const e=function(t){const e=eu(t);Ua(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=e;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!==typeof n||"bigint"!==typeof n.beta||"function"!==typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:n}=e,r=qa(e.n,e.nBitLength),o=e.toBytes||((t,e,r)=>{const o=e.toAffine();return va(Uint8Array.from([4]),n.toBytes(o.x),n.toBytes(o.y))}),i=e.fromBytes||(t=>{const e=t.subarray(1);return{x:n.fromBytes(e.subarray(0,n.BYTES)),y:n.fromBytes(e.subarray(n.BYTES,2*n.BYTES))}});function s(t){const{a:r,b:o}=e,i=n.sqr(t),s=n.mul(i,t);return n.add(n.add(s,n.mul(t,r)),o)}if(!n.eql(n.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function a(t){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:o,n:i}=e;if(n&&"bigint"!==typeof t){if(ia(t)&&(t=ca(t)),"string"!==typeof t||!n.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*r,"0")}let s;try{s="bigint"===typeof t?t:pa(ba("private key",t,r))}catch(a){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof t}`)}return o&&(s=_a(s,i)),ka("private key",s,zh,i),s}function u(t){if(!(t instanceof h))throw new Error("ProjectivePoint expected")}const c=Ta(((t,e)=>{const{px:r,py:o,pz:i}=t;if(n.eql(i,n.ONE))return{x:r,y:o};const s=t.is0();null==e&&(e=s?n.ONE:n.inv(i));const a=n.mul(r,e),u=n.mul(o,e),c=n.mul(i,e);if(s)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:a,y:u}})),l=Ta((t=>{if(t.is0()){if(e.allowInfinityPoint&&!n.is0(t.py))return;throw new Error("bad point: ZERO")}const{x:r,y:o}=t.toAffine();if(!n.isValid(r)||!n.isValid(o))throw new Error("bad point: x or y not FE");const i=n.sqr(o),a=s(r);if(!n.eql(i,a))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0}));class h{constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!n.isValid(t))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required");Object.freeze(this)}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof h)throw new Error("projective point not allowed");const o=t=>n.eql(t,n.ZERO);return o(e)&&o(r)?h.ZERO:new h(e,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=n.invertBatch(t.map((t=>t.pz)));return t.map(((t,n)=>t.toAffine(e[n]))).map(h.fromAffine)}static fromHex(t){const e=h.fromAffine(i(ba("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return h.BASE.multiply(a(t))}static msm(t,e){return tu(h,r,t,e)}_setWindowSize(t){d.setWindowSize(this,t)}assertValidity(){l(this)}hasEvenY(){const{y:t}=this.toAffine();if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){u(t);const{px:e,py:r,pz:o}=this,{px:i,py:s,pz:a}=t,c=n.eql(n.mul(e,a),n.mul(i,o)),l=n.eql(n.mul(r,a),n.mul(s,o));return c&&l}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,o=n.mul(r,Gh),{px:i,py:s,pz:a}=this;let u=n.ZERO,c=n.ZERO,l=n.ZERO,f=n.mul(i,i),d=n.mul(s,s),g=n.mul(a,a),p=n.mul(i,s);return p=n.add(p,p),l=n.mul(i,a),l=n.add(l,l),u=n.mul(t,l),c=n.mul(o,g),c=n.add(u,c),u=n.sub(d,c),c=n.add(d,c),c=n.mul(u,c),u=n.mul(p,u),l=n.mul(o,l),g=n.mul(t,g),p=n.sub(f,g),p=n.mul(t,p),p=n.add(p,l),l=n.add(f,f),f=n.add(l,f),f=n.add(f,g),f=n.mul(f,p),c=n.add(c,f),g=n.mul(s,a),g=n.add(g,g),f=n.mul(g,p),u=n.sub(u,f),l=n.mul(g,d),l=n.add(l,l),l=n.add(l,l),new h(u,c,l)}add(t){u(t);const{px:r,py:o,pz:i}=this,{px:s,py:a,pz:c}=t;let l=n.ZERO,f=n.ZERO,d=n.ZERO;const g=e.a,p=n.mul(e.b,Gh);let y=n.mul(r,s),w=n.mul(o,a),m=n.mul(i,c),b=n.add(r,o),v=n.add(s,a);b=n.mul(b,v),v=n.add(y,w),b=n.sub(b,v),v=n.add(r,i);let E=n.add(s,c);return v=n.mul(v,E),E=n.add(y,m),v=n.sub(v,E),E=n.add(o,i),l=n.add(a,c),E=n.mul(E,l),l=n.add(w,m),E=n.sub(E,l),d=n.mul(g,v),l=n.mul(p,m),d=n.add(l,d),l=n.sub(w,d),d=n.add(w,d),f=n.mul(l,d),w=n.add(y,y),w=n.add(w,y),m=n.mul(g,m),v=n.mul(p,v),w=n.add(w,m),m=n.sub(y,m),m=n.mul(g,m),v=n.add(v,m),y=n.mul(w,v),f=n.add(f,y),y=n.mul(E,v),l=n.mul(b,l),l=n.sub(l,y),y=n.mul(b,w),d=n.mul(E,d),d=n.add(d,y),new h(l,f,d)}subtract(t){return this.add(t.negate())}is0(){return this.equals(h.ZERO)}wNAF(t){return d.wNAFCached(this,t,h.normalizeZ)}multiplyUnsafe(t){ka("scalar",t,Mh,e.n);const r=h.ZERO;if(t===Mh)return r;if(t===zh)return this;const{endo:o}=e;if(!o)return d.unsafeLadder(this,t);let{k1neg:i,k1:s,k2neg:a,k2:u}=o.splitScalar(t),c=r,l=r,f=this;for(;s>Mh||u>Mh;)s&zh&&(c=c.add(f)),u&zh&&(l=l.add(f)),f=f.double(),s>>=zh,u>>=zh;return i&&(c=c.negate()),a&&(l=l.negate()),l=new h(n.mul(l.px,o.beta),l.py,l.pz),c.add(l)}multiply(t){const{endo:r,n:o}=e;let i,s;if(ka("scalar",t,zh,o),r){const{k1neg:e,k1:o,k2neg:a,k2:u}=r.splitScalar(t);let{p:c,f:l}=this.wNAF(o),{p:f,f:g}=this.wNAF(u);c=d.constTimeNegate(e,c),f=d.constTimeNegate(a,f),f=new h(n.mul(f.px,r.beta),f.py,f.pz),i=c.add(f),s=l.add(g)}else{const{p:e,f:n}=this.wNAF(t);i=e,s=n}return h.normalizeZ([i,s])[0]}multiplyAndAddUnsafe(t,e,n){const r=h.BASE,o=(t,e)=>e!==Mh&&e!==zh&&t.equals(r)?t.multiply(e):t.multiplyUnsafe(e),i=o(this,e).add(o(t,n));return i.is0()?void 0:i}toAffine(t){return c(this,t)}isTorsionFree(){const{h:t,isTorsionFree:n}=e;if(t===zh)return!0;if(n)return n(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:n}=e;return t===zh?this:n?n(h,this):this.multiplyUnsafe(e.h)}toRawBytes(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return aa("isCompressed",t),this.assertValidity(),o(h,this,t)}toHex(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return aa("isCompressed",t),ca(this.toRawBytes(t))}}h.BASE=new h(e.Gx,e.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const f=e.nBitLength,d=Xa(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:function(t){return Ba(t,zh,e.n)}}}function Wh(t){const e=function(t){const e=eu(t);return Ua(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:n,n:r}=e,o=n.BYTES+1,i=2*n.BYTES+1;function s(t){return _a(t,r)}function a(t){return Va(t,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:l,isWithinCurveOrder:h}=qh({...e,toBytes(t,e,r){const o=e.toAffine(),i=n.toBytes(o.x),s=va;return aa("isCompressed",r),r?s(Uint8Array.from([e.hasEvenY()?2:3]),i):s(Uint8Array.from([4]),i,n.toBytes(o.y))},fromBytes(t){const e=t.length,r=t[0],s=t.subarray(1);if(e!==o||2!==r&&3!==r){if(e===i&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error(`Point of length ${e} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}{const t=pa(s);if(!Ba(t,zh,n.ORDER))throw new Error("Point is not on curve");const e=l(t);let o;try{o=n.sqrt(e)}catch(a){const t=a instanceof Error?": "+a.message:"";throw new Error("Point is not on curve"+t)}return 1===(1&r)!==((o&zh)===zh)&&(o=n.neg(o)),{x:t,y:o}}}}),f=t=>ca(wa(t,e.nByteLength));function d(t){return t>r>>zh}const g=(t,e,n)=>pa(t.slice(e,n));class p{constructor(t,e,n){this.r=t,this.s=e,this.recovery=n,this.assertValidity()}static fromCompact(t){const n=e.nByteLength;return t=ba("compactSignature",t,2*n),new p(g(t,0,n),g(t,n,2*n))}static fromDER(t){const{r:e,s:n}=Vh.toSig(ba("DER",t));return new p(e,n)}assertValidity(){ka("r",this.r,zh,r),ka("s",this.s,zh,r)}addRecoveryBit(t){return new p(this.r,this.s,t)}recoverPublicKey(t){const{r:r,s:o,recovery:i}=this,c=b(ba("msgHash",t));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const l=2===i||3===i?r+e.n:r;if(l>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=0===(1&i)?"02":"03",d=u.fromHex(h+f(l)),g=a(l),p=s(-c*g),y=s(o*g),w=u.BASE.multiplyAndAddUnsafe(d,p,y);if(!w)throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return d(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return ga(this.toDERHex())}toDERHex(){return Vh.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ga(this.toCompactHex())}toCompactHex(){return f(this.r)+f(this.s)}}const y={isValidPrivateKey(t){try{return c(t),!0}catch(e){return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const t=Ja(e.n);return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=t.length,o=Wa(e),i=Ja(e);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const s=_a(n?pa(t):ya(t),e-Oa)+Oa;return n?ma(s,o):wa(s,o)}(e.randomBytes(t),e.n)},precompute(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.BASE;return e._setWindowSize(t),e.multiply(BigInt(3)),e}};function w(t){const e=ia(t),n="string"===typeof t,r=(e||n)&&t.length;return e?r===o||r===i:n?r===2*o||r===2*i:t instanceof u}const m=e.bits2int||function(t){const n=pa(t),r=8*t.length-e.nBitLength;return r>0?n>>BigInt(r):n},b=e.bits2int_modN||function(t){return s(m(t))},v=xa(e.nBitLength);function E(t){return ka(`num < 2^${e.nBitLength}`,t,Mh,v),wa(t,e.nByteLength)}function B(t,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k;if(["recovered","canonical"].some((t=>t in o)))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:l}=e;let{lowS:f,prehash:g,extraEntropy:y}=o;null==f&&(f=!0),t=ba("msgHash",t),_h(o),g&&(t=ba("prehashed msgHash",i(t)));const w=b(t),v=c(r),B=[E(v),E(w)];if(null!=y&&!1!==y){const t=!0===y?l(n.BYTES):y;B.push(ba("extraEntropy",t))}const A=va(...B),x=w;return{seed:A,k2sig:function(t){const e=m(t);if(!h(e))return;const n=a(e),r=u.BASE.multiply(e).toAffine(),o=s(r.x);if(o===Mh)return;const i=s(n*s(x+o*v));if(i===Mh)return;let c=(r.x===o?0:2)|Number(r.y&zh),l=i;return f&&d(i)&&(l=function(t){return d(t)?s(-t):t}(i),c^=1),new p(o,l,c)}}}const k={lowS:e.lowS,prehash:!1},A={lowS:e.lowS,prehash:!1};return u.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return u.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(w(t))throw new Error("first arg must be private key");if(!w(e))throw new Error("second arg must be public key");return u.fromHex(e).multiply(c(t)).toRawBytes(n)},sign:function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k;const{seed:o,k2sig:i}=B(t,n,r),s=e;return Na(s.hash.outputLen,s.nByteLength,s.hmac)(o,i)},verify:function(t,n,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:A;const i=t;if(n=ba("msgHash",n),r=ba("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");_h(o);const{lowS:c,prehash:l}=o;let h,f;try{if("string"===typeof i||ia(i))try{h=p.fromDER(i)}catch(B){if(!(B instanceof Vh.Err))throw B;h=p.fromCompact(i)}else{if("object"!==typeof i||"bigint"!==typeof i.r||"bigint"!==typeof i.s)throw new Error("PARSE");{const{r:t,s:e}=i;h=new p(t,e)}}f=u.fromHex(r)}catch(k){if("PARSE"===k.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(c&&h.hasHighS())return!1;l&&(n=e.hash(n));const{r:d,s:g}=h,y=b(n),w=a(g),m=s(y*w),v=s(d*w),E=u.BASE.multiplyAndAddUnsafe(f,m,v)?.toAffine();return!!E&&s(E.x)===d},ProjectivePoint:u,Signature:p,utils:y}}function Jh(t){return{hash:t,hmac:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return jh(t,e,function(){let t=0;for(let n=0;n<arguments.length;n++){const e=n<0||arguments.length<=n?void 0:arguments[n];$s(e),t+=e.length}const e=new Uint8Array(t);for(let n=0,r=0;n<arguments.length;n++){const t=n<0||arguments.length<=n?void 0:arguments[n];e.set(t,r),r+=t.length}return e}(...r))},randomBytes:Vs}}const Zh=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Kh=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Yh=BigInt(1),Qh=BigInt(2),Xh=(t,e)=>(t+e/Qh)/e;function tf(t){const e=Zh,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),u=BigInt(88),c=t*t*t%e,l=c*c*t%e,h=Fa(l,n,e)*l%e,f=Fa(h,n,e)*l%e,d=Fa(f,Qh,e)*c%e,g=Fa(d,o,e)*d%e,p=Fa(g,i,e)*g%e,y=Fa(p,a,e)*p%e,w=Fa(y,u,e)*y%e,m=Fa(w,a,e)*p%e,b=Fa(m,n,e)*l%e,v=Fa(b,s,e)*g%e,E=Fa(v,r,e)*c%e,B=Fa(E,Qh,e);if(!ef.eql(ef.sqr(B),t))throw new Error("Cannot find square root");return B}const ef=qa(Zh,void 0,void 0,{sqrt:tf}),nf=function(t,e){const n=e=>Wh({...t,...Jh(e)});return Object.freeze({...n(e),create:n})}({a:BigInt(0),b:BigInt(7),Fp:ef,n:Kh,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Kh,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-Yh*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=Xh(i*t,e),u=Xh(-r*t,e);let c=_a(t-a*n-u*o,e),l=_a(-a*r-u*i,e);const h=c>s,f=l>s;if(h&&(c=e-c),f&&(l=e-l),c>s||l>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:f,k2:l}}}},yc);BigInt(0);nf.ProjectivePoint;var rf=n(1517);class of{type="secp256k1";raw;_key;constructor(t){this._key=function(t){try{return nf.ProjectivePoint.fromHex(t),t}catch(e){throw new Ss(String(e))}}(t),this.raw=function(t){const e=nf.ProjectivePoint.fromHex(t).toRawBytes(!0);return e}(this._key)}toMultihash(){return ji.identity.digest(uf(this))}toCID(){return Ot.TO.createV1(114,this.toMultihash())}toString(){return Ns.base58btc.encode(this.toMultihash().bytes).substring(1)}equals(t){return null!=t&&t.raw instanceof Uint8Array&&Us(this.raw,t.raw)}verify(t,e){return function(t,e,n){const r=rf.sha256.digest(n instanceof Uint8Array?n:n.subarray());if(null!=(o=r)&&"function"===typeof o.then&&"function"===typeof o.catch&&"function"===typeof o.finally)return r.then((n=>{let{digest:r}=n;return nf.verify(e,r,t)})).catch((t=>{throw new Ih(String(t))}));var o;try{return nf.verify(e,r.digest,t)}catch(i){throw new Ih(String(i))}}(this._key,e,t)}}function sf(t){return new of(t)}function af(t){const{Type:e,Data:n}=uc.decode(t),r=n??new Uint8Array;switch(e){case sc.RSA:return Ph(r);case sc.Ed25519:return Eu(r);case sc.secp256k1:return sf(r);default:throw new Is}}function uf(t){return uc.encode({Type:sc[t.type],Data:t.raw})}Error;Error;Error;class cf extends Error{static name="InvalidParametersError";constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid parameters"),this.name="InvalidParametersError"}}Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;class lf extends Error{static name="InvalidMultihashError";constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Invalid Multihash"),this.name="InvalidMultihashError"}}Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;Error;function hf(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const ff=hf("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),df=hf("ascii","a",(t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}),(t=>{const e=function(t=0){return new Uint8Array(t)}((t=t.substring(1)).length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e})),gf={utf8:ff,"utf-8":ff,hex:Di.Fo.base16,latin1:df,ascii:df,binary:df,...Di.Fo};function pf(t,e="utf8"){const n=gf[e];if(null==n)throw new Error(`Unsupported encoding "${e}"`);return n.encoder.encode(t).substring(1)}const yf=Symbol.for("@libp2p/peer-id");function wf(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.byteLength;n++)if(t[n]!==e[n])return!1;return!0}const mf=Symbol.for("nodejs.util.inspect.custom");class bf{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[yf]=!0;toString(){return null==this.string&&(this.string=Ns.base58btc.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return Ot.TO.createV1(114,this.multihash)}toJSON(){return this.toString()}equals(t){if(null==t)return!1;if(t instanceof Uint8Array)return wf(this.multihash.bytes,t);if("string"===typeof t)return this.toString()===t;if(null!=t?.toMultihash()?.bytes)return wf(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[mf](){return`PeerId(${this.toString()})`}}class vf extends bf{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}}class Ef extends bf{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}}class Bf extends bf{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}}class kf{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=ji.identity.digest(function(t,e="utf8"){const n=gf[e];if(null==n)throw new Error(`Unsupported encoding "${e}"`);return n.decoder.decode(`${n.prefix}${t}`)}(this.url))}[mf](){return`PeerId(${this.url})`}[yf]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return Ot.TO.createV1(2336,this.toMultihash())}toJSON(){return this.toString()}equals(t){return null!=t&&(t instanceof Uint8Array&&(t=pf(t)),t.toString()===this.toString())}}function Af(t,e){let n;if("1"===t.charAt(0)||"Q"===t.charAt(0))n=Cs.D4(Ns.base58btc.decode(`z${t}`));else{if(null==e)throw new cf('Please pass a multibase decoder for strings that do not start with "1" or "Q"');n=Cs.D4(e.decode(t))}return xf(n)}function xf(t){if(function(t){return t.code===rf.sha256.code}(t))return new vf({multihash:t});if(function(t){return t.code===ji.identity.code}(t))try{const e=function(t){const{Type:e,Data:n}=uc.decode(t.digest),r=n??new Uint8Array;switch(e){case sc.Ed25519:return Eu(r);case sc.secp256k1:return sf(r);default:throw new Is}}(t);if("Ed25519"===e.type)return new Ef({multihash:t,publicKey:e});if("secp256k1"===e.type)return new Bf({multihash:t,publicKey:e})}catch(e){const n=pf(t.digest);return new kf(new URL(n))}throw new lf("Supplied PeerID Multihash is invalid")}function Sf(t){return async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=await t.post("bitswap/stat",{searchParams:ws(e),signal:e.signal,headers:e.headers});return function(t){return{provideBufLen:t.ProvideBufLen,wantlist:(t.Wantlist??[]).map((t=>Ot.TO.parse(t["/"]))),peers:(t.Peers??[]).map((t=>Af(t))),blocksReceived:BigInt(t.BlocksReceived),dataReceived:BigInt(t.DataReceived),blocksSent:BigInt(t.BlocksSent),dataSent:BigInt(t.DataSent),dupBlksReceived:BigInt(t.DupBlksReceived),dupDataReceived:BigInt(t.DupDataReceived)}}(await n.json())}}function If(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return((await(await t.post("bitswap/wantlist",{signal:n.signal,searchParams:ws({...n,peer:e.toString()}),headers:n.headers})).json()).Keys??[]).map((t=>Ot.TO.parse(t["/"])))}}function Nf(t){return async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return((await(await t.post("bitswap/wantlist",{signal:e.signal,searchParams:ws(e),headers:e.headers})).json()).Keys??[]).map((t=>Ot.TO.parse(t["/"])))}}function Cf(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("block/get",{signal:n.signal,searchParams:ws({arg:e.toString(),...n}),headers:n.headers});return new Uint8Array(await r.arrayBuffer())}}function Uf(t){return async function e(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=new AbortController,i=_i([o.signal,r.signal]);let s;try{const e=await t.post("block/put",{signal:i,searchParams:ws(r),...await ps([n],o,r.headers)});s=await e.json()}catch(a){if("dag-pb"===r.format)return await e(n,{...r,format:"protobuf"});if("dag-cbor"===r.format)return await e(n,{...r,format:"cbor"});throw a}finally{i.clear()}return Ot.TO.parse(s.Key)}}function Tf(t){return function(e){try{let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){Array.isArray(e)||(e=[e]);const r=await t.post("block/rm",{signal:n.signal,searchParams:ws({arg:e.map((t=>t.toString())),"stream-channels":!0,...n}),headers:n.headers});for await(const t of r.ndjson())yield $f(t)}()}catch(n){return Promise.reject(n)}}}function $f(t){const e={cid:Ot.TO.parse(t.Hash)};return null!=t.Error&&(e.error=new Error(t.Error)),e}function Of(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("block/stat",{signal:n.signal,searchParams:ws({arg:e.toString(),...n}),headers:n.headers}),o=await r.json();return{cid:Ot.TO.parse(o.Key),size:o.Size}}}function Lf(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("bootstrap/add",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers}),{Peers:o}=await r.json();return{Peers:o.map((t=>(0,u.HZ)(t)))}}}function Rf(t){return async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=await t.post("bootstrap/list",{signal:e.signal,searchParams:ws(e),headers:e.headers}),{Peers:r}=await n.json();return{Peers:r.map((t=>(0,u.HZ)(t)))}}}function Pf(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("bootstrap/rm",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers}),{Peers:o}=await r.json();return{Peers:o.map((t=>(0,u.HZ)(t)))}}}function Df(t){return async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=await t.post("config/show",{signal:e.signal,searchParams:ws({...e}),headers:e.headers});return await n.json()}}function jf(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)throw new Error("key argument is required");const r=await t.post("config",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers});return(await r.json()).Value}}function _f(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("config/profile/apply",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers}),o=await r.json();return{original:o.OldCfg,updated:o.NewCfg}}}function Hf(t){return{apply:_f(t)}}function Ff(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Vf=Ff("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),Mf=Ff("ascii","a",(t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e}),(t=>{const e=function(t=0){return new Uint8Array(t)}((t=t.substring(1)).length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e})),zf={utf8:Vf,"utf-8":Vf,hex:Di.Fo.base16,latin1:Mf,ascii:Mf,binary:Mf,...Di.Fo};function Gf(t,e="utf8"){const n=zf[e];if(null==n)throw new Error(`Unsupported encoding "${e}"`);return n.decoder.decode(`${n.prefix}${t}`)}function qf(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=new AbortController,o=_i([r.signal,n.signal]);try{const i=await t.post("config/replace",{signal:o,searchParams:ws(n),...await ps([Gf(JSON.stringify(e))],r,n.headers)});await i.text()}finally{o.clear()}}}function Wf(t){return async function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"!==typeof e)throw new Error("Invalid key type");const o={...r,...Jf(e,n)},i=await t.post("config",{signal:r.signal,searchParams:ws(o),headers:r.headers});await i.text()}}function Jf(t,e){switch(typeof e){case"boolean":return{arg:[t,e.toString()],bool:!0};case"string":return{arg:[t,e]};default:return{arg:[t,JSON.stringify(e)],json:!0}}}function Zf(t){return function(e){try{let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=await t.post("dag/export",{signal:n.signal,searchParams:ws({arg:e.toString()}),headers:n.headers});yield*r.iterator()}()}catch(n){return Promise.reject(n)}}}const Kf=function(t){if(null!=t[Symbol.asyncIterator])return(async()=>{for await(const e of t)return e})();for(const e of t)return e};async function*Yf(t,e,n,r,o){const i=async t=>{const e=await n.getCodec(t.code),i=await r(t,o);return e.decode(i)},s=e.split("/").filter(Boolean);let a=await i(t),u=t;for(;s.length>0;){const t=s.shift();if(null==t)throw Ki()(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(!Object.prototype.hasOwnProperty.call(a,t))throw Ki()(new Error(`no link named "${t}" under ${u}`),"ERR_NO_LINK");a=a[t],yield{value:a,remainderPath:s.join("/")};const n=Ot.TO.asCID(a);null!=n&&(u=n,a=await i(a))}yield{value:a,remainderPath:""}}function Qf(t,e){const n=Cf(t);return async function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!=r.path){const o=!0===r.localResolve?await Kf(Yf(t,r.path,e,n,r)):await Bs(Yf(t,r.path,e,n,r));if(null==o)throw Ki()(new Error("Not found"),"ERR_NOT_FOUND");return o}const o=await e.getCodec(t.code),i=await n(t,r);return{value:o.decode(i),remainderPath:""}}}function Xf(t){return function(e){try{let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=new AbortController,o=_i([r.signal,n.signal]);try{const{headers:i,body:s}=await ps(e,r,n.headers),a=await t.post("dag/import",{signal:o,headers:i,body:s,searchParams:ws({"pin-roots":n.pinRoots})});for await(const{Root:t}of a.ndjson())if(void 0!==t){const{Cid:{"/":e},PinErrorMsg:n}=t;yield{root:{cid:Ot.TO.parse(e),pinErrorMsg:n}}}}finally{o.clear()}}()}catch(n){return Promise.reject(n)}}}function td(t,e){return async function(n){const r={storeCodec:"dag-cbor",hashAlg:"sha2-256",...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}};let o;if(null!=r.inputCodec){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");o=n}else{o=(await e.getCodec(r.storeCodec??"dag-cbor")).encode(n),r.inputCodec=r.storeCodec}const i=new AbortController,s=_i([i.signal,r.signal]);try{const e=await t.post("dag/put",{timeout:r.timeout,signal:s,searchParams:ws(r),...await ps([o],i,r.headers)}),n=await e.json();return Ot.TO.parse(n.Cid["/"])}finally{s.clear()}}}function ed(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("dag/resolve",{signal:n.signal,searchParams:ws({arg:`${e}${null!=n.path?`/${n.path}`.replace(/\/[/]+/g,"/"):""}`,...n}),headers:n.headers}),o=await r.json();return{cid:Ot.TO.parse(o.Cid["/"]),remainderPath:o.RemPath}}}function nd(t){if(0===t.Type)return{name:"SENDING_QUERY",type:t.Type};if(1===t.Type)return{from:Af(t.ID),name:"PEER_RESPONSE",type:t.Type,messageType:0,messageName:"PUT_VALUE",closer:(t.Responses??[]).map((t=>{let{ID:e,Addrs:n}=t;return{id:Af(e),multiaddrs:n.map((t=>(0,u.HZ)(t))),protocols:[]}})),providers:(t.Responses??[]).map((t=>{let{ID:e,Addrs:n}=t;return{id:Af(e),multiaddrs:n.map((t=>(0,u.HZ)(t))),protocols:[]}}))};if(2===t.Type){let e={id:t.ID??Af(t.ID),multiaddrs:[],protocols:[]};return t.Responses?.length>0&&(e={id:Af(t.Responses[0].ID),multiaddrs:t.Responses[0].Addrs.map((t=>(0,u.HZ)(t))),protocols:[]}),{name:"FINAL_PEER",type:t.Type,peer:e}}if(3===t.Type)return{name:"QUERY_ERROR",type:t.Type,error:new Error(t.Extra)};if(4===t.Type)return{name:"PROVIDER",type:t.Type,providers:t.Responses.map((t=>{let{ID:e,Addrs:n}=t;return{id:Af(e),multiaddrs:n.map((t=>(0,u.HZ)(t))),protocols:[]}}))};if(5===t.Type)return{name:"VALUE",type:t.Type,value:Gf(t.Extra,"base64pad")};if(6===t.Type){const e=t.Responses.map((t=>{let{ID:e}=t;return Af(e)}));if(0===e.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:t.Type,peer:e[0]}}if(7===t.Type)return{name:"DIALING_PEER",type:t.Type,peer:Af(t.ID)};throw new Error("Unknown DHT event type")}function rd(t){return function(e){try{let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=await t.post("dht/query",{signal:n.signal,searchParams:ws({arg:e.toString(),...n}),headers:n.headers});for await(const t of r.ndjson())yield nd(t)}()}catch(n){return Promise.reject(n)}}}var od,id;function sd(t){return async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.post("diag/cmds",{signal:e.signal,searchParams:ws(e),headers:e.headers})).json()}}function ad(t){return async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.post("diag/net",{signal:e.signal,searchParams:ws(e),headers:e.headers})).json()}}function ud(t){return async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(await t.post("diag/sys",{signal:e.signal,searchParams:ws(e),headers:e.headers})).json()}}function cd(t){return async function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=Array.isArray(e)?e:[e],i=await t.post("files/cp",{signal:r.signal,searchParams:ws({arg:o.concat(n).map((t=>null!=Ot.TO.asCID(t)?`/ipfs/${t}`:t)),...r}),headers:r.headers});await i.text()}}function ld(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"!==typeof e)throw new Error("ipfs.files.flush requires a path");const r=await t.post("files/flush",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers}),o=await r.json();return Ot.TO.parse(o.Cid)}}function hd(t){const e=ys(t);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs??0},delete e.mtimeNsecs),e}function fd(t){return function(e){try{let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){if(null==e)throw new Error("ipfs.files.ls requires a path");const r=await t.post("files/ls",{signal:n.signal,searchParams:ws({arg:null!=Ot.TO.asCID(e)?`/ipfs/${e}`:e,long:!0,...n,stream:!0}),headers:n.headers});for await(const t of r.ndjson())if("Entries"in t)for(const e of t.Entries??[])yield dd(hd(e));else yield dd(hd(t))}()}catch(n){return Promise.reject(n)}}}function dd(t){return null!=t.hash&&(t.cid=Ot.TO.parse(t.hash)),delete t.hash,t.type=1===t.type?"directory":"file",t}function gd(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("files/mkdir",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers});await r.text()}}function pd(t){return async function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Array.isArray(e)||(e=[e]);const o=await t.post("files/mv",{signal:r.signal,searchParams:ws({arg:e.concat(n),...r}),headers:r.headers});await o.text()}}function yd(t){if(e=t,"function"===typeof e?.getReader)return async function*(){const e=t.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)return;yield n}}finally{e.releaseLock()}}();var e;if(function(t){return null!=t[Symbol.asyncIterator]}(t))return t;throw new Error("unknown stream")}function wd(t){return function(e){try{let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return async function*(){const r=await t.post("files/read",{signal:n.signal,searchParams:ws({arg:e,count:n.length,...n}),headers:n.headers});if(null==r.body)throw new Error("Invalid response body");yield*yd(r.body)}()}catch(n){return Promise.reject(n)}}}function md(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("files/rm",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers}),o=await r.text();if(""!==o){const t=new Xi(r);throw t.message=o,t}}}function bd(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("files/stat",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers}),o=await r.json();return o.WithLocality=o.WithLocality??!1,(i=hd(o)).cid=Ot.TO.parse(i.hash),delete i.hash,i;var i}}function vd(t){return async function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=new AbortController,i=_i([o.signal,r.signal]);try{const s=await t.post("files/write",{signal:i,searchParams:ws({arg:e,streamChannels:!0,count:r.length,...r}),...await ps([{content:n,path:"arg",mode:ds(r.mode),mtime:ss(r.mtime)}],o,r.headers)});await s.text()}finally{i.clear()}}}function Ed(t){return async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=await t.post("id",{signal:e.signal,searchParams:ws({arg:null!=e.peerId?e.peerId.toString():void 0,...e}),headers:e.headers}),r={...ys(await n.json())};return r.id=Af(r.id),null!=r.addresses&&(r.addresses=r.addresses.map((t=>(0,u.HZ)(t)))),r}}!function(t){t[t.SENDING_QUERY=0]="SENDING_QUERY",t[t.PEER_RESPONSE=1]="PEER_RESPONSE",t[t.FINAL_PEER=2]="FINAL_PEER",t[t.QUERY_ERROR=3]="QUERY_ERROR",t[t.PROVIDER=4]="PROVIDER",t[t.VALUE=5]="VALUE",t[t.ADDING_PEER=6]="ADDING_PEER",t[t.DIALING_PEER=7]="DIALING_PEER"}(od||(od={})),function(t){t[t.PUT_VALUE=0]="PUT_VALUE",t[t.GET_VALUE=1]="GET_VALUE",t[t.ADD_PROVIDER=2]="ADD_PROVIDER",t[t.GET_PROVIDERS=3]="GET_PROVIDERS",t[t.FIND_NODE=4]="FIND_NODE",t[t.PING=5]="PING"}(id||(id={}));const Bd={type:"ed25519"};function kd(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bd;const r=await t.post("key/gen",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers});return ys(await r.json())}}function Ad(t){return async function(e,n,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=await t.post("key/import",{signal:o.signal,searchParams:ws({arg:e,pem:n,password:r,...o}),headers:o.headers});return ys(await i.json())}}function xd(t){return async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=await t.post("key/list",{signal:e.signal,searchParams:ws(e),headers:e.headers});return((await n.json()).Keys??[]).map((t=>ys(t)))}}function Sd(t){return async function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=await t.post("key/rename",{signal:r.signal,searchParams:ws({arg:[e,n],...r}),headers:r.headers});return ys(await o.json())}}function Id(t){return async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=await t.post("key/rm",{signal:n.signal,searchParams:ws({arg:e,...n}),headers:n.headers});return ys((await r.json()).Keys[0])}}var Nd=n(1610);const Cd=1e3,Ud=60*Cd,Td=60*Ud,$d=24*Td,Od=7*$d,Ld=365.25*$d;const Rd=function(t,e){try{if("string"===typeof t&&t.length>0)return function(t){if((t=String(t)).length>100)throw new Error("Value exceeds the maximum length of 100 characters.");const e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return NaN;const n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*Ld;case"weeks":case"week":case"w":return n*Od;case"days":case"day":case"d":return n*$d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Td;case"minutes":case"minute":case"mins":case"min":case"m":return n*Ud;case"seconds":case"second":case"secs":case"sec":case"s":return n*Cd;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:throw new Error(`The unit ${r} was matched, but no matching case exists.`)}}(t);if("number"===typeof t&&isFinite(t))return e?.long?function(t){const e=Math.abs(t);if(e>=$d)return Pd(t,e,$d,"day");if(e>=Td)return Pd(t,e,Td,"hour");if(e>=Ud)return Pd(t,e,Ud,"minute");if(e>=Cd)return Pd(t,e,Cd,"second");return`${t} ms`}(t):function(t){const e=Math.abs(t);if(e>=$d)return`${Math.round(t/$d)}d`;if(e>=Td)return`${Math.round(t/Td)}h`;if(e>=Ud)return`${Math.round(t/Ud)}m`;if(e>=Cd)return`${Math.round(t/Cd)}s`;return`${t}ms`}(t);throw new Error("Value is not a string or number.")}catch(n){const e=function(t){return"object"===typeof t&&null!==t&&"message"in t}(n)?`${n.message}. value=${JSON.stringify(t)}`:"An unknown error has occured.";throw new Error(e)}};function Pd(t,e,n,r){const o=e>=1.5*n;return`${Math.round(t/n)} ${r}${o?"s":""}`}const Dd=function(){try{return localStorage}catch(t){}}();const jd=console.debug??console.log??(()=>{});const _d=function(t){function e(t){let r,o,i,s=null;function a(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];if(!a.enabled)return;const i=a,s=Number(new Date),u=s-(r||s);i.diff=u,i.prev=r,i.curr=s,r=s,n[0]=e.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");let c=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,((t,r)=>{if("%%"===t)return"%";c++;const o=e.formatters[r];if("function"===typeof o){const e=n[c];t=o.call(i,e),n.splice(c,1),c--}return t})),e.formatArgs.call(i,n);(i.log||e.log).apply(i,n)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=n,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==e.namespaces&&(o=e.namespaces,i=e.enabled(t)),i),set:t=>{s=t}}),"function"===typeof e.init&&e.init(a),a}function n(t,n){const r=e(this.namespace+("undefined"===typeof n?":":n)+t);return r.log=this.log,r}function r(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){if(t instanceof Error)return t.stack??t.message;return t},e.disable=function(){const t=[...e.names.map(r),...e.skips.map(r).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const r=("string"===typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=Rd,e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.setupFormatters(e.formatters),e.enable(e.load()),e}({formatArgs:function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Rd(this.diff),!this.useColors)return;const e="color: "+this.color;t.splice(1,0,e,"color: inherit");let n=0,r=0;t[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(n++,"%c"===t&&(r=n))})),t.splice(r,0,e)},save:function(t){try{t?Dd?.setItem("debug",t):Dd?.removeItem("debug")}catch(e){}},load:function(){let t;try{t=Dd?.getItem("debug")}catch(e){}return!t&&"undefined"!==typeof globalThis.process&&"env"in globalThis.process&&(t=globalThis.process.env.DEBUG),t},useColors:function(){return!("undefined"===typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"===typeof navigator||null==navigator.userAgent?.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!==typeof document&&document.documentElement?.style?.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&null!=navigator.userAgent?.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent?.toLowerCase().match(/applewebkit\/(\d+)/))},setupFormatters:function(t){t.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},colors:["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],storage:Dd,log:jd}),Hd=_d;function Fd(t){let e=function(t){const e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}(`${t}:trace`);return Hd.enabled(`${t}:trace`)&&null!=Hd.names.map((t=>t.toString())).find((t=>t.includes(":trace")))&&(e=Hd(`${t}:trace`)),Object.assign(Hd(t),{error:Hd(`${t}:error`),trace:e})}function Vd(t){if(null!=t&&0!==(t=t.trim()).length)return t}Hd.formatters.b=t=>null==t?"undefined":Ns.base58btc.baseEncode(t),Hd.formatters.t=t=>null==t?"undefined":Nd.base32.baseEncode(t),Hd.formatters.m=t=>null==t?"undefined":yn.base64.baseEncode(t),Hd.formatters.p=t=>null==t?"undefined":t.toString(),Hd.formatters.c=t=>null==t?"undefined":t.toString(),Hd.formatters.k=t=>null==t?"undefined":t.toString(),Hd.formatters.a=t=>null==t?"undefined":t.toString(),Hd.formatters.e=t=>null==t?"undefined":Vd(t.stack)??Vd(t.message)??t.toString();var Md=n(8355);const zd=n.n(Md)();let Gd=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/giu;function qd(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms";var n=null;t=(t+"").replace(/(\d)[,_](\d)/g,"$1$2");var r="-"===t[0];return t.replace(Gd,(function(t,e,r){(r=Wd(r))&&(n=(n||0)+Math.abs(parseFloat(e,10))*r)})),n&&n/(Wd(e)||1)*(r?-1:1)}function Wd(t){return qd[t]||qd[t.toLowerCase().replace(/s$/,"")]}qd.nanosecond=qd.ns=1e-6,qd["\xb5s"]=qd["\u03bcs"]=qd.us=qd.microsecond=.001,qd.millisecond=qd.ms=qd[""]=1,qd.second=qd.sec=qd.s=1e3*qd.ms,qd.minute=qd.min=qd.m=60*qd.s,qd.hour=qd.hr=qd.h=60*qd.m,qd.day=qd.d=24*qd.h,qd.week=qd.wk=qd.w=7*qd.d,qd.month=qd.b=30.4375*qd.d,qd.year=qd.yr=qd.y=365.25*qd.d;const Jd=qd;var Zd=n(1505);class Kd extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Request timed out"),this.name="TimeoutError"}}class Yd extends Error{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"The operation was aborted."),this.name="AbortError"}}class Qd extends Error{response;constructor(t){super(t.statusText),this.name="HTTPError",this.response=t}}const Xd=globalThis.fetch,tg=globalThis.Headers,eg=globalThis.Request,ng=globalThis.Response,rg=Xd,og=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null!=e.onUploadProgress?async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=new XMLHttpRequest;n.open(e.method??"GET",t.toString(),!0);const{timeout:r,headers:o}=e,i=Number(r);if(!isNaN(i)&&i>0&&i<1/0&&(n.timeout=i),null!=e.overrideMimeType&&n.overrideMimeType(e.overrideMimeType),null!=o)for(const[s,a]of new tg(o))n.setRequestHeader(s,a);return null!=e.signal&&(e.signal.onabort=()=>{n.abort()}),null!=e.onUploadProgress&&(n.upload.onprogress=e.onUploadProgress),n.responseType="arraybuffer",new Promise(((t,r)=>{const o=e=>{switch(e.type){case"error":t(ng.error());break;case"load":t(new sg(n.responseURL,n.response,{status:n.status,statusText:n.statusText,headers:ig(n.getAllResponseHeaders())}));break;case"timeout":r(new Kd);break;case"abort":r(new Yd)}};n.onerror=o,n.onload=o,n.ontimeout=o,n.onabort=o,n.send(e.body)}))}(t,e):rg(t,e)},ig=t=>{const e=new tg;for(const n of t.trim().split(/[\r\n]+/)){const t=n.indexOf(": ");t>0&&e.set(n.slice(0,t),n.slice(t+1))}return e};class sg extends ng{constructor(t,e,n){super(e,n),Object.defineProperty(this,"url",{value:t})}}const ag=zd.bind({ignoreUndefined:!0}),ug=Fd("kubo-rpc-client:fetch"),cg={throwHttpErrors:!0,credentials:"same-origin"};class lg{static HTTPError=(()=>Qd)();static TimeoutError=(()=>Kd)();static post=async(t,e)=>new lg(e).post(t,e);static get=async(t,e)=>new lg(e).get(t,e);static put=async(t,e)=>new lg(e).put(t,e);static delete=async(t,e)=>new lg(e).delete(t,e);static options=async(t,e)=>new lg(e).options(t,e);opts;constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.opts=ag({},cg,t)}async fetch(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=ag({},this.opts,e),r=new tg(n.headers);if("string"!==typeof t&&!(t instanceof Zd.URL||t instanceof eg))throw new TypeError("`resource` must be a string, URL, or Request");const o=new Zd.URL(t.toString(),n.base),{searchParams:i,transformSearchParams:s,json:a}=n;null!=i&&(o.search="function"===typeof s?s(new Zd.URLSearchParams(n.searchParams)):new Zd.URLSearchParams(n.searchParams).toString()),null!=a&&(n.body=JSON.stringify(n.json),r.set("content-type","application/json"));const u=[n.signal];null!=n.timeout&&isNaN(n.timeout)&&n.timeout>0&&u.push(AbortSignal.timeout(n.timeout));const c=_i(u);try{null!=globalThis.ReadableStream&&n.body instanceof globalThis.ReadableStream&&(zi||Wi)&&(n.body=new Blob(await cs(Ji(n.body)))),ug.trace("outgoing headers",n.headers),ug.trace("%s %s",n.method,o);const t=await og(o.toString(),{...n,signal:n.signal,timeout:void 0,headers:r,duplex:"half"});if(ug("%s %s %d",n.method,o,t.status),ug.trace("incoming headers",t.headers),!t.ok&&!0===n.throwHttpErrors)throw null!=n.handleError&&await n.handleError(t),new Qd(t);return t.iterator=async function*(){yield*fg(t.body)},t.ndjson=async function*(){for await(const n of hg(t.iterator()))null!=e.transform?yield e.transform(n):yield n},t}finally{c.clear()}}async post(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(t,{...e,method:"POST"})}async get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(t,{...e,method:"GET"})}async put(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(t,{...e,method:"PUT"})}async delete(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(t,{...e,method:"DELETE"})}async options(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.fetch(t,{...e,method:"OPTIONS"})}}const hg=async function*(t){const e=new TextDecoder;let n="";for await(const r of t){n+=e.decode(r,{stream:!0});const t=n.split(/\r?\n/);for(let e=0;e<t.length-1;e++){const n=t[e].trim();n.length>0&&(yield JSON.parse(n))}n=t[t.length-1]}n+=e.decode(),n=n.trim(),0!==n.length&&(yield JSON.parse(n))},fg=t=>{if(dg(t))return t;if(pg(t)){const e=t[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:e.next.bind(e),return:n=>(t.destroy(),"function"===typeof e.return?e.return():Promise.resolve({done:!0,value:n}))})}}if(gg(t)){const e=t.getReader();return async function*(){try{for(;;){const{done:t,value:n}=await e.read();if(t)return;null!=n&&(yield n)}}finally{e.releaseLock()}}()}throw new TypeError("Body can't be converted to AsyncIterable")},dg=t=>null!==t&&"function"===typeof t[Symbol.asyncIterator],gg=t=>null!=t&&"function"===typeof t.getReader,pg=t=>Object.prototype.hasOwnProperty.call(t,"readable")&&Object.prototype.hasOwnProperty.call(t,"writable"),yg=[(0,u.WH)("tcp").code,(0,u.WH)("dns").code,(0,u.WH)("dnsaddr").code,(0,u.WH)("dns4").code,(0,u.WH)("dns6").code];function wg(t){return bg("sni",t)?.[1]}function mg(t){const e=bg("tcp",t)?.[1];return null==e?"":`:${e}`}function bg(t,e){let n;try{n=(0,u.WH)(t).code}catch(r){return}for(const[o,i]of e)if(o===n&&null!=i)return[o,i]}function vg(t){return t.some((([t,e])=>t===(0,u.WH)("tls").code))}function Eg(t,e,n){const r=Bg[(0,u.WH)(t).name];if(null==r)throw new Error(`Can't interpret protocol ${(0,u.WH)(t).name}`);const o=r(e,n);return t===(0,u.WH)("ip6").code?`[${o}]`:o}const Bg={ip4:(t,e)=>t,ip6:(t,e)=>0===e.length?t:`[${t}]`,tcp:(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return`tcp://${Eg(n[0],n[1]??"",e)}:${t}`},udp:(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return`udp://${Eg(n[0],n[1]??"",e)}:${t}`},dnsaddr:(t,e)=>t,dns4:(t,e)=>t,dns6:(t,e)=>t,dns:(t,e)=>t,ipfs:(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return`${Eg(n[0],n[1]??"",e)}/ipfs/${t}`},p2p:(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return`${Eg(n[0],n[1]??"",e)}/p2p/${t}`},http:(t,e)=>{const n=vg(e),r=wg(e),o=mg(e);if(n&&null!=r)return`https://${r}${o}`;const i=n?"https://":"http://",s=e.pop();if(null==s)throw new Error("Unexpected end of multiaddr");let a=Eg(s[0],s[1]??"",e);return a=a.replace("tcp://",""),`${i}${a}`},"http-path":(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return`${Eg(n[0],n[1]??"",e)}/${decodeURIComponent(t)}`},tls:(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return Eg(n[0],n[1]??"",e)},sni:(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return Eg(n[0],n[1]??"",e)},https:(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");let r=Eg(n[0],n[1]??"",e);return r=r.replace("tcp://",""),`https://${r}`},ws:(t,e)=>{const n=vg(e),r=wg(e),o=mg(e);if(n&&null!=r)return`wss://${r}${o}`;const i=n?"wss://":"ws://",s=e.pop();if(null==s)throw new Error("Unexpected end of multiaddr");let a=Eg(s[0],s[1]??"",e);return a=a.replace("tcp://",""),`${i}${a}`},wss:(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");let r=Eg(n[0],n[1]??"",e);return r=r.replace("tcp://",""),`wss://${r}`},"p2p-websocket-star":(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return`${Eg(n[0],n[1]??"",e)}/p2p-websocket-star`},"p2p-webrtc-star":(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return`${Eg(n[0],n[1]??"",e)}/p2p-webrtc-star`},"p2p-webrtc-direct":(t,e)=>{const n=e.pop();if(null==n)throw new Error("Unexpected end of multiaddr");return`${Eg(n[0],n[1]??"",e)}/p2p-webrtc-direct`}};function kg(t){try{t=function(t,e){const n=(0,u.HZ)(t).stringTuples(),r=n.pop();if(null==r)throw new Error("Unexpected end of multiaddr");const o=(0,u.WH)(r[0]),i=Bg[o.name];if(null==i)throw new Error(`No interpreter found for ${o.name}`);let s=i(r[1]??"",n);return!1!==e?.assumeHttp&&yg.includes(r[0])&&(s=s.replace(/^.*:\/\//,""),s="443"===r[1]?`https://${s}`:`http://${s}`),(s.startsWith("http://")||s.startsWith("https://")||s.startsWith("ws://")||s.startsWith("wss://"))&&(s=new URL(s).toString(),s.endsWith("/")&&(s=s.substring(0,s.length-1))),s}((0,u.HZ)(t))}catch{}return t=t.toString()}const Ag=Fd("js-kubo-rpc-client:lib:error-handler"),xg=zd.bind({ignoreUndefined:!0}),Sg=zi||Wi?location.protocol:"http",Ig=zi||Wi?location.hostname:"localhost",Ng=zi||Wi?location.port:"5001",Cg=async t=>{let e;try{if((t.headers.get("Content-Type")??"").startsWith("application/json")){const n=await t.json();Ag(n),e=n.Message??n.message}else e=await t.text()}catch(r){Ag("Failed to parse error response",r),e=r.message}let n=new lg.HTTPError(t);throw null!=e&&(e.includes("deadline has elapsed")&&(n=new lg.TimeoutError),e.includes("context deadline exceeded")&&(n=new lg.TimeoutError),e.includes("request timed out")&&(n=new lg.TimeoutError),n.message=e),n},Ug=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,Tg=t=>t.replace(Ug,(function(t){return"-"+t.toLowerCase()}));class $g extends lg{constructor(){var t;const e=function(){let t,e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r={};if("string"===typeof n||(0,u.R8)(n))t=new URL(kg(n));else if(n instanceof URL)t=n;else if("string"===typeof n.url||(0,u.R8)(n.url))t=new URL(kg(n.url)),r=n;else if(n.url instanceof URL)t=n.url,r=n;else{r=n??{};const e=(r.protocol??Sg).replace(":",""),o=(r.host??Ig).split(":")[0],i=r.port??Ng;t=new URL(`${e}://${o}:${i}`)}if(null!=r.apiPath?t.pathname=r.apiPath:"/"!==t.pathname&&void 0!==t.pathname||(t.pathname="api/v0"),qi){const t=void 0;e=r.agent??new t({keepAlive:!0,maxSockets:6})}return{...r,host:t.host,protocol:t.protocol.replace(":",""),port:Number(t.port),apiPath:t.pathname,url:t,agent:e}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});var n;super({timeout:null!=e.timeout?(n=e.timeout,"string"===typeof n?Jd(n)??0:n):void 0,headers:e.headers,base:`${e.url}`,handleError:Cg,transformSearchParams:t=>{const e=new URLSearchParams;for(const[n,r]of t)"undefined"!==r&&"null"!==r&&"signal"!==n&&"timeout"!==n&&e.append(Tg(n),r),"timeout"!==n||isNaN(parseInt(r))||e.append(Tg(n),r);return e},agent:e.agent}),t=this,delete this.get,delete this.put,delete this.delete,delete this.options;const r=this.fetch;this.fetch=async function(n){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"!==typeof n||n.startsWith("/")||(n=`${e.url}/${n}`),r.call(t,n,xg(o,{method:"POST"}))}}}lg.HTTPError;const Og=async t=>Promise.reject(new Error(`No base found for "${t}"`));class Lg{_basesByName;_basesByPrefix;_loadBase;constructor(t){this._basesByName={},this._basesByPrefix={},this._loadBase=t.loadBase??Og;for(const e of t.bases)this.addBase(e)}addBase(t){if(null!=this._basesByName[t.name]&&null!=this._basesByPrefix[t.prefix])throw new Error(`Codec already exists for codec "${t.name}"`);this._basesByName[t.name]=t,this._basesByPrefix[t.prefix]=t}removeBase(t){delete this._basesByName[t.name],delete this._basesByPrefix[t.prefix]}async getBase(t){if(null!=this._basesByName[t])return this._basesByName[t];if(null!=this._basesByPrefix[t])return this._basesByPrefix[t];const e=await this._loadBase(t);return null==this._basesByName[e.name]&&null==this._basesByPrefix[e.prefix]&&this.addBase(e),e}listBases(){return Object.values(this._basesByName)}}const Rg=async t=>Promise.reject(new Error(`No codec found for "${t}"`));class Pg{_codecsByName;_codecsByCode;_loadCodec;constructor(t){this._codecsByName={},this._codecsByCode={},this._loadCodec=t.loadCodec??Rg;for(const e of t.codecs)this.addCodec(e)}addCodec(t){if(null!=this._codecsByName[t.name]||null!=this._codecsByCode[t.code])throw new Er